<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mobius Vertical Mini (Simple + Notes Submit Icon)</title>
  <style>
    :root{
      --miniW: 300px;

      --bg: #ffffff;
      --text: #0b1220;
      --muted: #5b667a;

      --border: rgba(11, 18, 32, 0.12);
      --shadow: 0 16px 34px rgba(2, 6, 23, 0.14);

      /* Your palette */
      --green: #16a34a;
      --yellow: #f59e0b;
      --blue: #2563eb;
      --grey: #94a3b8;

      --radius: 14px;
    }

    *{ box-sizing: border-box; }
    body{
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background: linear-gradient(180deg, #f8fafc 0%, #ffffff 60%);
    }

    .page{ padding: 28px 22px; max-width: 980px; line-height: 1.55; }
    .page h1{ margin: 0 0 10px; font-size: 20px; }
    .page p{ color: #334155; }
    .hint{ margin-top: 12px; color: var(--muted); font-size: 13px; }

    /* Mini */
    #mini{
      position: fixed;
      left: 14px;
      top: 14px;
      width: var(--miniW);
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      z-index: 2147483647;
      overflow: hidden;
      user-select: none;
    }

    .handle{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 8px 10px;
      border-bottom: 1px solid rgba(11,18,32,0.08);
      background: rgba(11,18,32,0.02);
      cursor: grab;
    }
    .handle:active{ cursor: grabbing; }
    .brand{
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 900;
      font-size: 12px;
      letter-spacing: 0.01em;
      min-width: 0;
    }
    .mark{
      width: 24px; height: 24px;
      border-radius: 9px;
      border: 1px solid rgba(11,18,32,0.12);
      display: grid; place-items: center;
      background: rgba(11,18,32,0.03);
      font-weight: 900;
      flex: 0 0 auto;
      font-size: 12px;
    }
    .dragHint{
      color: var(--muted);
      font-size: 11px;
      font-weight: 800;
      white-space: nowrap;
    }

    .row{
      padding: 8px 10px;
      border-bottom: 1px solid rgba(11,18,32,0.08);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .row:last-child{ border-bottom: none; }

    .meta{
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;
      flex: 1 1 auto;
    }
    .label{
      font-size: 9px;
      letter-spacing: 0.10em;
      text-transform: uppercase;
      color: var(--muted);
      font-weight: 900;
      line-height: 1;
    }
    .value{
      font-size: 12px;
      font-weight: 900;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1.1;
    }
    .sub{
      font-size: 11px;
      font-weight: 800;
      color: var(--muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1.1;
    }

    /* Simple status line: dot + sentence */
    .statusBtn{
      width: 100%;
      border: 1px solid rgba(11,18,32,0.10);
      background: rgba(11,18,32,0.03);
      border-radius: 12px;
      padding: 7px 9px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      font-weight: 900;
      color: var(--text);
      user-select: none;
    }
    .statusBtn:hover{ background: rgba(11,18,32,0.06); }

    .dot{
      width: 10px;
      height: 10px;
      border-radius: 999px;
      flex: 0 0 auto;
      box-shadow: 0 0 0 4px rgba(148,163,184,0.18);
    }
    .glowGreen{ box-shadow: 0 0 0 4px rgba(22,163,74,0.14); }
    .glowYellow{ box-shadow: 0 0 0 4px rgba(245,158,11,0.18); }
    .glowBlue{ box-shadow: 0 0 0 4px rgba(37,99,235,0.16); }
    .glowGrey{ box-shadow: 0 0 0 4px rgba(148,163,184,0.18); }

    /* Notes with embedded submit icon */
    .notesWrap{
      width: 100%;
      position: relative;
      display: flex;
      align-items: center;
    }
    .notes{
      width: 100%;
      height: 34px;
      border-radius: 12px;
      border: 1px solid rgba(11,18,32,0.14);
      background: #fff;
      padding: 0 40px 0 10px; /* room for icon button */
      font-size: 12px;
      font-weight: 800;
      color: var(--text);
      outline: none;
      min-width: 0;
    }
    .notes::placeholder{ color: rgba(91,102,122,0.75); font-weight: 800; }
    .notes:focus{ border-color: rgba(37,99,235,0.55); }

    .submitIconBtn{
      position: absolute;
      right: 6px;
      width: 28px;
      height: 28px;
      border-radius: 10px;
      border: 1px solid rgba(11,18,32,0.12);
      background: rgba(11,18,32,0.03);
      cursor: pointer;
      display: grid;
      place-items: center;
      padding: 0;
    }
    .submitIconBtn:hover{ background: rgba(11,18,32,0.06); }
    .submitIconBtn:focus{ outline: 2px solid rgba(37,99,235,0.35); outline-offset: 2px; }

    .plane{
      width: 16px;
      height: 16px;
      display: block;
      fill: rgba(11,18,32,0.85);
    }
  </style>
</head>
<body>
  <div class="page">
    <h1>Host webpage (unchanged)</h1>
    <p>
      This mini uses a simple readable pattern: colored dot + sentence.
      Notes is short and has a submit icon inside the input.
    </p>
    <div class="hint">
      Click Proceed/Tasking rows to cycle (demo). Type a note and click the paper-plane icon to submit.
      Drag via the top handle.
    </div>
  </div>

  <aside id="mini" aria-label="Mobius OS mini">
    <div class="handle" id="handle">
      <div class="brand">
        <span class="mark">∞</span>
        <span style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Mobius</span>
      </div>
      <div class="dragHint">Drag</div>
    </div>

    <!-- Patient -->
    <div class="row">
      <div class="meta">
        <div class="label">Patient</div>
        <div class="value">Jane Doe</div>
        <div class="sub">ID 1234567890</div>
      </div>
      <div style="color:var(--muted);font-weight:900;font-size:11px;">Now</div>
    </div>

    <!-- Proceed (simple) -->
    <div class="row">
      <div class="meta" style="width:100%;">
        <div class="label">Proceed</div>
        <button id="proceedBtn" class="statusBtn" type="button">
          <span id="proceedDot" class="dot glowGreen" style="background: var(--green);"></span>
          <span id="proceedText">Proceed: All checks passing</span>
        </button>
      </div>
    </div>

    <!-- Tasking (simple) -->
    <div class="row">
      <div class="meta" style="width:100%;">
        <div class="label">Tasking</div>
        <button id="taskingBtn" class="statusBtn" type="button">
          <span id="taskingDot" class="dot glowGreen" style="background: var(--green);"></span>
          <span id="taskingText">Tasking: Agentic (auto close)</span>
        </button>
      </div>
    </div>

    <!-- Notes + submit icon -->
    <div class="row">
      <div class="meta" style="width:100%;">
        <div class="label">Note</div>
        <div class="notesWrap">
          <input id="notes" class="notes" placeholder="Quick note…" />
          <button id="submitBtn" class="submitIconBtn" type="button" aria-label="Submit note">
            <svg class="plane" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </aside>

  <script>
    const STORAGE_KEY = 'mobius_vertical_simple_submiticon_v1';

    const mini = document.getElementById('mini');
    const handle = document.getElementById('handle');

    const proceedBtn = document.getElementById('proceedBtn');
    const proceedDot = document.getElementById('proceedDot');
    const proceedText = document.getElementById('proceedText');

    const taskingBtn = document.getElementById('taskingBtn');
    const taskingDot = document.getElementById('taskingDot');
    const taskingText = document.getElementById('taskingText');

    const notes = document.getElementById('notes');
    const submitBtn = document.getElementById('submitBtn');

    function cssVar(name){
      return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
    }
    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    function getViewportBounds(el){
      const rect = el.getBoundingClientRect();
      const maxX = window.innerWidth - rect.width - 8;
      const maxY = window.innerHeight - rect.height - 8;
      return { minX: 8, minY: 8, maxX, maxY };
    }

    function setMiniPos(x, y){
      const b = getViewportBounds(mini);
      const cx = clamp(x, b.minX, b.maxX);
      const cy = clamp(y, b.minY, b.maxY);
      mini.style.left = cx + 'px';
      mini.style.top = cy + 'px';
      mini.style.right = 'auto';
      mini.style.bottom = 'auto';
      return { x: cx, y: cy };
    }

    function saveMiniPos(pos){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(pos));
    }
    function loadMiniPos(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : null;
      }catch{ return null; }
    }

    // Drag
    let dragging = false;
    let start = { x: 0, y: 0, left: 0, top: 0 };

    handle.addEventListener('pointerdown', (e) => {
      dragging = true;
      handle.setPointerCapture(e.pointerId);
      const rect = mini.getBoundingClientRect();
      start = { x: e.clientX, y: e.clientY, left: rect.left, top: rect.top };
      e.preventDefault();
    });

    handle.addEventListener('pointermove', (e) => {
      if (!dragging) return;
      const dx = e.clientX - start.x;
      const dy = e.clientY - start.y;
      setMiniPos(start.left + dx, start.top + dy);
    });

   