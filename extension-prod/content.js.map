{"version":3,"file":"content.js","mappings":"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","sources":["webpack://mobius-os-extension/./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack://mobius-os-extension/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://mobius-os-extension/./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack://mobius-os-extension/./node_modules/css-loader/dist/runtime/api.js","webpack://mobius-os-extension/./src/styles/sidebar.css","webpack://mobius-os-extension/./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://mobius-os-extension/./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://mobius-os-extension/./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack://mobius-os-extension/./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://mobius-os-extension/webpack/bootstrap","webpack://mobius-os-extension/webpack/runtime/compat get default export","webpack://mobius-os-extension/webpack/runtime/define property getters","webpack://mobius-os-extension/webpack/runtime/hasOwnProperty shorthand","webpack://mobius-os-extension/webpack/runtime/nonce","webpack://mobius-os-extension/./src/styles/sidebar.css?4816","webpack://mobius-os-extension/./src/config.ts","webpack://mobius-os-extension/./src/utils/session.ts","webpack://mobius-os-extension/./src/services/auth.ts","webpack://mobius-os-extension/./src/services/api.ts","webpack://mobius-os-extension/./src/components/header/ClientLogo.ts","webpack://mobius-os-extension/./src/components/header/MobiusLogo.ts","webpack://mobius-os-extension/./src/services/personalization.ts","webpack://mobius-os-extension/./src/services/dataHierarchy.ts","webpack://mobius-os-extension/./src/components/sidecar/BottleneckCard.ts","webpack://mobius-os-extension/./src/components/sidecar/ContextExpander.ts","webpack://mobius-os-extension/./src/services/toastManager.ts","webpack://mobius-os-extension/./src/components/sidecar/SidecarMenu.ts","webpack://mobius-os-extension/./src/services/patternMatchers.ts","webpack://mobius-os-extension/./src/services/patientContextDetector.ts","webpack://mobius-os-extension/./src/components/settings/PreferencesModal.ts","webpack://mobius-os-extension/./src/content.ts","webpack://mobius-os-extension/./src/components/sidecar/AlertIndicator.ts","webpack://mobius-os-extension/./src/components/sidecar/StatusBar.ts","webpack://mobius-os-extension/./src/components/sidecar/QuickChat.ts"],"sourcesContent":["\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\nvar stylesInDOM = [];\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n  return result;\n}\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n    identifiers.push(identifier);\n  }\n  return identifiers;\n}\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n  return updater;\n}\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n    var newLastIdentifiers = modulesToDom(newList, options);\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n      var _index = getIndexByIdentifier(_identifier);\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\nmodule.exports = styleTagTransform;","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/**\n * Sidebar-only styles for Mobius OS (content script injection)\n * IMPORTANT: Must not style host page elements like html/body.\n * Everything is scoped under #mobius-os-sidebar to avoid collisions.\n */\n\n#mobius-os-sidebar,\n#mobius-os-sidebar * {\n  box-sizing: border-box;\n}\n\n#mobius-os-sidebar {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Google Sans', sans-serif;\n  background: #ffffff;\n  color: #0b1220;\n  font-size: 12px;\n  font-weight: 500;\n}\n\n/* Subtle, modern look - matching Mini */\n#mobius-os-sidebar {\n  border-left: 1px solid rgba(11, 18, 32, 0.12);\n  box-shadow: -4px 0 24px rgba(2, 6, 23, 0.08);\n}\n\n#mobius-os-sidebar button,\n#mobius-os-sidebar input,\n#mobius-os-sidebar select {\n  font: inherit;\n}\n\n#mobius-os-sidebar button {\n  cursor: pointer;\n}\n\n#mobius-os-sidebar .top-row,\n#mobius-os-sidebar .second-row,\n#mobius-os-sidebar .tasks-panel,\n#mobius-os-sidebar .chat-input-area,\n#mobius-os-sidebar .record-id-input,\n#mobius-os-sidebar .workflow-buttons,\n#mobius-os-sidebar .footer {\n  padding-left: 14px;\n  padding-right: 14px;\n}\n\n/* Top Row / Header */\n#mobius-os-sidebar .top-row {\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  gap: 8px;\n  padding-top: 8px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid rgba(60, 64, 67, 0.12);\n  background: white;\n  flex-shrink: 0;\n}\n\n#mobius-os-sidebar .header-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-left: auto;\n  flex-shrink: 0;\n}\n\n#mobius-os-sidebar .header-left {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  flex: 0 1 auto;\n  min-width: 0;\n}\n\n#mobius-os-sidebar .client-logo {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 11px;\n  color: #5f6368;\n  min-width: 100px;\n}\n\n#mobius-os-sidebar .client-logo img {\n  width: 24px;\n  height: 24px;\n  border-radius: 4px;\n}\n\n#mobius-os-sidebar .client-logo-svg {\n  width: 24px;\n  height: 24px;\n  flex-shrink: 0;\n}\n\n#mobius-os-sidebar .client-logo-svg svg {\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n\n#mobius-os-sidebar .client-logo-placeholder {\n  width: 24px;\n  height: 24px;\n  background: #e8eaed;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 10px;\n  color: #5f6368;\n}\n\n#mobius-os-sidebar .client-name {\n  font-weight: 500;\n  color: #202124;\n}\n\n#mobius-os-sidebar .logo-section {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-wrap: nowrap;\n  min-width: 0;\n}\n\n#mobius-os-sidebar .mobius-logo {\n  width: 32px;\n  height: 32px;\n  position: relative;\n}\n\n#mobius-os-sidebar .mobius-logo svg {\n  width: 100%;\n  height: 100%;\n}\n\n#mobius-os-sidebar .mobius-logo .path-normal {\n  display: none;\n}\n\n#mobius-os-sidebar .mobius-logo .path-processing {\n  display: block;\n}\n\n#mobius-os-sidebar .mobius-logo:not(.status-processing) .path-normal {\n  display: block;\n}\n\n#mobius-os-sidebar .mobius-logo:not(.status-processing) .path-processing {\n  display: none;\n}\n\n#mobius-os-sidebar .logo-label {\n  font-weight: 500;\n  font-size: 12px;\n  color: #202124;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 120px;\n}\n\n#mobius-os-sidebar .context-display {\n  flex: 1 1 auto;\n  margin: 0;\n  font-size: 11px;\n  color: #5f6368;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  justify-content: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  min-width: 0;\n}\n\n#mobius-os-sidebar .status-indicator {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  flex-shrink: 0;\n}\n\n#mobius-os-sidebar .status-proceed,\n#mobius-os-sidebar .status-green {\n  background: #16a34a;\n  box-shadow: 0 0 4px rgba(22, 163, 74, 0.6);\n}\n\n#mobius-os-sidebar .status-pending,\n#mobius-os-sidebar .status-yellow {\n  background: #f59e0b;\n  box-shadow: 0 0 4px rgba(245, 158, 11, 0.6);\n}\n\n#mobius-os-sidebar .status-error,\n#mobius-os-sidebar .status-red {\n  background: #dc2626;\n  box-shadow: 0 0 4px rgba(220, 38, 38, 0.6);\n}\n\n#mobius-os-sidebar .status-blue {\n  background: #2563eb;\n  box-shadow: 0 0 4px rgba(37, 99, 235, 0.6);\n}\n\n#mobius-os-sidebar .status-grey {\n  background: #94a3b8;\n  box-shadow: 0 0 4px rgba(148, 163, 184, 0.6);\n}\n\n#mobius-os-sidebar .mode-badge {\n  display: inline-block;\n  padding: 3px 8px;\n  background: rgba(26, 115, 232, 0.10);\n  color: #1a73e8;\n  border-radius: 12px;\n  font-size: 10px;\n  font-weight: 600;\n  margin-left: 8px;\n  text-transform: uppercase;\n}\n\n#mobius-os-sidebar .alert-btn,\n#mobius-os-sidebar .settings-btn {\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(60, 64, 67, 0.18);\n  background: white;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n#mobius-os-sidebar .alert-btn {\n  font-size: 16px;\n  position: relative;\n  margin-right: 8px;\n}\n\n#mobius-os-sidebar .settings-btn {\n  font-size: 18px;\n}\n\n#mobius-os-sidebar .alert-btn:hover,\n#mobius-os-sidebar .settings-btn:hover {\n  background: #f5f5f5;\n}\n\n/* Collapse button (added to header actions) */\n#mobius-os-sidebar .collapse-btn {\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(60, 64, 67, 0.18);\n  background: white;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 16px;\n  line-height: 1;\n}\n\n#mobius-os-sidebar .collapse-btn:hover {\n  background: #f5f5f5;\n}\n\n/* Second Row */\n#mobius-os-sidebar .second-row {\n  padding-top: 10px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid rgba(60, 64, 67, 0.12);\n  background: white;\n  flex-shrink: 0;\n}\n\n#mobius-os-sidebar .context-summary {\n  font-size: 12px;\n  color: #202124;\n  margin-bottom: 6px;\n  line-height: 1.4;\n}\n\n#mobius-os-sidebar .quick-action-btn {\n  display: inline-block;\n  padding: 7px 12px;\n  background: #1a73e8;\n  color: white;\n  border-radius: 10px;\n  font-size: 12px;\n  cursor: pointer;\n  border: none;\n}\n\n#mobius-os-sidebar .quick-action-btn:hover {\n  background: #1565c0;\n}\n\n/* Tasks Panel */\n#mobius-os-sidebar .tasks-panel {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid rgba(60, 64, 67, 0.12);\n  background: #fff;\n  max-height: 150px;\n  overflow-y: auto;\n  flex-shrink: 0;\n}\n\n#mobius-os-sidebar .tasks-panel-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  font-size: 11px;\n  font-weight: 600;\n  color: #5f6368;\n  margin-bottom: 6px;\n}\n\n#mobius-os-sidebar .tasks-panel-content {\n  display: none;\n}\n\n#mobius-os-sidebar .tasks-panel-content.show {\n  display: block;\n}\n\n#mobius-os-sidebar .task-item {\n  display: flex;\n  align-items: flex-start;\n  gap: 8px;\n  padding: 4px 0;\n  font-size: 12px;\n  color: #202124;\n}\n\n#mobius-os-sidebar .task-item.shared {\n  color: #1a73e8;\n}\n\n#mobius-os-sidebar .task-item.backend {\n  color: #5f6368;\n  font-style: italic;\n}\n\n/* Chat Area */\n#mobius-os-sidebar .chat-area {\n  flex: 1;\n  overflow-y: auto;\n  padding: 10px 12px;\n  background: #ffffff;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  justify-content: flex-end;\n  min-height: 0;\n  flex-shrink: 1;\n}\n\n#mobius-os-sidebar .message {\n  max-width: 75%;\n  padding: 7px 10px;\n  border-radius: 10px;\n  font-size: 11px;\n  line-height: 1.45;\n  color: #0b1220;\n}\n\n#mobius-os-sidebar .system-message {\n  /* Stretch to full width to avoid shrink-to-fit issues with inline-block bubble max-width. */\n  align-self: stretch;\n  width: 100%;\n  background: transparent;\n  border: none;\n  padding: 0;\n  max-width: 100%;\n  color: #0b1220;\n}\n\n#mobius-os-sidebar .message-content {\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n/* Compact assistant \"bubble\" */\n#mobius-os-sidebar .system-message .message-content {\n  margin-top: 4px;\n  display: inline-block;\n  background: rgba(11, 18, 32, 0.03);\n  border: 1px solid rgba(11, 18, 32, 0.10);\n  padding: 7px 10px;\n  border-radius: 10px;\n  max-width: 92%;\n}\n\n/* Make tools unobtrusive (Mini-style) */\n#mobius-os-sidebar .system-message .message-header {\n  margin-bottom: 2px;\n}\n\n#mobius-os-sidebar .system-message .message-tools-btn {\n  width: 22px;\n  height: 22px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  border-radius: 6px;\n  opacity: 0.0;\n  transition: opacity 0.12s ease, background 0.15s ease;\n}\n\n#mobius-os-sidebar .system-message:hover .message-tools-btn {\n  opacity: 0.85;\n}\n\n#mobius-os-sidebar .system-message .message-tools-btn:hover {\n  opacity: 1;\n  background: rgba(11, 18, 32, 0.06);\n}\n\n#mobius-os-sidebar .user-message {\n  align-self: flex-end;\n  background: #2563eb;\n  color: white;\n}\n\n/* Thinking (minimal, collapsible line) */\n#mobius-os-sidebar .thinking-line {\n  margin: 0 0 6px 0;\n  padding: 0;\n  border: none;\n  background: transparent;\n  color: rgba(91, 102, 122, 0.7);\n  font-size: 11px;\n}\n\n#mobius-os-sidebar .thinking-line summary {\n  list-style: none;\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 0;\n}\n\n#mobius-os-sidebar .thinking-line summary::-webkit-details-marker {\n  display: none;\n}\n\n#mobius-os-sidebar .thinking-line summary::after {\n  content: '';\n  margin-left: auto;\n  opacity: 0.7;\n}\n\n#mobius-os-sidebar .thinking-line[open] summary::after {\n  content: '';\n}\n\n#mobius-os-sidebar .thinking-body {\n  margin-top: 4px;\n  padding-left: 10px;\n  border-left: 2px solid rgba(11, 18, 32, 0.12);\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n/* Chat Input */\n#mobius-os-sidebar .chat-input-area {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\n  background: white;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-shrink: 0;\n  width: 100%;\n}\n\n#mobius-os-sidebar .chat-input {\n  flex: 1;\n  width: 100%;\n  min-width: 0;\n  padding: 8px 12px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  border-radius: 10px;\n  font-size: 11px;\n  outline: none;\n  background: #fff;\n  resize: none;\n  overflow: hidden;\n  line-height: 1.4;\n  -webkit-appearance: none;\n  appearance: none;\n  color: #0b1220;\n}\n\n#mobius-os-sidebar .chat-input::placeholder {\n  color: rgba(91, 102, 122, 0.7);\n}\n\n#mobius-os-sidebar .chat-input:focus {\n  border-color: #2563eb;\n}\n\n/* Message-level tools (system messages) */\n#mobius-os-sidebar .message-header {\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: 6px;\n}\n\n#mobius-os-sidebar .message-tools {\n  position: relative;\n}\n\n#mobius-os-sidebar .message-tools-btn {\n  width: 22px;\n  height: 22px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  border-radius: 6px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0;\n  line-height: 1;\n}\n\n#mobius-os-sidebar .message-tools-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n#mobius-os-sidebar .message-tools-dropdown {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  margin-top: 6px;\n  background: #fff;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  border-radius: 12px;\n  box-shadow: 0 14px 28px rgba(2, 6, 23, 0.18);\n  display: none;\n  flex-direction: column;\n  min-width: 140px;\n  z-index: 2;\n}\n\n#mobius-os-sidebar .message-tools-dropdown.show {\n  display: flex;\n}\n\n#mobius-os-sidebar .message-tools-item {\n  padding: 10px 12px;\n  border: none;\n  background: white;\n  text-align: left;\n  font-size: 12px;\n  font-weight: 600;\n  color: #0b1220;\n}\n\n#mobius-os-sidebar .message-tools-item:hover {\n  background: rgba(11, 18, 32, 0.04);\n}\n\n/* Chat tools (make compact, not stacked) */\n#mobius-os-sidebar .chat-tools {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n#mobius-os-sidebar .chat-tool-btn {\n  width: 22px;\n  height: 22px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  border-radius: 6px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0;\n}\n\n#mobius-os-sidebar .chat-tool-btn:hover {\n  background: rgba(60, 64, 67, 0.06);\n}\n\n#mobius-os-sidebar .tools-menu {\n  position: relative;\n}\n\n#mobius-os-sidebar .tools-dropdown {\n  position: absolute;\n  bottom: 100%;\n  right: 0;\n  margin-bottom: 6px;\n  background: white;\n  border: 1px solid rgba(60, 64, 67, 0.18);\n  border-radius: 10px;\n  box-shadow: 0 10px 24px rgba(0,0,0,0.10);\n  display: none;\n  flex-direction: column;\n  min-width: 140px;\n  z-index: 2;\n}\n\n#mobius-os-sidebar .tools-dropdown.show {\n  display: flex;\n}\n\n#mobius-os-sidebar .tools-dropdown button {\n  padding: 10px 12px;\n  border: none;\n  background: white;\n  text-align: left;\n  font-size: 12px;\n}\n\n#mobius-os-sidebar .tools-dropdown button:hover {\n  background: rgba(60, 64, 67, 0.06);\n}\n\n/* Record ID Input */\n#mobius-os-sidebar .record-id-input {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  border-top: 1px solid rgba(60, 64, 67, 0.12);\n  background: white;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-shrink: 0;\n}\n\n#mobius-os-sidebar .record-id-input label {\n  font-size: 11px;\n  color: #5f6368;\n  font-weight: 600;\n  white-space: nowrap;\n}\n\n#mobius-os-sidebar .record-id-input select {\n  padding: 6px 8px;\n  border: 1px solid rgba(60, 64, 67, 0.18);\n  border-radius: 8px;\n  font-size: 12px;\n  background: #fff;\n}\n\n#mobius-os-sidebar .record-id-input input {\n  flex: 1;\n  padding: 7px 10px;\n  border: 1px solid rgba(60, 64, 67, 0.18);\n  border-radius: 8px;\n  font-size: 12px;\n  outline: none;\n}\n\n/* Workflow Buttons */\n#mobius-os-sidebar .workflow-buttons {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  border-top: 1px solid rgba(60, 64, 67, 0.12);\n  background: #fff;\n  display: flex;\n  gap: 8px;\n  flex-wrap: wrap;\n  flex-shrink: 0;\n}\n\n#mobius-os-sidebar .context-button {\n  padding: 8px 10px;\n  background: rgba(60, 64, 67, 0.06);\n  border: 1px solid rgba(60, 64, 67, 0.10);\n  border-radius: 10px;\n  font-size: 12px;\n}\n\n#mobius-os-sidebar .context-button:hover {\n  background: rgba(60, 64, 67, 0.10);\n}\n\n/* Footer */\n#mobius-os-sidebar .footer {\n  padding-top: 10px;\n  padding-bottom: 10px;\n  border-top: 1px solid rgba(60, 64, 67, 0.12);\n  background: #fff;\n  flex-shrink: 0;\n}\n\n#mobius-os-sidebar .user-details {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 10px;\n  flex-wrap: nowrap;\n}\n\n#mobius-os-sidebar .user-info {\n  font-size: 12px;\n  color: #5f6368;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  min-width: 0;\n}\n\n#mobius-os-sidebar .preferences {\n  display: flex;\n  gap: 10px;\n  font-size: 11px;\n  align-items: center;\n  white-space: nowrap;\n}\n\n#mobius-os-sidebar .preferences-panel {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  min-width: 0;\n}\n\n#mobius-os-sidebar .preferences-expanded {\n  display: none;\n  margin-top: 6px;\n}\n\n#mobius-os-sidebar .preferences-expanded.show {\n  display: block;\n}\n\n#mobius-os-sidebar .preference-group {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  justify-content: flex-end;\n  margin-bottom: 6px;\n}\n\n#mobius-os-sidebar .preference-group label {\n  font-size: 11px;\n  color: #5f6368;\n  white-space: nowrap;\n}\n\n#mobius-os-sidebar .preference-group select {\n  padding: 6px 8px;\n  border: 1px solid rgba(60, 64, 67, 0.18);\n  border-radius: 8px;\n  font-size: 12px;\n  background: #fff;\n}\n\n#mobius-os-sidebar .preference-item {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 3px 6px;\n  border-radius: 8px;\n}\n\n#mobius-os-sidebar .preference-item:hover {\n  background: rgba(60, 64, 67, 0.06);\n}\n\n#mobius-os-sidebar .pref-value {\n  color: #1a73e8;\n  font-weight: 600;\n  font-size: 11px;\n}\n\n/* Guidance / Follow-up actions (system message CTA buttons) */\n#mobius-os-sidebar .guidance-actions {\n  margin-top: 8px;\n  padding: 6px 8px;\n  display: flex;\n  gap: 6px;\n  flex-wrap: wrap;\n  align-items: center;\n  border-radius: 10px;\n  border: 1px solid rgba(26, 115, 232, 0.18);\n  background: rgba(26, 115, 232, 0.06);\n}\n\n#mobius-os-sidebar .guidance-action-btn {\n  appearance: none;\n  border: 1px solid rgba(26, 115, 232, 0.28);\n  background: rgba(26, 115, 232, 0.10);\n  color: #174ea6;\n  padding: 5px 10px;\n  border-radius: 999px;\n  font-size: 12px;\n  line-height: 1.2;\n}\n\n#mobius-os-sidebar .guidance-action-btn:hover {\n  background: rgba(26, 115, 232, 0.16);\n  border-color: rgba(26, 115, 232, 0.38);\n}\n\n/**\n * Mini widget styles (scoped; does not affect host page nor #mobius-os-sidebar).\n */\n#mobius-os-mini,\n#mobius-os-mini * {\n  box-sizing: border-box;\n}\n\n#mobius-os-mini {\n  position: fixed !important;\n  z-index: 2147483646 !important;\n  width: 300px;\n  background: #ffffff !important;\n  color: #0b1220 !important;\n  border: 1px solid rgba(11, 18, 32, 0.12) !important;\n  border-radius: 14px !important;\n  box-shadow: 0 16px 34px rgba(2, 6, 23, 0.14) !important;\n  overflow: hidden !important;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Google Sans', sans-serif !important;\n  font-size: 12px !important;\n  font-weight: 500 !important;\n  user-select: none !important;\n}\n\n#mobius-os-mini button,\n#mobius-os-mini input {\n  font: inherit;\n}\n\n#mobius-os-mini .mobius-mini-header {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 5px 8px;\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\n  background: rgba(11, 18, 32, 0.02);\n  cursor: grab;\n  touch-action: none;\n}\n\n#mobius-os-mini .mobius-mini-drag-handle {\n  width: 20px;\n  height: 20px;\n  border-radius: 6px;\n  border: 1px solid rgba(11, 18, 32, 0.10);\n  background: rgba(11, 18, 32, 0.03);\n  display: grid;\n  place-items: center;\n  cursor: grab;\n  flex: 0 0 auto;\n  touch-action: none;\n}\n\n#mobius-os-mini .mobius-mini-drag-handle:active {\n  cursor: grabbing;\n}\n\n#mobius-os-mini .mobius-mini-drag-dots {\n  width: 8px;\n  height: 14px;\n  background:\n    radial-gradient(circle, rgba(11,18,32,0.35) 1.5px, transparent 2px) 0 0/5px 5px;\n  border-radius: 4px;\n}\n\n#mobius-os-mini .mobius-mini-brand {\n  display: inline-flex;\n  align-items: center;\n  gap: 5px;\n  min-width: 0;\n  flex: 1 1 auto;\n}\n\n#mobius-os-mini .mobius-mini-brand .mobius-logo {\n  width: 18px;\n  height: 18px;\n}\n\n/* Client logo in Mini widget */\n#mobius-os-mini .client-logo {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  flex-shrink: 0;\n}\n\n#mobius-os-mini .client-logo.client-logo-compact {\n  gap: 0;\n}\n\n#mobius-os-mini .client-logo img {\n  width: 18px;\n  height: 18px;\n  border-radius: 3px;\n}\n\n#mobius-os-mini .client-logo-svg {\n  width: 18px;\n  height: 18px;\n  flex-shrink: 0;\n}\n\n#mobius-os-mini .client-logo-svg svg {\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n\n#mobius-os-mini .client-logo-placeholder {\n  width: 18px;\n  height: 18px;\n  background: #e8eaed;\n  border-radius: 3px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 8px;\n  color: #5f6368;\n  font-weight: 600;\n}\n\n#mobius-os-mini .client-name {\n  font-size: 9px;\n  font-weight: 500;\n  color: #5f6368;\n  white-space: nowrap;\n}\n\n/* Divider between client logo and Mobius brand */\n#mobius-os-mini .mobius-mini-brand-divider {\n  width: 1px;\n  height: 14px;\n  background: rgba(11, 18, 32, 0.12);\n  margin: 0 2px;\n}\n\n#mobius-os-mini .mobius-logo {\n  width: 18px;\n  height: 18px;\n  position: relative;\n}\n\n#mobius-os-mini .mobius-logo svg {\n  width: 100%;\n  height: 100%;\n}\n\n/* Match sidebar/popup behavior: show only one path depending on status */\n#mobius-os-mini .mobius-logo .path-normal {\n  display: none;\n}\n\n#mobius-os-mini .mobius-logo .path-processing {\n  display: block;\n}\n\n#mobius-os-mini .mobius-logo:not(.status-processing) .path-normal {\n  display: block;\n}\n\n#mobius-os-mini .mobius-logo:not(.status-processing) .path-processing {\n  display: none;\n}\n\n#mobius-os-mini .mobius-mini-brand-text {\n  font-size: 10px;\n  font-weight: 600;\n  color: #0b1220;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n#mobius-os-mini .mobius-mini-menu-btn {\n  width: 22px;\n  height: 22px;\n  border-radius: 6px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n  font-weight: 600;\n  font-size: 10px;\n}\n\n#mobius-os-mini .mobius-mini-expand-btn {\n  width: 22px;\n  height: 22px;\n  border-radius: 6px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n  font-weight: 600;\n  font-size: 12px;\n  line-height: 1;\n}\n\n#mobius-os-mini .mobius-mini-expand-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n#mobius-os-mini .mobius-mini-minimize-btn {\n  width: 22px;\n  height: 22px;\n  border-radius: 6px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n  font-weight: 600;\n  font-size: 14px;\n  line-height: 1;\n  color: #374151;\n}\n\n#mobius-os-mini .mobius-mini-minimize-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n#mobius-os-mini .mobius-mini-menu-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n/* Minimized state - compact pill */\n#mobius-os-mini.mobius-mini-minimized {\n  width: auto !important;\n  min-width: unset !important;\n  max-width: unset !important;\n  padding: 0 !important;\n  border-radius: 20px !important;\n}\n\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-header {\n  padding: 6px 10px;\n  gap: 8px;\n}\n\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-brand {\n  display: none;\n}\n\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-expand-btn,\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-menu-btn {\n  display: none;\n}\n\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-row,\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-attention-row,\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-task-badge-row,\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-note-row {\n  display: none !important;\n}\n\n/* Minimized info - patient name + attention dot (hidden by default) */\n#mobius-os-mini .mobius-mini-minimized-info {\n  display: none;\n  align-items: center;\n  gap: 6px;\n  max-width: 140px;\n}\n\n#mobius-os-mini .mobius-mini-minimized-patient {\n  font-size: 10px;\n  font-weight: 500;\n  color: #374151;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* Show minimized info only when minimized */\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-minimized-info {\n  display: flex;\n}\n\n#mobius-os-mini .mobius-mini-menu {\n  position: absolute;\n  top: 42px;\n  right: 10px;\n  background: #fff;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  border-radius: 12px;\n  box-shadow: 0 14px 28px rgba(2,6,23,0.18);\n  overflow: visible;\n  z-index: 2147483647;\n  min-width: 140px;\n  pointer-events: auto !important;\n}\n\n#mobius-os-mini .mobius-mini-menu-item {\n  display: block;\n  width: 100%;\n  text-align: left;\n  padding: 10px 12px;\n  border: none;\n  background: #fff;\n  font-size: 12px;\n  font-weight: 600;\n  cursor: pointer;\n  pointer-events: auto !important;\n}\n\n#mobius-os-mini .mobius-mini-menu-item:hover {\n  background: rgba(11, 18, 32, 0.04);\n}\n\n#mobius-os-mini .mobius-mini-menu-item.danger {\n  color: #b3261e;\n}\n\n/* Theme submenu */\n#mobius-os-mini .mobius-mini-theme-trigger {\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  color: #0b1220;\n}\n\n#mobius-os-mini .mobius-mini-theme-trigger:hover {\n  background: rgba(11, 18, 32, 0.04);\n}\n\n#mobius-os-mini .mobius-mini-theme-submenu {\n  background: #f8fafc;\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\n  margin: 0;\n  padding: 0;\n}\n\n#mobius-os-mini .mobius-mini-theme-submenu .mobius-mini-menu-item {\n  padding: 8px 12px 8px 16px;\n  font-size: 11px;\n  background: #f8fafc;\n  color: #0b1220;\n}\n\n#mobius-os-mini .mobius-mini-theme-submenu .mobius-mini-menu-item:hover {\n  background: rgba(11, 18, 32, 0.08);\n}\n\n#mobius-os-mini .mobius-mini-row {\n  padding: 6px 10px;\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n#mobius-os-mini .mobius-mini-row:last-child {\n  border-bottom: none;\n}\n\n#mobius-os-mini .mobius-mini-row-label {\n  width: 48px;\n  flex: 0 0 auto;\n  font-size: 9px;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: rgba(91,102,122,0.95);\n  font-weight: 600;\n}\n\n#mobius-os-mini .mobius-mini-row-body {\n  min-width: 0;\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n}\n\n#mobius-os-mini .mobius-mini-patient-name {\n  font-size: 11px;\n  font-weight: 600;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n#mobius-os-mini .mobius-mini-patient-id {\n  font-size: 9px;\n  font-weight: 500;\n  color: rgba(91,102,122,0.95);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n#mobius-os-mini .mobius-mini-patient-dob {\n  font-size: 9px;\n  font-weight: 500;\n  color: rgba(91,102,122,0.95);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n#mobius-os-mini .mobius-mini-inline-btn {\n  height: 28px;\n  border-radius: 10px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  font-weight: 600;\n  font-size: 11px;\n  padding: 0 10px;\n}\n\n#mobius-os-mini .mobius-mini-inline-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n/* Icon-only button (e.g., edit patient) */\n#mobius-os-mini .mobius-mini-icon-btn {\n  width: 28px;\n  height: 28px;\n  border-radius: 10px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n  padding: 0;\n}\n\n#mobius-os-mini .mobius-mini-icon-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n#mobius-os-mini .mobius-mini-icon-btn svg {\n  width: 16px;\n  height: 16px;\n  fill: rgba(11, 18, 32, 0.80);\n}\n\n#mobius-os-mini .mobius-mini-status {\n  width: 100%;\n  border: 1px solid rgba(11, 18, 32, 0.10);\n  background: rgba(11, 18, 32, 0.03);\n  border-radius: 10px;\n  padding: 5px 8px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 10px;\n  font-weight: 600;\n  color: #0b1220;\n}\n\n#mobius-os-mini .mobius-mini-status:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n#mobius-os-mini .mobius-mini-dot {\n  width: 8px;\n  height: 8px;\n  border-radius: 999px;\n  flex: 0 0 auto;\n  box-shadow: 0 0 0 3px rgba(148, 163, 184, 0.18);\n  background: #94a3b8;\n}\n\n#mobius-os-mini .dot-green {\n  background: #16a34a;\n  box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.14);\n}\n\n#mobius-os-mini .dot-yellow {\n  background: #f59e0b;\n  box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.18);\n}\n\n#mobius-os-mini .dot-blue {\n  background: #2563eb;\n  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.16);\n}\n\n#mobius-os-mini .dot-grey {\n  background: #94a3b8;\n  box-shadow: 0 0 0 3px rgba(148, 163, 184, 0.18);\n}\n\n#mobius-os-mini .dot-red {\n  background: #dc2626;\n  box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.18);\n}\n\n#mobius-os-mini .dot-purple {\n  background: #9333ea;\n  box-shadow: 0 0 0 3px rgba(147, 51, 234, 0.18);\n}\n\n#mobius-os-mini .mobius-mini-status-text {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  min-width: 0;\n  flex: 1;\n}\n\n/* Needs Attention row - refined spacing */\n#mobius-os-mini .mobius-mini-attention-row {\n  padding: 10px;\n  gap: 10px;\n}\n\n#mobius-os-mini .mobius-mini-attention-row .mobius-mini-row-label {\n  width: 48px;\n  font-size: 9px;\n  line-height: 1.2;\n  flex-shrink: 0;\n}\n\n#mobius-os-mini .mobius-mini-attention-content {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n\n#mobius-os-mini .mobius-mini-question-text {\n  flex: 1;\n  font-size: 11px;\n  color: #1e293b;\n  line-height: 1.3;\n  min-width: 100px;\n}\n\n#mobius-os-mini .mobius-mini-attention-content {\n  flex: 1;\n  display: flex;\n  align-items: flex-start;\n  gap: 8px;\n  min-width: 0;\n}\n\n#mobius-os-mini .mobius-mini-attention-content .mobius-mini-dot {\n  margin-top: 4px;\n  margin-left: 2px;\n  flex-shrink: 0;\n}\n\n#mobius-os-mini .mobius-mini-problem-text {\n  flex: 1;\n  white-space: normal;\n  word-wrap: break-word;\n  text-align: left;\n  min-width: 0;\n  font-size: 9px;\n  line-height: 1.35;\n  color: #0b1220;\n  padding-right: 6px;\n}\n\n/* Status badge - clickable */\n#mobius-os-mini .mobius-mini-status-badge {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 3px 8px;\n  border: 1px solid rgba(11, 18, 32, 0.15);\n  border-radius: 4px;\n  background: rgba(11, 18, 32, 0.04);\n  cursor: pointer;\n  flex-shrink: 0;\n  font-size: 8px;\n  font-weight: 500;\n  color: #64748b;\n  margin-left: 4px;\n}\n\n#mobius-os-mini .mobius-mini-status-badge:hover {\n  background: rgba(11, 18, 32, 0.08);\n}\n\n#mobius-os-mini .mobius-mini-status-badge.status-resolved {\n  background: rgba(22, 163, 74, 0.1);\n  border-color: rgba(22, 163, 74, 0.3);\n  color: #16a34a;\n}\n\n#mobius-os-mini .mobius-mini-status-badge.status-unresolved {\n  background: rgba(245, 158, 11, 0.1);\n  border-color: rgba(245, 158, 11, 0.3);\n  color: #d97706;\n}\n\n#mobius-os-mini .mobius-mini-status-badge.status-unconfirmed {\n  background: rgba(148, 163, 184, 0.15);\n  border-color: rgba(148, 163, 184, 0.4);\n  color: #64748b;\n}\n\n#mobius-os-mini .mobius-mini-dropdown-icon {\n  font-size: 6px;\n  color: inherit;\n  opacity: 0.7;\n}\n\n/* Task badge row - compact */\n#mobius-os-mini .mobius-mini-task-badge-row {\n  padding: 6px 10px;\n}\n\n#mobius-os-mini .mobius-mini-task-badge-row .mobius-mini-row-label {\n  width: 48px;\n  font-size: 9px;\n  line-height: 1.2;\n}\n\n#mobius-os-mini .mobius-mini-task-badge {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 8px;\n  border: 1px solid rgba(11, 18, 32, 0.10);\n  background: rgba(37, 99, 235, 0.06);\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 9px;\n  font-weight: 500;\n  color: #2563eb;\n}\n\n#mobius-os-mini .mobius-mini-task-badge:hover {\n  background: rgba(37, 99, 235, 0.12);\n}\n\n#mobius-os-mini .mobius-mini-task-count {\n  font-weight: 700;\n}\n\n/* Answer dropdown styling */\n.mobius-mini-answer-dropdown {\n  background: white !important;\n  border-radius: 6px !important;\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12) !important;\n  padding: 4px 0 !important;\n  min-width: 160px !important;\n  display: flex !important;\n  flex-direction: column !important;\n}\n\n.mobius-mini-answer-dropdown .mobius-mini-dropdown-item {\n  display: block !important;\n  width: 100% !important;\n  padding: 8px 12px !important;\n  font-size: 10px !important;\n  text-align: left !important;\n  background: transparent !important;\n  border: none !important;\n  cursor: pointer !important;\n  color: #1e293b !important;\n  line-height: 1.3 !important;\n}\n\n.mobius-mini-answer-dropdown .mobius-mini-dropdown-item:hover {\n  background: rgba(37, 99, 235, 0.08) !important;\n}\n\n#mobius-os-mini .mobius-mini-step-question {\n  font-size: 10px;\n  font-weight: 500;\n  color: #1e293b;\n  line-height: 1.3;\n}\n\n#mobius-os-mini .mobius-mini-step-buttons {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 4px;\n}\n\n#mobius-os-mini .mobius-mini-quick-answer-btn {\n  padding: 4px 8px;\n  font-size: 9px;\n  font-weight: 500;\n  border: 1px solid rgba(37, 99, 235, 0.2);\n  background: white;\n  color: #2563eb;\n  border-radius: 12px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n#mobius-os-mini .mobius-mini-quick-answer-btn:hover {\n  background: rgba(37, 99, 235, 0.08);\n  border-color: #2563eb;\n}\n\n#mobius-os-mini .mobius-mini-quick-answer-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n#mobius-os-mini .mobius-mini-quick-answer-btn.suggested {\n  background: rgba(34, 197, 94, 0.1);\n  border-color: rgba(34, 197, 94, 0.3);\n  color: #16a34a;\n}\n\n#mobius-os-mini .mobius-mini-quick-answer-btn.suggested:hover {\n  background: rgba(34, 197, 94, 0.2);\n}\n\n#mobius-os-mini .mobius-mini-open-sidecar-btn {\n  padding: 4px 10px;\n  font-size: 9px;\n  font-weight: 500;\n  border: none;\n  background: #2563eb;\n  color: white;\n  border-radius: 12px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n#mobius-os-mini .mobius-mini-open-sidecar-btn:hover {\n  background: #1d4ed8;\n}\n\n/* Dark theme for status row */\n#mobius-os-mini.theme-dark .mobius-mini-question-text {\n  color: #e5e7eb;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-quick-answer-btn {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n  color: #e5e7eb;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-quick-answer-btn:hover {\n  background: rgba(255, 255, 255, 0.15);\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-quick-answer-btn.suggested {\n  background: rgba(34, 197, 94, 0.2);\n  border-color: rgba(34, 197, 94, 0.4);\n  color: #4ade80;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-open-sidecar-btn {\n  background: #3b82f6;\n}\n\n/* User Greeting Row */\n#mobius-os-mini .mobius-mini-greeting-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 5px 10px;\n  background: linear-gradient(90deg, rgba(37, 99, 235, 0.04), rgba(99, 102, 241, 0.02));\n  border-bottom: 1px solid rgba(11, 18, 32, 0.06);\n  position: relative;\n}\n\n#mobius-os-mini .mobius-mini-greeting-main {\n  display: flex;\n  align-items: center;\n  gap: 3px;\n  background: none;\n  border: none;\n  padding: 0;\n  cursor: pointer;\n  color: inherit;\n  font: inherit;\n}\n\n#mobius-os-mini .mobius-mini-greeting-main:hover {\n  opacity: 0.8;\n}\n\n#mobius-os-mini .mobius-mini-greeting-text {\n  font-size: 9px;\n  font-weight: 500;\n  color: #3b82f6;\n}\n\n#mobius-os-mini .mobius-mini-greeting-chevron {\n  color: #60a5fa;\n  opacity: 0.6;\n  width: 10px;\n  height: 10px;\n}\n\n#mobius-os-mini .mobius-mini-greeting-dismiss {\n  width: 16px;\n  height: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: none;\n  border: none;\n  border-radius: 3px;\n  cursor: pointer;\n  color: #94a3b8;\n  padding: 0;\n}\n\n#mobius-os-mini .mobius-mini-greeting-dismiss:hover {\n  background: rgba(11, 18, 32, 0.06);\n  color: #64748b;\n}\n\n#mobius-os-mini .mobius-mini-greeting-dismiss svg {\n  width: 10px;\n  height: 10px;\n}\n\n/* User Dropdown */\n#mobius-os-mini .mobius-mini-user-dropdown {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n}\n\n/* Locked Overlay */\n#mobius-os-mini .mobius-mini-locked-overlay {\n  padding: 16px;\n  text-align: center;\n  background: linear-gradient(180deg, rgba(248, 250, 252, 0.98), rgba(241, 245, 249, 0.98));\n}\n\n/* Theme variations for greeting */\n#mobius-os-mini.theme-dark .mobius-mini-greeting-row {\n  background: linear-gradient(90deg, rgba(37, 99, 235, 0.12), rgba(99, 102, 241, 0.08));\n  border-bottom-color: rgba(255, 255, 255, 0.08);\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-greeting-text {\n  color: #93c5fd;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-greeting-chevron {\n  color: #60a5fa;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-greeting-dismiss {\n  color: rgba(148, 163, 184, 0.7);\n}\n\n#mobius-os-mini.theme-blue .mobius-mini-greeting-row {\n  background: linear-gradient(90deg, rgba(37, 99, 235, 0.1), rgba(96, 165, 250, 0.08));\n}\n\n#mobius-os-mini.theme-blue .mobius-mini-greeting-text {\n  color: #1d4ed8;\n}\n\n/* Attention dropdown - compact */\n#mobius-os-mini .mobius-mini-attention-dropdown {\n  min-width: 180px !important;\n  max-width: 220px;\n}\n\n#mobius-os-mini .mobius-mini-note-wrap {\n  width: 100%;\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n#mobius-os-mini .mobius-mini-note-input {\n  width: 100%;\n  height: 28px;\n  border-radius: 10px;\n  border: 1px solid rgba(11, 18, 32, 0.14);\n  background: #fff;\n  padding: 0 34px 0 8px;\n  font-size: 10px;\n  font-weight: 500;\n  color: #0b1220;\n  outline: none;\n}\n\n#mobius-os-mini .mobius-mini-note-input::placeholder {\n  color: rgba(91,102,122,0.75);\n  font-weight: 500;\n}\n\n#mobius-os-mini .mobius-mini-note-input:focus {\n  border-color: rgba(37, 99, 235, 0.55);\n}\n\n#mobius-os-mini .mobius-mini-send-btn {\n  position: absolute;\n  right: 6px;\n  width: 28px;\n  height: 28px;\n  border-radius: 10px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n  padding: 0;\n}\n\n#mobius-os-mini .mobius-mini-send-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n#mobius-os-mini .mobius-mini-send-btn svg {\n  width: 16px;\n  height: 16px;\n  display: block;\n  fill: rgba(11, 18, 32, 0.85);\n}\n\n/* =============================================================================\n   Mini Widget Themes\n   ============================================================================= */\n\n/* Theme: Light (default) - already applied via base styles */\n#mobius-os-mini.theme-light {\n  background: #ffffff !important;\n  color: #0b1220 !important;\n  border-color: rgba(11, 18, 32, 0.12) !important;\n  box-shadow: 0 16px 34px rgba(2, 6, 23, 0.14) !important;\n}\n\n/* Theme: Dark */\n#mobius-os-mini.theme-dark {\n  background: #1e293b !important;\n  color: #f1f5f9 !important;\n  border-color: #334155 !important;\n  box-shadow: 0 16px 34px rgba(0, 0, 0, 0.4) !important;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-header {\n  background: rgba(255, 255, 255, 0.03);\n  border-bottom-color: rgba(255, 255, 255, 0.08);\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-brand-text {\n  color: #f1f5f9;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-row {\n  border-bottom-color: rgba(255, 255, 255, 0.08);\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-row-label {\n  color: rgba(148, 163, 184, 0.9);\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-patient-name {\n  color: #f1f5f9;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-patient-id,\n#mobius-os-mini.theme-dark .mobius-mini-patient-dob {\n  color: rgba(148, 163, 184, 0.9);\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-minimized-patient {\n  color: #e2e8f0;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-problem-text {\n  color: #e2e8f0;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-status-badge {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.15);\n  color: #94a3b8;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-note-input {\n  background: #0f172a;\n  border-color: rgba(255, 255, 255, 0.12);\n  color: #f1f5f9;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-note-input::placeholder {\n  color: rgba(148, 163, 184, 0.6);\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-menu-btn,\n#mobius-os-mini.theme-dark .mobius-mini-expand-btn,\n#mobius-os-mini.theme-dark .mobius-mini-minimize-btn,\n#mobius-os-mini.theme-dark .mobius-mini-drag-handle,\n#mobius-os-mini.theme-dark .mobius-mini-icon-btn,\n#mobius-os-mini.theme-dark .mobius-mini-send-btn {\n  background: rgba(255, 255, 255, 0.06);\n  border-color: rgba(255, 255, 255, 0.12);\n  color: #e5e7eb;\n}\n\n#mobius-os-mini.theme-dark .mobius-mini-task-badge {\n  background: rgba(37, 99, 235, 0.15);\n  border-color: rgba(37, 99, 235, 0.3);\n}\n\n/* Theme: Blue */\n#mobius-os-mini.theme-blue {\n  background: #eff6ff !important;\n  color: #1e3a5f !important;\n  border-color: #bfdbfe !important;\n  box-shadow: 0 16px 34px rgba(37, 99, 235, 0.15) !important;\n}\n\n#mobius-os-mini.theme-blue .mobius-mini-header {\n  background: rgba(37, 99, 235, 0.05);\n  border-bottom-color: rgba(37, 99, 235, 0.1);\n}\n\n#mobius-os-mini.theme-blue .mobius-mini-brand-text {\n  color: #1e40af;\n}\n\n#mobius-os-mini.theme-blue .mobius-mini-row {\n  border-bottom-color: rgba(37, 99, 235, 0.1);\n}\n\n#mobius-os-mini.theme-blue .mobius-mini-row-label {\n  color: #3b82f6;\n}\n\n#mobius-os-mini.theme-blue .mobius-mini-patient-name {\n  color: #1e3a5f;\n}\n\n#mobius-os-mini.theme-blue .mobius-mini-status-badge {\n  background: rgba(37, 99, 235, 0.1);\n  border-color: rgba(37, 99, 235, 0.25);\n}\n\n#mobius-os-mini.theme-blue .mobius-mini-note-input {\n  background: #ffffff;\n  border-color: #bfdbfe;\n}\n\n/* Theme: Glass */\n#mobius-os-mini.theme-glass {\n  background: rgba(255, 255, 255, 0.8) !important;\n  color: #0b1220 !important;\n  border-color: rgba(255, 255, 255, 0.5) !important;\n  box-shadow: 0 16px 34px rgba(2, 6, 23, 0.12), 0 0 0 1px rgba(255,255,255,0.2) inset !important;\n  backdrop-filter: blur(12px) !important;\n  -webkit-backdrop-filter: blur(12px) !important;\n}\n\n#mobius-os-mini.theme-glass .mobius-mini-header {\n  background: rgba(255, 255, 255, 0.3);\n  border-bottom-color: rgba(11, 18, 32, 0.06);\n}\n\n#mobius-os-mini.theme-glass .mobius-mini-row {\n  border-bottom-color: rgba(11, 18, 32, 0.06);\n}\n\n#mobius-os-mini.theme-glass .mobius-mini-note-input {\n  background: rgba(255, 255, 255, 0.6);\n}\n\n#mobius-os-mini.theme-glass .mobius-mini-menu-btn,\n#mobius-os-mini.theme-glass .mobius-mini-expand-btn,\n#mobius-os-mini.theme-glass .mobius-mini-minimize-btn,\n#mobius-os-mini.theme-glass .mobius-mini-drag-handle {\n  background: rgba(255, 255, 255, 0.4);\n}\n\n#mobius-os-mini.theme-glass .mobius-mini-minimized-patient {\n  color: #1e293b;\n}\n\n/* Patient edit modal */\n.mobius-mini-modal-overlay {\n  position: fixed;\n  inset: 0;\n  background: rgba(2, 6, 23, 0.28);\n  z-index: 2147483647;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 18px;\n}\n\n.mobius-mini-modal {\n  width: 360px;\n  max-width: calc(100vw - 36px);\n  background: #fff;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  border-radius: 14px;\n  box-shadow: 0 18px 40px rgba(2, 6, 23, 0.20);\n  overflow: hidden;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Google Sans', sans-serif;\n  color: #0b1220;\n}\n\n.mobius-mini-modal-header {\n  padding: 10px 12px;\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 10px;\n}\n\n.mobius-mini-modal-title {\n  font-size: 12px;\n  font-weight: 600;\n}\n\n.mobius-mini-modal-close {\n  width: 28px;\n  height: 28px;\n  border-radius: 10px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n  font-weight: 600;\n}\n\n.mobius-mini-modal-close:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n.mobius-mini-modal-body {\n  padding: 14px 16px 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.mobius-mini-field {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.mobius-mini-field-label {\n  font-size: 9px;\n  letter-spacing: 0.10em;\n  text-transform: uppercase;\n  color: rgba(91,102,122,0.95);\n  font-weight: 600;\n  margin-bottom: 0;\n}\n\n.mobius-mini-search-input {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.mobius-mini-search-icon {\n  position: absolute;\n  left: 10px;\n  width: 16px;\n  height: 16px;\n  display: grid;\n  place-items: center;\n  opacity: 0.75;\n  pointer-events: none;\n}\n\n.mobius-mini-search-icon svg {\n  width: 16px;\n  height: 16px;\n  fill: rgba(91, 102, 122, 0.95);\n}\n\n.mobius-mini-input.mobius-mini-input-with-icon {\n  padding-left: 34px;\n}\n\n.mobius-mini-input {\n  width: 100%;\n  height: 34px;\n  border-radius: 12px;\n  border: 1px solid rgba(11, 18, 32, 0.14);\n  padding: 0 10px;\n  font-size: 12px;\n  font-weight: 500;\n  outline: none;\n}\n\n.mobius-mini-input:focus {\n  border-color: rgba(37, 99, 235, 0.55);\n}\n\n.mobius-mini-field-hint {\n  font-size: 12px;\n  color: rgba(91,102,122,0.95);\n}\n\n.mobius-mini-suggestions {\n  display: none;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  border-radius: 12px;\n  background: #fff;\n  overflow: hidden;\n  box-shadow: 0 12px 24px rgba(2,6,23,0.12);\n}\n\n.mobius-mini-suggestion {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 10px;\n  padding: 10px 12px;\n  border: none;\n  background: #fff;\n  cursor: pointer;\n  font: inherit;\n}\n\n.mobius-mini-suggestion:hover {\n  background: rgba(11, 18, 32, 0.04);\n}\n\n.mobius-mini-suggestion.active {\n  background: rgba(37, 99, 235, 0.10);\n}\n\n.mobius-mini-suggestion .name {\n  font-size: 12px;\n  font-weight: 600;\n  color: #0b1220;\n  min-width: 0;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.mobius-mini-suggestion .id {\n  font-size: 11px;\n  font-weight: 500;\n  color: rgba(91,102,122,0.95);\n  white-space: nowrap;\n  flex: 0 0 auto;\n}\n\n.mobius-mini-modal-actions {\n  padding: 10px 12px;\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\n  display: flex;\n  justify-content: flex-end;\n  gap: 8px;\n}\n\n.mobius-mini-btn-secondary,\n.mobius-mini-btn-primary {\n  height: 34px;\n  border-radius: 12px;\n  padding: 0 12px;\n  font-size: 12px;\n  font-weight: 600;\n  cursor: pointer;\n}\n\n.mobius-mini-btn-secondary {\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n}\n\n.mobius-mini-btn-secondary:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n.mobius-mini-btn-primary {\n  border: 1px solid rgba(37, 99, 235, 0.22);\n  background: rgba(37, 99, 235, 0.12);\n  color: #1e40af;\n}\n\n.mobius-mini-btn-primary:hover {\n  background: rgba(37, 99, 235, 0.16);\n}\n\n/* Mini toast */\n.mobius-mini-toast {\n  position: fixed;\n  left: 50%;\n  top: 16px;\n  transform: translateX(-50%);\n  background: rgba(15,23,42,0.92);\n  color: #fff;\n  padding: 10px 12px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 600;\n  z-index: 2147483647;\n  box-shadow: 0 14px 28px rgba(2,6,23,0.22);\n}\n\n/* =============================================================================\n   SIDECAR COMPONENTS\n   Minimalist, bottleneck-focused design\n   ============================================================================= */\n\n/* Status Bar - Modern minimal design */\n.sidecar-status-bar {\n  padding: 6px 12px;\n  background: #ffffff;\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.sidecar-status-bar-title-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 8px;\n}\n\n.sidecar-status-bar-title {\n  font-size: 7px;\n  font-weight: 600;\n  color: rgba(91, 102, 122, 0.95);\n  text-transform: uppercase;\n  letter-spacing: 0.04em;\n}\n\n.sidecar-status-bar-context {\n  font-size: 8px;\n  font-weight: 400;\n  color: rgba(91, 102, 122, 0.8);\n  white-space: nowrap;\n}\n\n.sidecar-status-bar-progress-row {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.sidecar-status-bar-track-wrapper {\n  flex: 1;\n  min-width: 0;\n}\n\n.sidecar-status-bar-track {\n  position: relative;\n  height: 3px;\n  border-radius: 2px;\n  /* Mono grey gradient - subtle, modern */\n  background: linear-gradient(90deg, \n    rgba(11, 18, 32, 0.08) 0%, \n    rgba(11, 18, 32, 0.12) 50%,\n    rgba(11, 18, 32, 0.06) 100%\n  );\n}\n\n/* Progress fill - darker grey to show completion */\n.sidecar-status-bar-progress {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  background: rgba(11, 18, 32, 0.35);\n  border-radius: 2px;\n  transition: width 0.3s ease;\n}\n\n/* Current position marker */\n.sidecar-status-bar-marker {\n  position: absolute;\n  top: -3px;\n  width: 9px;\n  height: 9px;\n  border-radius: 50%;\n  transform: translateX(-50%);\n  background: #0b1220;\n  border: 2px solid #ffffff;\n  box-shadow: 0 1px 3px rgba(2, 6, 23, 0.2);\n  z-index: 2;\n}\n\n/* Percentage label */\n.sidecar-status-bar-percent {\n  font-size: 9px;\n  font-weight: 600;\n  color: #0b1220;\n  white-space: nowrap;\n}\n\n/* Bottleneck Card - Core UI */\n/* Mobius Greeting */\n.sidecar-greeting {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n  padding-bottom: 8px;\n  margin-bottom: 6px;\n  border-bottom: 1px solid rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-greeting-text {\n  font-size: 12px;\n  font-weight: 500;\n  color: #0b1220;\n}\n\n.sidecar-greeting-subtext {\n  font-size: 10px;\n  font-weight: 400;\n  color: rgba(91, 102, 122, 0.6);\n}\n\n.sidecar-bottleneck-card {\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.sidecar-bottleneck-card--clear {\n  padding: 6px 0;\n}\n\n.sidecar-bottleneck-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding-bottom: 6px;\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\n}\n\n.sidecar-bottleneck-count {\n  font-size: 11px;\n  font-weight: 500;\n  color: #0b1220;\n}\n\n.sidecar-bottleneck-hint {\n  font-size: 9px;\n  font-weight: 400;\n  color: rgba(91, 102, 122, 0.6);\n}\n\n.sidecar-bottleneck-item {\n  background: #ffffff;\n  border: 1px solid rgba(11, 18, 32, 0.08);\n  border-radius: 6px;\n  padding: 6px 8px;\n  display: flex;\n  box-shadow: none;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.sidecar-bottleneck-question-row {\n  display: flex;\n  align-items: flex-start;\n  gap: 4px;\n}\n\n.sidecar-bottleneck-question-row::before {\n  content: '';\n  display: inline-block;\n  width: 4px;\n  height: 4px;\n  min-width: 4px;\n  background: #3b82f6;\n  border-radius: 50%;\n  margin-top: 4px;\n  flex-shrink: 0;\n}\n\n.sidecar-bottleneck-checkbox {\n  width: 14px;\n  height: 14px;\n  cursor: pointer;\n  margin-top: 1px;\n}\n\n.sidecar-bottleneck-question {\n  flex: 1;\n  font-size: 10px;\n  font-weight: 500;\n  color: #0b1220;\n  line-height: 1.25;\n}\n\n.sidecar-source-badge {\n  font-size: 10px;\n  opacity: 0.7;\n}\n\n.sidecar-conflict-badge {\n  font-size: 12px;\n}\n\n.sidecar-bottleneck-answers {\n  display: flex;\n  gap: 10px;\n  flex-wrap: wrap;\n  margin-top: 4px;\n  padding: 4px 0;\n  align-items: center;\n  border-top: 1px solid rgba(11, 18, 32, 0.04);\n}\n\n#mobius-os-sidebar .sidecar-bottleneck-answers button.sidecar-answer-btn,\n.sidecar-answer-btn {\n  /* Reset all button defaults with high specificity */\n  all: unset !important;\n  box-sizing: border-box !important;\n  /* Apply our styles - pill buttons with grey background */\n  display: inline-block !important;\n  padding: 3px 8px !important;\n  margin: 0 !important;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n  font-size: 9px !important;\n  font-weight: 400 !important;\n  background: rgba(11, 18, 32, 0.06) !important;\n  background-color: rgba(11, 18, 32, 0.06) !important;\n  border: 1px solid rgba(11, 18, 32, 0.08) !important;\n  border-radius: 4px !important;\n  color: rgba(91, 102, 122, 0.85) !important;\n  cursor: pointer !important;\n  transition: all 0.15s ease !important;\n  text-decoration: none !important;\n  line-height: 1.3 !important;\n  white-space: nowrap !important;\n  box-shadow: none !important;\n  outline: none !important;\n}\n\n#mobius-os-sidebar .sidecar-bottleneck-answers button.sidecar-answer-btn:hover,\n.sidecar-answer-btn:hover {\n  background: rgba(11, 18, 32, 0.1) !important;\n  background-color: rgba(11, 18, 32, 0.1) !important;\n  border-color: rgba(11, 18, 32, 0.15) !important;\n  color: #0b1220 !important;\n}\n\n#mobius-os-sidebar .sidecar-bottleneck-answers button.sidecar-answer-btn.sidecar-answer-btn--selected,\n#mobius-os-sidebar button.sidecar-answer-btn.sidecar-answer-btn--selected,\n.sidecar-bottleneck-answers .sidecar-answer-btn.sidecar-answer-btn--selected,\n.sidecar-answer-btn.sidecar-answer-btn--selected,\n.sidecar-answer-btn--selected {\n  background: rgba(37, 99, 235, 0.15) !important;\n  background-color: rgba(37, 99, 235, 0.15) !important;\n  border: 1px solid rgba(37, 99, 235, 0.35) !important;\n  border-color: rgba(37, 99, 235, 0.35) !important;\n  color: #2563eb !important;\n  font-weight: 500 !important;\n}\n\n/* Assignment Dropdown - compact, near question */\n.sidecar-assign-dropdown {\n  position: relative;\n  flex-shrink: 0;\n  margin-left: auto;\n}\n\n.sidecar-assign-btn {\n  display: flex;\n  align-items: center;\n  gap: 3px;\n  padding: 3px 6px;\n  font-size: 9px;\n  font-weight: 400;\n  color: rgba(37, 99, 235, 0.9);\n  background: rgba(37, 99, 235, 0.06);\n  border: 1px solid rgba(37, 99, 235, 0.15);\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.sidecar-assign-btn:hover {\n  background: rgba(37, 99, 235, 0.12);\n  border-color: rgba(37, 99, 235, 0.25);\n}\n\n.sidecar-assign-btn--assigned {\n  background: rgba(34, 197, 94, 0.08);\n  border-color: rgba(34, 197, 94, 0.25);\n  color: rgba(34, 197, 94, 0.9);\n}\n\n.sidecar-assign-label {\n  font-size: 9px;\n}\n\n.sidecar-assign-arrow {\n  font-size: 8px;\n  opacity: 0.6;\n}\n\n.sidecar-assign-menu {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  margin-top: 4px;\n  min-width: 140px;\n  background: #ffffff;\n  border: 1px solid rgba(11, 18, 32, 0.10);\n  border-radius: 8px;\n  box-shadow: 0 4px 16px rgba(2, 6, 23, 0.10);\n  z-index: 100;\n  overflow: hidden;\n  padding: 4px 0;\n}\n\n.sidecar-assign-option {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  gap: 1px;\n  width: 100%;\n  padding: 6px 10px;\n  font-size: 9px;\n  font-weight: 400;\n  color: #0b1220;\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  text-align: left;\n}\n\n.sidecar-assign-option:hover {\n  background: rgba(37, 99, 235, 0.06);\n}\n\n.sidecar-assign-option-text {\n  font-size: 10px;\n  font-weight: 400;\n  color: #0b1220;\n}\n\n.sidecar-assign-option-hint {\n  font-size: 8px;\n  font-weight: 400;\n  color: rgba(91, 102, 122, 0.6);\n}\n\n.sidecar-assign-divider {\n  height: 1px;\n  background: rgba(11, 18, 32, 0.08);\n  margin: 4px 0;\n}\n\n/* Legacy delegate row - hidden but kept for compatibility */\n.sidecar-bottleneck-delegate {\n  display: none;\n}\n\n.sidecar-bottleneck-separator {\n  font-size: 9px;\n  color: rgba(91, 102, 122, 0.7);\n  text-align: center;\n}\n\n.sidecar-mode-btn {\n  padding: 3px 8px;\n  font-size: 9px;\n  font-weight: 500;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  color: #0b1220;\n}\n\n.sidecar-mode-btn--mobius {\n  background: rgba(11, 18, 32, 0.03);\n}\n\n.sidecar-mode-btn--mobius:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-mode-btn--user {\n  background: rgba(11, 18, 32, 0.03);\n}\n\n.sidecar-mode-btn--user:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-mode-btn--selected {\n  background: rgba(37, 99, 235, 0.1);\n  border-color: rgba(37, 99, 235, 0.35);\n  color: #2563eb;\n}\n\n/* Mobius tip - encourages user adoption */\n.sidecar-bottleneck-mobius-tip {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  margin-top: 4px;\n  padding: 3px 6px;\n  font-size: 8px;\n  font-weight: 400;\n  color: rgba(37, 99, 235, 0.75);\n  background: rgba(37, 99, 235, 0.04);\n  border-radius: 4px;\n}\n\n.sidecar-bottleneck-mobius-tip:hover {\n  background: rgba(37, 99, 235, 0.08);\n  color: #2563eb;\n}\n\n.sidecar-mobius-tip-icon {\n  font-size: 9px;\n}\n\n.sidecar-bottleneck-mobius-tip--assigned {\n  color: rgba(34, 197, 94, 0.85);\n  background: rgba(34, 197, 94, 0.06);\n  cursor: default;\n}\n\n.sidecar-bottleneck-mobius-tip--assigned:hover {\n  background: rgba(34, 197, 94, 0.06);\n  color: rgba(34, 197, 94, 0.85);\n}\n\n/* Inline note row - matches Mini note styling */\n.sidecar-bottleneck-note-row {\n  margin-top: 4px;\n  padding-top: 4px;\n  border-top: 1px solid rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-bottleneck-note-wrap {\n  width: 100%;\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.sidecar-bottleneck-note-input {\n  width: 100%;\n  height: 22px;\n  border-radius: 6px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: #fff;\n  padding: 0 26px 0 6px;\n  font-size: 9px;\n  font-weight: 400;\n  color: #0b1220;\n  outline: none;\n}\n\n.sidecar-bottleneck-note-input::placeholder {\n  color: rgba(91, 102, 122, 0.75);\n  font-weight: 500;\n}\n\n.sidecar-bottleneck-note-input:focus {\n  border-color: rgba(37, 99, 235, 0.55);\n}\n\n.sidecar-bottleneck-note-send {\n  position: absolute;\n  right: 0;\n  width: 22px;\n  height: 22px;\n  border-radius: 6px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n}\n\n.sidecar-bottleneck-note-send:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-bottleneck-note-send svg {\n  width: 14px;\n  height: 14px;\n  display: block;\n  fill: rgba(11, 18, 32, 0.85);\n}\n\n/* Inline button (Edit, small actions) */\n.sidecar-inline-btn {\n  height: 22px;\n  padding: 0 8px;\n  border-radius: 8px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  font-size: 9px;\n  font-weight: 600;\n  color: #0b1220;\n}\n\n.sidecar-inline-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n/* Icon-only button (pencil edit, etc) - matches Mini */\n.sidecar-icon-btn {\n  width: 22px;\n  height: 22px;\n  border-radius: 8px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n  padding: 0;\n}\n\n.sidecar-icon-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-icon-btn svg {\n  width: 12px;\n  height: 12px;\n  fill: rgba(11, 18, 32, 0.80);\n}\n\n.sidecar-bottleneck-bulk {\n  padding-top: 12px;\n  border-top: 1px solid #e5e7eb;\n}\n\n.sidecar-bottleneck-bulk-btn {\n  width: 100%;\n  padding: 8px 12px;\n  font-size: 10px;\n  font-weight: 600;\n  background: rgba(11, 18, 32, 0.03);\n  color: #0b1220;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  border-radius: 10px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.sidecar-bottleneck-bulk-btn:hover:not(:disabled) {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-bottleneck-bulk-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.sidecar-bottleneck-clear {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 10px 12px;\n  background: rgba(34, 197, 94, 0.08);\n  border: 1px solid rgba(34, 197, 94, 0.15);\n  border-radius: 10px;\n}\n\n.sidecar-bottleneck-clear-icon {\n  width: 24px;\n  height: 24px;\n  background: #22c55e;\n  color: white;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 12px;\n  font-weight: bold;\n}\n\n.sidecar-bottleneck-clear-text {\n  font-size: 11px;\n  color: #166534;\n  font-weight: 500;\n}\n\n/* Context Expander */\n/* Context Expander - matches Mini row styling */\n.sidecar-context-expander {\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\n  margin-top: 8px;\n}\n\n.sidecar-context-expander-toggle {\n  width: 100%;\n  padding: 6px 0;\n  background: none;\n  border: none;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  cursor: pointer;\n  font-size: 10px;\n  font-weight: 400;\n  color: rgba(91, 102, 122, 0.95);\n  transition: background 0.15s ease;\n}\n\n.sidecar-context-expander-toggle:hover {\n  background: rgba(11, 18, 32, 0.02);\n}\n\n.sidecar-context-expander-arrow {\n  font-size: 8px;\n  color: rgba(91, 102, 122, 0.4);\n  transition: transform 0.15s ease;\n}\n\n.sidecar-context-expander-toggle[aria-expanded=\"true\"] .sidecar-context-expander-arrow {\n  transform: none;\n}\n\n.sidecar-context-expander-label {\n  font-weight: 400;\n  color: rgba(91, 102, 122, 0.7);\n}\n\n.sidecar-context-expander-content {\n  padding: 0 0 8px;\n}\n\n.sidecar-section-title {\n  font-size: 7px;\n  font-weight: 500;\n  color: rgba(91, 102, 122, 0.6);\n  text-transform: uppercase;\n  letter-spacing: 0.04em;\n  margin-bottom: 4px;\n}\n\n/* Resolution Plan Section */\n.sidecar-plan-section {\n  margin-bottom: 10px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-plan-summary {\n  margin-bottom: 6px;\n}\n\n.sidecar-plan-factors {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.sidecar-plan-factor {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 9px;\n}\n\n.sidecar-plan-factor-label {\n  flex: 1;\n  color: rgba(91, 102, 122, 0.85);\n  font-weight: 400;\n}\n\n.sidecar-plan-factor-progress {\n  font-size: 8px;\n  color: rgba(91, 102, 122, 0.6);\n  font-weight: 400;\n}\n\n.sidecar-plan-factor-bar {\n  width: 40px;\n  height: 3px;\n  background: rgba(11, 18, 32, 0.08);\n  border-radius: 2px;\n  overflow: hidden;\n}\n\n.sidecar-plan-factor-fill {\n  height: 100%;\n  background: rgba(11, 18, 32, 0.35);\n  border-radius: 2px;\n  transition: width 0.3s ease;\n}\n\n.sidecar-plan-current {\n  display: flex;\n  align-items: flex-start;\n  gap: 4px;\n  padding: 4px 6px;\n  background: rgba(11, 18, 32, 0.03);\n  border-radius: 6px;\n  margin-top: 6px;\n}\n\n.sidecar-plan-current-label {\n  font-size: 8px;\n  font-weight: 400;\n  color: rgba(91, 102, 122, 0.6);\n  flex-shrink: 0;\n}\n\n.sidecar-plan-current-text {\n  font-size: 9px;\n  font-weight: 400;\n  color: rgba(91, 102, 122, 0.85);\n  line-height: 1.3;\n}\n\n.sidecar-plan-actions {\n  font-size: 8px;\n  font-weight: 400;\n  color: rgba(37, 99, 235, 0.8);\n  margin-top: 4px;\n}\n\n/* Milestones - matches Mini compact styling */\n.sidecar-milestones-list {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.sidecar-milestone {\n  background: rgba(11, 18, 32, 0.02);\n  border: 1px solid rgba(11, 18, 32, 0.06);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.sidecar-milestone-header {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 10px;\n}\n\n.sidecar-milestone-icon {\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 12px;\n}\n\n.sidecar-milestone--complete .sidecar-milestone-icon {\n  color: #22c55e;\n}\n\n.sidecar-milestone--in_progress .sidecar-milestone-icon {\n  color: #f59e0b;\n}\n\n.sidecar-milestone--blocked .sidecar-milestone-icon {\n  color: #ef4444;\n}\n\n.sidecar-milestone--pending .sidecar-milestone-icon {\n  color: #9ca3af;\n}\n\n.sidecar-milestone-label {\n  flex: 1;\n  font-size: 13px;\n  color: #374151;\n}\n\n.sidecar-milestone-arrow {\n  font-size: 10px;\n  color: rgba(91, 102, 122, 0.7);\n}\n\n.sidecar-milestone-details {\n  padding: 8px 12px 12px 40px;\n  border-top: 1px solid #e5e7eb;\n}\n\n/* Substeps */\n.sidecar-substeps {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  margin-bottom: 8px;\n}\n\n.sidecar-substep {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 12px;\n  color: #6b7280;\n}\n\n.sidecar-substep-icon {\n  font-size: 8px;\n}\n\n.sidecar-substep--complete .sidecar-substep-icon {\n  color: #22c55e;\n}\n\n.sidecar-substep--current .sidecar-substep-icon {\n  color: #2563eb;\n}\n\n/* Timeline */\n.sidecar-timeline {\n  border-left: 2px solid #e5e7eb;\n  padding-left: 12px;\n}\n\n.sidecar-timeline-title {\n  font-size: 11px;\n  font-weight: 600;\n  color: #9ca3af;\n  margin-bottom: 8px;\n}\n\n.sidecar-timeline-entry {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 6px;\n  font-size: 12px;\n  margin-bottom: 6px;\n  position: relative;\n}\n\n.sidecar-timeline-entry::before {\n  content: '';\n  position: absolute;\n  left: -16px;\n  width: 8px;\n  height: 8px;\n  background: #e5e7eb;\n  border-radius: 50%;\n}\n\n.sidecar-timeline-actor {\n  font-weight: 500;\n  color: #374151;\n}\n\n.sidecar-timeline-actor--mobius {\n  color: #2563eb;\n}\n\n.sidecar-timeline-actor--user {\n  color: #059669;\n}\n\n.sidecar-timeline-action {\n  color: #6b7280;\n}\n\n.sidecar-timeline-time {\n  color: #9ca3af;\n  font-size: 11px;\n}\n\n.sidecar-timeline-artifact {\n  color: #2563eb;\n  text-decoration: none;\n  font-size: 11px;\n}\n\n.sidecar-timeline-artifact:hover {\n  text-decoration: underline;\n}\n\n/* Payer Info */\n.sidecar-payer-section {\n  margin-top: 16px;\n  padding-top: 16px;\n  border-top: 1px solid #e5e7eb;\n}\n\n.sidecar-payer-info {\n  background: #f9fafb;\n  border-radius: 6px;\n  padding: 12px;\n}\n\n.sidecar-payer-name {\n  font-size: 14px;\n  font-weight: 600;\n  color: #1f2937;\n  margin-bottom: 8px;\n}\n\n.sidecar-payer-phone,\n.sidecar-payer-portal,\n.sidecar-payer-response-time {\n  font-size: 12px;\n  color: #6b7280;\n  margin-bottom: 4px;\n}\n\n.sidecar-payer-phone a,\n.sidecar-payer-portal a {\n  color: #2563eb;\n  text-decoration: none;\n}\n\n.sidecar-payer-phone a:hover,\n.sidecar-payer-portal a:hover {\n  text-decoration: underline;\n}\n\n.sidecar-policy-excerpts {\n  margin-top: 12px;\n}\n\n.sidecar-excerpts-title {\n  font-size: 11px;\n  font-weight: 600;\n  color: #9ca3af;\n  margin-bottom: 8px;\n}\n\n.sidecar-policy-excerpt {\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  padding: 10px;\n  margin-bottom: 8px;\n}\n\n.sidecar-excerpt-topic {\n  font-size: 12px;\n  font-weight: 600;\n  color: #374151;\n  margin-bottom: 4px;\n}\n\n.sidecar-excerpt-content {\n  font-size: 12px;\n  color: #6b7280;\n  line-height: 1.4;\n}\n\n.sidecar-excerpt-source {\n  font-size: 10px;\n  color: #9ca3af;\n  margin-top: 4px;\n}\n\n/* Quick Chat */\n/* Quick Chat - matches Mini note input styling */\n.sidecar-quick-chat {\n  padding: 10px 10px;\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\n  background: #ffffff;\n}\n\n.sidecar-quick-chat-wrapper {\n  display: flex;\n  align-items: center;\n  position: relative;\n}\n\n.sidecar-quick-chat-input {\n  flex: 1;\n  height: 28px;\n  padding: 0 32px 0 8px;\n  font-size: 9px;\n  font-weight: 400;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  border-radius: 6px;\n  outline: none;\n  color: #0b1220;\n  background: #fff;\n}\n\n.sidecar-quick-chat-input::placeholder {\n  color: rgba(91, 102, 122, 0.5);\n  font-weight: 400;\n}\n\n.sidecar-quick-chat-input:focus {\n  border-color: rgba(37, 99, 235, 0.35);\n}\n\n.sidecar-quick-chat-input:disabled {\n  background: rgba(11, 18, 32, 0.02);\n}\n\n.sidecar-quick-chat-send {\n  position: absolute;\n  right: 0;\n  width: 28px;\n  height: 28px;\n  background: transparent;\n  border: none;\n  border-radius: 6px;\n  font-size: 12px;\n  cursor: pointer;\n  transition: background 0.15s ease;\n  display: grid;\n  place-items: center;\n}\n\n.sidecar-quick-chat-send:hover:not(:disabled) {\n  background: rgba(11, 18, 32, 0.04);\n}\n\n.sidecar-quick-chat-send:disabled {\n  cursor: not-allowed;\n}\n\n.sidecar-quick-chat-send svg {\n  width: 14px;\n  height: 14px;\n  display: block;\n  fill: rgba(91, 102, 122, 0.6);\n}\n\n.sidecar-quick-chat-send:hover:not(:disabled) svg {\n  fill: rgba(91, 102, 122, 0.9);\n}\n\n.sidecar-quick-chat-send:disabled svg {\n  fill: rgba(11, 18, 32, 0.2);\n}\n\n.sidecar-quick-chat-hint {\n  font-size: 9px;\n  font-weight: 400;\n  color: rgba(91, 102, 122, 0.5);\n  margin-top: 6px;\n}\n\n.sidecar-quick-chat-response {\n  background: #f0f9ff;\n  border: 1px solid #bae6fd;\n  border-radius: 8px;\n  padding: 12px;\n  margin-bottom: 8px;\n  position: relative;\n}\n\n.sidecar-quick-chat-response-text {\n  font-size: 13px;\n  color: #1e3a5f;\n  line-height: 1.4;\n}\n\n.sidecar-quick-chat-response-source {\n  font-size: 11px;\n  color: #6b7280;\n  margin-top: 6px;\n}\n\n.sidecar-quick-chat-response-dismiss {\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  background: none;\n  border: none;\n  color: #9ca3af;\n  cursor: pointer;\n  font-size: 16px;\n}\n\n/* Sidecar Menu */\n/* Sidecar Menu - matches Mini menu styling */\n.sidecar-menu {\n  position: relative;\n}\n\n.sidecar-menu-btn {\n  width: 22px;\n  height: 22px;\n  border-radius: 6px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n  padding: 0;\n}\n\n.sidecar-menu-btn svg {\n  width: 14px;\n  height: 14px;\n  fill: rgba(11, 18, 32, 0.7);\n}\n\n.sidecar-menu-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-menu-dropdown {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  margin-top: 4px;\n  min-width: 140px;\n  background: #fff;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  border-radius: 10px;\n  box-shadow: 0 8px 24px rgba(2, 6, 23, 0.12);\n  z-index: 2147483647;\n  overflow: visible;\n  pointer-events: auto;\n  padding: 4px 0;\n}\n\n.sidecar-menu-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  width: 100%;\n  text-align: left;\n  padding: 8px 12px;\n  border: none;\n  background: transparent;\n  font-size: 11px;\n  font-weight: 400;\n  color: #0b1220;\n  cursor: pointer;\n  pointer-events: auto;\n  transition: background 0.15s ease;\n  position: relative;\n}\n\n.sidecar-menu-item:hover {\n  background: rgba(11, 18, 32, 0.04);\n}\n\n.sidecar-menu-item.danger {\n  color: #b3261e;\n}\n\n.sidecar-menu-icon {\n  width: 14px;\n  height: 14px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n}\n\n.sidecar-menu-icon svg {\n  width: 14px;\n  height: 14px;\n  fill: rgba(11, 18, 32, 0.6);\n}\n\n.sidecar-menu-label {\n  flex: 1;\n  font-size: 11px;\n  font-weight: 400;\n}\n\n.sidecar-menu-arrow {\n  font-size: 10px;\n  color: rgba(91, 102, 122, 0.6);\n  margin-left: auto;\n}\n\n.sidecar-menu-divider {\n  height: 1px;\n  background: rgba(11, 18, 32, 0.08);\n  margin: 4px 0;\n}\n\n/* Theme submenu - positioned to the left since sidecar is on right edge */\n.sidecar-menu-submenu {\n  position: absolute;\n  right: 100%;\n  left: auto;\n  top: 0;\n  margin-right: 4px;\n  min-width: 100px;\n  background: #fff;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(2, 6, 23, 0.1);\n  padding: 4px 0;\n  z-index: 2147483648;\n}\n\n.sidecar-menu-submenu-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 10px;\n  font-size: 10px;\n  font-weight: 400;\n  color: #0b1220;\n  cursor: pointer;\n  transition: background 0.15s ease;\n}\n\n.sidecar-menu-submenu-item:hover {\n  background: rgba(11, 18, 32, 0.04);\n}\n\n.sidecar-menu-theme-icon {\n  font-size: 8px;\n  color: rgba(91, 102, 122, 0.7);\n}\n\n.sidecar-menu-theme-label {\n  font-size: 10px;\n  font-weight: 400;\n}\n\n/* Toggle switch - matches Mini style */\n.sidecar-menu-toggle {\n  position: relative;\n  width: 32px;\n  height: 18px;\n}\n\n.sidecar-menu-toggle-input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.sidecar-menu-toggle-slider {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(11, 18, 32, 0.15);\n  border-radius: 9px;\n  transition: background 0.2s ease;\n}\n\n.sidecar-menu-toggle-slider::before {\n  content: '';\n  position: absolute;\n  height: 14px;\n  width: 14px;\n  left: 2px;\n  bottom: 2px;\n  background: white;\n  border-radius: 50%;\n  transition: transform 0.2s ease;\n  box-shadow: 0 1px 3px rgba(2, 6, 23, 0.15);\n}\n\n.sidecar-menu-toggle-input:checked + .sidecar-menu-toggle-slider {\n  background: #2563eb;\n}\n\n.sidecar-menu-toggle-input:checked + .sidecar-menu-toggle-slider::before {\n  transform: translateX(14px);\n}\n\n/* Collapse button - matches Mini expand/minimize buttons */\n.sidecar-collapse-btn {\n  width: 22px;\n  height: 22px;\n  border-radius: 6px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n  padding: 0;\n}\n\n.sidecar-collapse-btn svg {\n  width: 14px;\n  height: 14px;\n  fill: rgba(11, 18, 32, 0.7);\n}\n\n.sidecar-collapse-btn:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n/* Alert Indicator */\n/* Alert Indicator - matches Mini button styling */\n.sidecar-alert-indicator {\n  position: relative;\n  width: 22px;\n  height: 22px;\n  border-radius: 6px;\n  border: 1px solid rgba(11, 18, 32, 0.12);\n  background: rgba(11, 18, 32, 0.03);\n  cursor: pointer;\n  display: grid;\n  place-items: center;\n}\n\n.sidecar-alert-indicator:hover {\n  background: rgba(11, 18, 32, 0.06);\n}\n\n.sidecar-alert-icon {\n  width: 14px;\n  height: 14px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.sidecar-alert-icon svg {\n  width: 14px;\n  height: 14px;\n  display: block;\n  fill: none;\n  stroke: rgba(11, 18, 32, 0.85);\n  stroke-width: 1.6;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n\n.sidecar-alert-badge {\n  position: absolute;\n  top: -4px;\n  right: -4px;\n  min-width: 14px;\n  height: 14px;\n  background: #2563eb;\n  color: white;\n  font-size: 9px;\n  font-weight: 600;\n  border-radius: 7px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0 3px;\n}\n\n.sidecar-alert-badge--high {\n  background: #dc2626;\n}\n\n.sidecar-notification-dot {\n  width: 6px;\n  height: 6px;\n  background: #2563eb;\n  border-radius: 50%;\n}\n\n.sidecar-notification-dot--high {\n  background: #dc2626;\n}\n\n/* Privacy indicator - matches Mini style */\n.sidecar-privacy-indicator {\n  font-size: 11px;\n  color: rgba(91, 102, 122, 0.95);\n}\n\n/* ========================================\n   SIDECAR THEMES\n   ======================================== */\n\n/* Dark Theme */\n#mobius-os-sidebar.theme-dark {\n  background: #1a1f2e;\n  color: #e5e7eb;\n  border-left-color: rgba(255, 255, 255, 0.08);\n}\n\n#mobius-os-sidebar.theme-dark .top-row {\n  background: rgba(255, 255, 255, 0.02);\n  border-bottom-color: rgba(255, 255, 255, 0.06);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-status-bar {\n  background: #1a1f2e;\n  border-bottom-color: rgba(255, 255, 255, 0.06);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-context {\n  color: rgba(229, 231, 235, 0.8);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-track {\n  background: linear-gradient(90deg, \n    rgba(255, 255, 255, 0.06) 0%, \n    rgba(255, 255, 255, 0.1) 50%,\n    rgba(255, 255, 255, 0.04) 100%\n  );\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-progress {\n  background: rgba(255, 255, 255, 0.3);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-marker {\n  background: #e5e7eb;\n  border-color: #1a1f2e;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-percent {\n  color: #e5e7eb;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-item {\n  background: rgba(255, 255, 255, 0.04);\n  border-color: rgba(255, 255, 255, 0.08);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-question {\n  color: #e5e7eb;\n}\n\n/* Dark theme answer buttons moved to complete dark theme section below */\n\n#mobius-os-sidebar.theme-dark .sidecar-menu-btn,\n#mobius-os-sidebar.theme-dark .sidecar-collapse-btn,\n#mobius-os-sidebar.theme-dark .sidecar-alert-indicator {\n  background: rgba(255, 255, 255, 0.06);\n  border-color: rgba(255, 255, 255, 0.12);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-menu-btn svg,\n#mobius-os-sidebar.theme-dark .sidecar-collapse-btn svg,\n#mobius-os-sidebar.theme-dark .sidecar-alert-icon svg {\n  fill: rgba(229, 231, 235, 0.8);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-menu-dropdown,\n#mobius-os-sidebar.theme-dark .sidecar-menu-submenu {\n  background: #252b3b;\n  border-color: rgba(255, 255, 255, 0.1);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-menu-item {\n  color: #e5e7eb;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-menu-item:hover {\n  background: rgba(255, 255, 255, 0.06);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-menu-icon svg {\n  fill: rgba(229, 231, 235, 0.6);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat {\n  background: rgba(255, 255, 255, 0.02);\n  border-top-color: rgba(255, 255, 255, 0.06);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat-input {\n  background: rgba(255, 255, 255, 0.06);\n  border-color: rgba(255, 255, 255, 0.12);\n  color: #e5e7eb;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat-input::placeholder {\n  color: rgba(229, 231, 235, 0.5);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat-send {\n  background: rgba(255, 255, 255, 0.06);\n  border-color: rgba(255, 255, 255, 0.12);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat-send svg {\n  fill: rgba(229, 231, 235, 0.7);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-section-title {\n  color: rgba(229, 231, 235, 0.7);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-toggle {\n  color: #e5e7eb;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-toggle:hover {\n  background: rgba(255, 255, 255, 0.04);\n}\n\n/* Glass Theme */\n#mobius-os-sidebar.theme-glass {\n  background: rgba(255, 255, 255, 0.75);\n  backdrop-filter: blur(20px);\n  -webkit-backdrop-filter: blur(20px);\n  border-left-color: rgba(255, 255, 255, 0.3);\n}\n\n#mobius-os-sidebar.theme-glass .top-row {\n  background: rgba(255, 255, 255, 0.4);\n}\n\n#mobius-os-sidebar.theme-glass .sidecar-status-bar {\n  background: rgba(255, 255, 255, 0.5);\n}\n\n#mobius-os-sidebar.theme-glass .sidecar-bottleneck-item {\n  background: rgba(255, 255, 255, 0.6);\n  border-color: rgba(255, 255, 255, 0.4);\n  box-shadow: 0 2px 8px rgba(2, 6, 23, 0.06);\n}\n\n#mobius-os-sidebar.theme-glass .sidecar-menu-btn,\n#mobius-os-sidebar.theme-glass .sidecar-collapse-btn,\n#mobius-os-sidebar.theme-glass .sidecar-alert-indicator {\n  background: rgba(255, 255, 255, 0.5);\n  border-color: rgba(255, 255, 255, 0.4);\n}\n\n#mobius-os-sidebar.theme-glass .sidecar-menu-dropdown,\n#mobius-os-sidebar.theme-glass .sidecar-menu-submenu {\n  background: rgba(255, 255, 255, 0.9);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n}\n\n#mobius-os-sidebar.theme-glass .sidecar-quick-chat {\n  background: rgba(255, 255, 255, 0.4);\n}\n\n#mobius-os-sidebar.theme-glass .sidecar-quick-chat-input {\n  background: rgba(255, 255, 255, 0.7);\n}\n\n/* ============================================\n   COMPLETE DARK THEME - All Sidecar Elements\n   ============================================ */\n\n/* Dark: Greeting */\n#mobius-os-sidebar.theme-dark .sidecar-greeting {\n  border-bottom-color: rgba(255, 255, 255, 0.08);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-greeting-text {\n  color: #f1f5f9;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-greeting-subtext {\n  color: rgba(148, 163, 184, 0.7);\n}\n\n/* Dark: Patient Row */\n#mobius-os-sidebar.theme-dark .sidecar-patient-row {\n  border-bottom-color: rgba(255, 255, 255, 0.08) !important;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-patient-row label {\n  color: rgba(148, 163, 184, 0.8);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-patient-row span {\n  color: #f1f5f9;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-icon-btn {\n  background: rgba(255, 255, 255, 0.06);\n  border-color: rgba(255, 255, 255, 0.12);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-icon-btn svg {\n  fill: rgba(229, 231, 235, 0.7);\n}\n\n/* Dark: Status Bar Title */\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-title {\n  color: rgba(148, 163, 184, 0.8);\n}\n\n/* Dark: Bottleneck Header */\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-header {\n  color: rgba(229, 231, 235, 0.8);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-count {\n  color: #f1f5f9;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-hint {\n  color: rgba(148, 163, 184, 0.6);\n}\n\n/* Dark: Answer Buttons */\n#mobius-os-sidebar.theme-dark .sidecar-answer-btn {\n  background: rgba(255, 255, 255, 0.08) !important;\n  background-color: rgba(255, 255, 255, 0.08) !important;\n  border-color: rgba(255, 255, 255, 0.12) !important;\n  color: rgba(229, 231, 235, 0.85) !important;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-answer-btn:hover {\n  background: rgba(255, 255, 255, 0.12) !important;\n  background-color: rgba(255, 255, 255, 0.12) !important;\n  border-color: rgba(255, 255, 255, 0.18) !important;\n  color: #f1f5f9 !important;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-answer-btn--selected,\n#mobius-os-sidebar.theme-dark .sidecar-answer-btn.sidecar-answer-btn--selected {\n  background: rgba(37, 99, 235, 0.25) !important;\n  background-color: rgba(37, 99, 235, 0.25) !important;\n  border-color: rgba(37, 99, 235, 0.4) !important;\n  color: #93c5fd !important;\n}\n\n/* Dark: Note Input */\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-note-row {\n  border-top-color: rgba(255, 255, 255, 0.06);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-note-input {\n  background: rgba(255, 255, 255, 0.06);\n  border-color: rgba(255, 255, 255, 0.12);\n  color: #f1f5f9;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-note-input::placeholder {\n  color: rgba(148, 163, 184, 0.5);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-note-send svg {\n  fill: rgba(229, 231, 235, 0.6);\n}\n\n/* Dark: Mobius Tip */\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-mobius-tip {\n  background: rgba(37, 99, 235, 0.15);\n  color: #93c5fd;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-mobius-tip--assigned {\n  background: rgba(34, 197, 94, 0.15);\n  color: #86efac;\n}\n\n/* Dark: Assign Button */\n#mobius-os-sidebar.theme-dark .sidecar-assign-btn {\n  background: rgba(37, 99, 235, 0.2);\n  border-color: rgba(37, 99, 235, 0.4);\n  color: #93c5fd;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-assign-btn:hover {\n  background: rgba(37, 99, 235, 0.3);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-assign-menu {\n  background: #252b3b;\n  border-color: rgba(255, 255, 255, 0.1);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-assign-option {\n  color: #e5e7eb;\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-assign-option:hover {\n  background: rgba(255, 255, 255, 0.06);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-assign-option-hint {\n  color: rgba(148, 163, 184, 0.6);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-assign-divider {\n  background: rgba(255, 255, 255, 0.08);\n}\n\n/* Dark: Context Expander */\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-arrow {\n  color: rgba(148, 163, 184, 0.6);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-label {\n  color: rgba(148, 163, 184, 0.7);\n}\n\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-content {\n  border-top-color: rgba(255, 255, 255, 0.06);\n}\n\n/* Dark: Cards Container */\n#mobius-os-sidebar.theme-dark .sidecar-cards-container {\n  background: transparent;\n}\n\n/* Dark: Brand Text */\n#mobius-os-sidebar.theme-dark .sidecar-brand-text {\n  color: #f1f5f9;\n}\n\n/* ============================================\n   BLUE THEME - All Sidecar Elements\n   ============================================ */\n\n#mobius-os-sidebar.theme-blue {\n  background: #eff6ff !important;\n  color: #1e3a5f !important;\n  border-color: rgba(37, 99, 235, 0.15) !important;\n}\n\n#mobius-os-sidebar.theme-blue .top-row {\n  background: rgba(37, 99, 235, 0.05);\n  border-bottom-color: rgba(37, 99, 235, 0.1);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-brand-text {\n  color: #1e40af;\n}\n\n/* Blue: Greeting */\n#mobius-os-sidebar.theme-blue .sidecar-greeting {\n  border-bottom-color: rgba(37, 99, 235, 0.1);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-greeting-text {\n  color: #1e3a5f;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-greeting-subtext {\n  color: #3b82f6;\n}\n\n/* Blue: Patient Row */\n#mobius-os-sidebar.theme-blue .sidecar-patient-row {\n  border-bottom-color: rgba(37, 99, 235, 0.1) !important;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-patient-row label {\n  color: #3b82f6;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-icon-btn {\n  background: rgba(37, 99, 235, 0.08);\n  border-color: rgba(37, 99, 235, 0.2);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-icon-btn svg {\n  fill: #3b82f6;\n}\n\n/* Blue: Status Bar */\n#mobius-os-sidebar.theme-blue .sidecar-status-bar {\n  background: rgba(37, 99, 235, 0.03);\n  border-bottom-color: rgba(37, 99, 235, 0.1);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-title {\n  color: #3b82f6;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-context {\n  color: #1e40af;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-track {\n  background: linear-gradient(90deg, \n    rgba(37, 99, 235, 0.08) 0%, \n    rgba(37, 99, 235, 0.15) 50%, \n    rgba(37, 99, 235, 0.2) 100%);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-progress {\n  background: rgba(37, 99, 235, 0.5);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-marker {\n  background: #2563eb;\n  border-color: #eff6ff;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-percent {\n  color: #1e40af;\n}\n\n/* Blue: Bottleneck Card */\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-item {\n  background: rgba(255, 255, 255, 0.7);\n  border-color: rgba(37, 99, 235, 0.15);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-question {\n  color: #1e3a5f;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-count {\n  color: #1e40af;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-hint {\n  color: #3b82f6;\n}\n\n/* Blue: Answer Buttons */\n#mobius-os-sidebar.theme-blue .sidecar-answer-btn {\n  background: rgba(37, 99, 235, 0.08) !important;\n  background-color: rgba(37, 99, 235, 0.08) !important;\n  border-color: rgba(37, 99, 235, 0.15) !important;\n  color: #3b82f6 !important;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-answer-btn:hover {\n  background: rgba(37, 99, 235, 0.12) !important;\n  background-color: rgba(37, 99, 235, 0.12) !important;\n  border-color: rgba(37, 99, 235, 0.25) !important;\n  color: #1e40af !important;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-answer-btn--selected,\n#mobius-os-sidebar.theme-blue .sidecar-answer-btn.sidecar-answer-btn--selected {\n  background: rgba(37, 99, 235, 0.2) !important;\n  background-color: rgba(37, 99, 235, 0.2) !important;\n  border-color: rgba(37, 99, 235, 0.4) !important;\n  color: #1d4ed8 !important;\n}\n\n/* Blue: Note Input */\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-note-row {\n  border-top-color: rgba(37, 99, 235, 0.1);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-note-input {\n  background: #ffffff;\n  border-color: #bfdbfe;\n}\n\n/* Blue: Mobius Tip */\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-mobius-tip {\n  background: rgba(37, 99, 235, 0.1);\n  color: #1e40af;\n}\n\n/* Blue: Assign Button */\n#mobius-os-sidebar.theme-blue .sidecar-assign-btn {\n  background: #2563eb;\n  border-color: #1d4ed8;\n  color: #ffffff;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-assign-btn:hover {\n  background: #1d4ed8;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-assign-menu {\n  background: #ffffff;\n  border-color: rgba(37, 99, 235, 0.2);\n}\n\n/* Blue: Context Expander */\n#mobius-os-sidebar.theme-blue .sidecar-context-expander-toggle:hover {\n  background: rgba(37, 99, 235, 0.06);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-context-expander-arrow {\n  color: #3b82f6;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-context-expander-label {\n  color: #3b82f6;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-context-expander-content {\n  border-top-color: rgba(37, 99, 235, 0.1);\n}\n\n/* Blue: Menu */\n#mobius-os-sidebar.theme-blue .sidecar-menu-btn,\n#mobius-os-sidebar.theme-blue .sidecar-collapse-btn,\n#mobius-os-sidebar.theme-blue .sidecar-alert-indicator {\n  background: rgba(37, 99, 235, 0.08);\n  border-color: rgba(37, 99, 235, 0.2);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-menu-btn svg,\n#mobius-os-sidebar.theme-blue .sidecar-collapse-btn svg,\n#mobius-os-sidebar.theme-blue .sidecar-alert-icon svg {\n  fill: #3b82f6;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-menu-dropdown,\n#mobius-os-sidebar.theme-blue .sidecar-menu-submenu {\n  background: #ffffff;\n  border-color: rgba(37, 99, 235, 0.15);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-menu-item {\n  color: #1e3a5f;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-menu-item:hover {\n  background: rgba(37, 99, 235, 0.08);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-menu-icon svg {\n  fill: #3b82f6;\n}\n\n/* Blue: Quick Chat */\n#mobius-os-sidebar.theme-blue .sidecar-quick-chat {\n  background: rgba(255, 255, 255, 0.7);\n  border-top-color: rgba(37, 99, 235, 0.1);\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-quick-chat-input {\n  background: #ffffff;\n  border-color: #bfdbfe;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-quick-chat-input:focus {\n  border-color: #3b82f6;\n}\n\n#mobius-os-sidebar.theme-blue .sidecar-quick-chat-send svg {\n  fill: #3b82f6;\n}\n\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/styles/sidebar.css\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[\"/**\\n * Sidebar-only styles for Mobius OS (content script injection)\\n * IMPORTANT: Must not style host page elements like html/body.\\n * Everything is scoped under #mobius-os-sidebar to avoid collisions.\\n */\\n\\n#mobius-os-sidebar,\\n#mobius-os-sidebar * {\\n  box-sizing: border-box;\\n}\\n\\n#mobius-os-sidebar {\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Google Sans', sans-serif;\\n  background: #ffffff;\\n  color: #0b1220;\\n  font-size: 12px;\\n  font-weight: 500;\\n}\\n\\n/* Subtle, modern look - matching Mini */\\n#mobius-os-sidebar {\\n  border-left: 1px solid rgba(11, 18, 32, 0.12);\\n  box-shadow: -4px 0 24px rgba(2, 6, 23, 0.08);\\n}\\n\\n#mobius-os-sidebar button,\\n#mobius-os-sidebar input,\\n#mobius-os-sidebar select {\\n  font: inherit;\\n}\\n\\n#mobius-os-sidebar button {\\n  cursor: pointer;\\n}\\n\\n#mobius-os-sidebar .top-row,\\n#mobius-os-sidebar .second-row,\\n#mobius-os-sidebar .tasks-panel,\\n#mobius-os-sidebar .chat-input-area,\\n#mobius-os-sidebar .record-id-input,\\n#mobius-os-sidebar .workflow-buttons,\\n#mobius-os-sidebar .footer {\\n  padding-left: 14px;\\n  padding-right: 14px;\\n}\\n\\n/* Top Row / Header */\\n#mobius-os-sidebar .top-row {\\n  display: flex;\\n  align-items: center;\\n  justify-content: flex-start;\\n  gap: 8px;\\n  padding-top: 8px;\\n  padding-bottom: 10px;\\n  border-bottom: 1px solid rgba(60, 64, 67, 0.12);\\n  background: white;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-sidebar .header-actions {\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  margin-left: auto;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-sidebar .header-left {\\n  display: flex;\\n  align-items: center;\\n  gap: 12px;\\n  flex: 0 1 auto;\\n  min-width: 0;\\n}\\n\\n#mobius-os-sidebar .client-logo {\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  font-size: 11px;\\n  color: #5f6368;\\n  min-width: 100px;\\n}\\n\\n#mobius-os-sidebar .client-logo img {\\n  width: 24px;\\n  height: 24px;\\n  border-radius: 4px;\\n}\\n\\n#mobius-os-sidebar .client-logo-svg {\\n  width: 24px;\\n  height: 24px;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-sidebar .client-logo-svg svg {\\n  width: 100%;\\n  height: 100%;\\n  display: block;\\n}\\n\\n#mobius-os-sidebar .client-logo-placeholder {\\n  width: 24px;\\n  height: 24px;\\n  background: #e8eaed;\\n  border-radius: 4px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-size: 10px;\\n  color: #5f6368;\\n}\\n\\n#mobius-os-sidebar .client-name {\\n  font-weight: 500;\\n  color: #202124;\\n}\\n\\n#mobius-os-sidebar .logo-section {\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  flex-wrap: nowrap;\\n  min-width: 0;\\n}\\n\\n#mobius-os-sidebar .mobius-logo {\\n  width: 32px;\\n  height: 32px;\\n  position: relative;\\n}\\n\\n#mobius-os-sidebar .mobius-logo svg {\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n#mobius-os-sidebar .mobius-logo .path-normal {\\n  display: none;\\n}\\n\\n#mobius-os-sidebar .mobius-logo .path-processing {\\n  display: block;\\n}\\n\\n#mobius-os-sidebar .mobius-logo:not(.status-processing) .path-normal {\\n  display: block;\\n}\\n\\n#mobius-os-sidebar .mobius-logo:not(.status-processing) .path-processing {\\n  display: none;\\n}\\n\\n#mobius-os-sidebar .logo-label {\\n  font-weight: 500;\\n  font-size: 12px;\\n  color: #202124;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  max-width: 120px;\\n}\\n\\n#mobius-os-sidebar .context-display {\\n  flex: 1 1 auto;\\n  margin: 0;\\n  font-size: 11px;\\n  color: #5f6368;\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  justify-content: center;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  min-width: 0;\\n}\\n\\n#mobius-os-sidebar .status-indicator {\\n  width: 8px;\\n  height: 8px;\\n  border-radius: 50%;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-sidebar .status-proceed,\\n#mobius-os-sidebar .status-green {\\n  background: #16a34a;\\n  box-shadow: 0 0 4px rgba(22, 163, 74, 0.6);\\n}\\n\\n#mobius-os-sidebar .status-pending,\\n#mobius-os-sidebar .status-yellow {\\n  background: #f59e0b;\\n  box-shadow: 0 0 4px rgba(245, 158, 11, 0.6);\\n}\\n\\n#mobius-os-sidebar .status-error,\\n#mobius-os-sidebar .status-red {\\n  background: #dc2626;\\n  box-shadow: 0 0 4px rgba(220, 38, 38, 0.6);\\n}\\n\\n#mobius-os-sidebar .status-blue {\\n  background: #2563eb;\\n  box-shadow: 0 0 4px rgba(37, 99, 235, 0.6);\\n}\\n\\n#mobius-os-sidebar .status-grey {\\n  background: #94a3b8;\\n  box-shadow: 0 0 4px rgba(148, 163, 184, 0.6);\\n}\\n\\n#mobius-os-sidebar .mode-badge {\\n  display: inline-block;\\n  padding: 3px 8px;\\n  background: rgba(26, 115, 232, 0.10);\\n  color: #1a73e8;\\n  border-radius: 12px;\\n  font-size: 10px;\\n  font-weight: 600;\\n  margin-left: 8px;\\n  text-transform: uppercase;\\n}\\n\\n#mobius-os-sidebar .alert-btn,\\n#mobius-os-sidebar .settings-btn {\\n  width: 32px;\\n  height: 32px;\\n  border: 1px solid rgba(60, 64, 67, 0.18);\\n  background: white;\\n  border-radius: 6px;\\n  cursor: pointer;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n#mobius-os-sidebar .alert-btn {\\n  font-size: 16px;\\n  position: relative;\\n  margin-right: 8px;\\n}\\n\\n#mobius-os-sidebar .settings-btn {\\n  font-size: 18px;\\n}\\n\\n#mobius-os-sidebar .alert-btn:hover,\\n#mobius-os-sidebar .settings-btn:hover {\\n  background: #f5f5f5;\\n}\\n\\n/* Collapse button (added to header actions) */\\n#mobius-os-sidebar .collapse-btn {\\n  width: 32px;\\n  height: 32px;\\n  border: 1px solid rgba(60, 64, 67, 0.18);\\n  background: white;\\n  border-radius: 6px;\\n  cursor: pointer;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-size: 16px;\\n  line-height: 1;\\n}\\n\\n#mobius-os-sidebar .collapse-btn:hover {\\n  background: #f5f5f5;\\n}\\n\\n/* Second Row */\\n#mobius-os-sidebar .second-row {\\n  padding-top: 10px;\\n  padding-bottom: 10px;\\n  border-bottom: 1px solid rgba(60, 64, 67, 0.12);\\n  background: white;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-sidebar .context-summary {\\n  font-size: 12px;\\n  color: #202124;\\n  margin-bottom: 6px;\\n  line-height: 1.4;\\n}\\n\\n#mobius-os-sidebar .quick-action-btn {\\n  display: inline-block;\\n  padding: 7px 12px;\\n  background: #1a73e8;\\n  color: white;\\n  border-radius: 10px;\\n  font-size: 12px;\\n  cursor: pointer;\\n  border: none;\\n}\\n\\n#mobius-os-sidebar .quick-action-btn:hover {\\n  background: #1565c0;\\n}\\n\\n/* Tasks Panel */\\n#mobius-os-sidebar .tasks-panel {\\n  padding-top: 8px;\\n  padding-bottom: 8px;\\n  border-bottom: 1px solid rgba(60, 64, 67, 0.12);\\n  background: #fff;\\n  max-height: 150px;\\n  overflow-y: auto;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-sidebar .tasks-panel-header {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  cursor: pointer;\\n  font-size: 11px;\\n  font-weight: 600;\\n  color: #5f6368;\\n  margin-bottom: 6px;\\n}\\n\\n#mobius-os-sidebar .tasks-panel-content {\\n  display: none;\\n}\\n\\n#mobius-os-sidebar .tasks-panel-content.show {\\n  display: block;\\n}\\n\\n#mobius-os-sidebar .task-item {\\n  display: flex;\\n  align-items: flex-start;\\n  gap: 8px;\\n  padding: 4px 0;\\n  font-size: 12px;\\n  color: #202124;\\n}\\n\\n#mobius-os-sidebar .task-item.shared {\\n  color: #1a73e8;\\n}\\n\\n#mobius-os-sidebar .task-item.backend {\\n  color: #5f6368;\\n  font-style: italic;\\n}\\n\\n/* Chat Area */\\n#mobius-os-sidebar .chat-area {\\n  flex: 1;\\n  overflow-y: auto;\\n  padding: 10px 12px;\\n  background: #ffffff;\\n  display: flex;\\n  flex-direction: column;\\n  gap: 10px;\\n  justify-content: flex-end;\\n  min-height: 0;\\n  flex-shrink: 1;\\n}\\n\\n#mobius-os-sidebar .message {\\n  max-width: 75%;\\n  padding: 7px 10px;\\n  border-radius: 10px;\\n  font-size: 11px;\\n  line-height: 1.45;\\n  color: #0b1220;\\n}\\n\\n#mobius-os-sidebar .system-message {\\n  /* Stretch to full width to avoid shrink-to-fit issues with inline-block bubble max-width. */\\n  align-self: stretch;\\n  width: 100%;\\n  background: transparent;\\n  border: none;\\n  padding: 0;\\n  max-width: 100%;\\n  color: #0b1220;\\n}\\n\\n#mobius-os-sidebar .message-content {\\n  white-space: pre-wrap;\\n  word-break: break-word;\\n}\\n\\n/* Compact assistant \\\"bubble\\\" */\\n#mobius-os-sidebar .system-message .message-content {\\n  margin-top: 4px;\\n  display: inline-block;\\n  background: rgba(11, 18, 32, 0.03);\\n  border: 1px solid rgba(11, 18, 32, 0.10);\\n  padding: 7px 10px;\\n  border-radius: 10px;\\n  max-width: 92%;\\n}\\n\\n/* Make tools unobtrusive (Mini-style) */\\n#mobius-os-sidebar .system-message .message-header {\\n  margin-bottom: 2px;\\n}\\n\\n#mobius-os-sidebar .system-message .message-tools-btn {\\n  width: 22px;\\n  height: 22px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  border-radius: 6px;\\n  opacity: 0.0;\\n  transition: opacity 0.12s ease, background 0.15s ease;\\n}\\n\\n#mobius-os-sidebar .system-message:hover .message-tools-btn {\\n  opacity: 0.85;\\n}\\n\\n#mobius-os-sidebar .system-message .message-tools-btn:hover {\\n  opacity: 1;\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n#mobius-os-sidebar .user-message {\\n  align-self: flex-end;\\n  background: #2563eb;\\n  color: white;\\n}\\n\\n/* Thinking (minimal, collapsible line) */\\n#mobius-os-sidebar .thinking-line {\\n  margin: 0 0 6px 0;\\n  padding: 0;\\n  border: none;\\n  background: transparent;\\n  color: rgba(91, 102, 122, 0.7);\\n  font-size: 11px;\\n}\\n\\n#mobius-os-sidebar .thinking-line summary {\\n  list-style: none;\\n  cursor: pointer;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  padding: 0;\\n}\\n\\n#mobius-os-sidebar .thinking-line summary::-webkit-details-marker {\\n  display: none;\\n}\\n\\n#mobius-os-sidebar .thinking-line summary::after {\\n  content: '';\\n  margin-left: auto;\\n  opacity: 0.7;\\n}\\n\\n#mobius-os-sidebar .thinking-line[open] summary::after {\\n  content: '';\\n}\\n\\n#mobius-os-sidebar .thinking-body {\\n  margin-top: 4px;\\n  padding-left: 10px;\\n  border-left: 2px solid rgba(11, 18, 32, 0.12);\\n  white-space: pre-wrap;\\n  word-break: break-word;\\n}\\n\\n/* Chat Input */\\n#mobius-os-sidebar .chat-input-area {\\n  padding-top: 8px;\\n  padding-bottom: 8px;\\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\\n  background: white;\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  flex-shrink: 0;\\n  width: 100%;\\n}\\n\\n#mobius-os-sidebar .chat-input {\\n  flex: 1;\\n  width: 100%;\\n  min-width: 0;\\n  padding: 8px 12px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  border-radius: 10px;\\n  font-size: 11px;\\n  outline: none;\\n  background: #fff;\\n  resize: none;\\n  overflow: hidden;\\n  line-height: 1.4;\\n  -webkit-appearance: none;\\n  appearance: none;\\n  color: #0b1220;\\n}\\n\\n#mobius-os-sidebar .chat-input::placeholder {\\n  color: rgba(91, 102, 122, 0.7);\\n}\\n\\n#mobius-os-sidebar .chat-input:focus {\\n  border-color: #2563eb;\\n}\\n\\n/* Message-level tools (system messages) */\\n#mobius-os-sidebar .message-header {\\n  display: flex;\\n  justify-content: flex-end;\\n  margin-bottom: 6px;\\n}\\n\\n#mobius-os-sidebar .message-tools {\\n  position: relative;\\n}\\n\\n#mobius-os-sidebar .message-tools-btn {\\n  width: 22px;\\n  height: 22px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  border-radius: 6px;\\n  display: inline-flex;\\n  align-items: center;\\n  justify-content: center;\\n  padding: 0;\\n  line-height: 1;\\n}\\n\\n#mobius-os-sidebar .message-tools-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n#mobius-os-sidebar .message-tools-dropdown {\\n  position: absolute;\\n  top: 100%;\\n  right: 0;\\n  margin-top: 6px;\\n  background: #fff;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  border-radius: 12px;\\n  box-shadow: 0 14px 28px rgba(2, 6, 23, 0.18);\\n  display: none;\\n  flex-direction: column;\\n  min-width: 140px;\\n  z-index: 2;\\n}\\n\\n#mobius-os-sidebar .message-tools-dropdown.show {\\n  display: flex;\\n}\\n\\n#mobius-os-sidebar .message-tools-item {\\n  padding: 10px 12px;\\n  border: none;\\n  background: white;\\n  text-align: left;\\n  font-size: 12px;\\n  font-weight: 600;\\n  color: #0b1220;\\n}\\n\\n#mobius-os-sidebar .message-tools-item:hover {\\n  background: rgba(11, 18, 32, 0.04);\\n}\\n\\n/* Chat tools (make compact, not stacked) */\\n#mobius-os-sidebar .chat-tools {\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n}\\n\\n#mobius-os-sidebar .chat-tool-btn {\\n  width: 22px;\\n  height: 22px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  border-radius: 6px;\\n  display: inline-flex;\\n  align-items: center;\\n  justify-content: center;\\n  padding: 0;\\n}\\n\\n#mobius-os-sidebar .chat-tool-btn:hover {\\n  background: rgba(60, 64, 67, 0.06);\\n}\\n\\n#mobius-os-sidebar .tools-menu {\\n  position: relative;\\n}\\n\\n#mobius-os-sidebar .tools-dropdown {\\n  position: absolute;\\n  bottom: 100%;\\n  right: 0;\\n  margin-bottom: 6px;\\n  background: white;\\n  border: 1px solid rgba(60, 64, 67, 0.18);\\n  border-radius: 10px;\\n  box-shadow: 0 10px 24px rgba(0,0,0,0.10);\\n  display: none;\\n  flex-direction: column;\\n  min-width: 140px;\\n  z-index: 2;\\n}\\n\\n#mobius-os-sidebar .tools-dropdown.show {\\n  display: flex;\\n}\\n\\n#mobius-os-sidebar .tools-dropdown button {\\n  padding: 10px 12px;\\n  border: none;\\n  background: white;\\n  text-align: left;\\n  font-size: 12px;\\n}\\n\\n#mobius-os-sidebar .tools-dropdown button:hover {\\n  background: rgba(60, 64, 67, 0.06);\\n}\\n\\n/* Record ID Input */\\n#mobius-os-sidebar .record-id-input {\\n  padding-top: 8px;\\n  padding-bottom: 8px;\\n  border-top: 1px solid rgba(60, 64, 67, 0.12);\\n  background: white;\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-sidebar .record-id-input label {\\n  font-size: 11px;\\n  color: #5f6368;\\n  font-weight: 600;\\n  white-space: nowrap;\\n}\\n\\n#mobius-os-sidebar .record-id-input select {\\n  padding: 6px 8px;\\n  border: 1px solid rgba(60, 64, 67, 0.18);\\n  border-radius: 8px;\\n  font-size: 12px;\\n  background: #fff;\\n}\\n\\n#mobius-os-sidebar .record-id-input input {\\n  flex: 1;\\n  padding: 7px 10px;\\n  border: 1px solid rgba(60, 64, 67, 0.18);\\n  border-radius: 8px;\\n  font-size: 12px;\\n  outline: none;\\n}\\n\\n/* Workflow Buttons */\\n#mobius-os-sidebar .workflow-buttons {\\n  padding-top: 8px;\\n  padding-bottom: 8px;\\n  border-top: 1px solid rgba(60, 64, 67, 0.12);\\n  background: #fff;\\n  display: flex;\\n  gap: 8px;\\n  flex-wrap: wrap;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-sidebar .context-button {\\n  padding: 8px 10px;\\n  background: rgba(60, 64, 67, 0.06);\\n  border: 1px solid rgba(60, 64, 67, 0.10);\\n  border-radius: 10px;\\n  font-size: 12px;\\n}\\n\\n#mobius-os-sidebar .context-button:hover {\\n  background: rgba(60, 64, 67, 0.10);\\n}\\n\\n/* Footer */\\n#mobius-os-sidebar .footer {\\n  padding-top: 10px;\\n  padding-bottom: 10px;\\n  border-top: 1px solid rgba(60, 64, 67, 0.12);\\n  background: #fff;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-sidebar .user-details {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  gap: 10px;\\n  flex-wrap: nowrap;\\n}\\n\\n#mobius-os-sidebar .user-info {\\n  font-size: 12px;\\n  color: #5f6368;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  min-width: 0;\\n}\\n\\n#mobius-os-sidebar .preferences {\\n  display: flex;\\n  gap: 10px;\\n  font-size: 11px;\\n  align-items: center;\\n  white-space: nowrap;\\n}\\n\\n#mobius-os-sidebar .preferences-panel {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: flex-end;\\n  min-width: 0;\\n}\\n\\n#mobius-os-sidebar .preferences-expanded {\\n  display: none;\\n  margin-top: 6px;\\n}\\n\\n#mobius-os-sidebar .preferences-expanded.show {\\n  display: block;\\n}\\n\\n#mobius-os-sidebar .preference-group {\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  justify-content: flex-end;\\n  margin-bottom: 6px;\\n}\\n\\n#mobius-os-sidebar .preference-group label {\\n  font-size: 11px;\\n  color: #5f6368;\\n  white-space: nowrap;\\n}\\n\\n#mobius-os-sidebar .preference-group select {\\n  padding: 6px 8px;\\n  border: 1px solid rgba(60, 64, 67, 0.18);\\n  border-radius: 8px;\\n  font-size: 12px;\\n  background: #fff;\\n}\\n\\n#mobius-os-sidebar .preference-item {\\n  display: inline-flex;\\n  align-items: center;\\n  gap: 6px;\\n  padding: 3px 6px;\\n  border-radius: 8px;\\n}\\n\\n#mobius-os-sidebar .preference-item:hover {\\n  background: rgba(60, 64, 67, 0.06);\\n}\\n\\n#mobius-os-sidebar .pref-value {\\n  color: #1a73e8;\\n  font-weight: 600;\\n  font-size: 11px;\\n}\\n\\n/* Guidance / Follow-up actions (system message CTA buttons) */\\n#mobius-os-sidebar .guidance-actions {\\n  margin-top: 8px;\\n  padding: 6px 8px;\\n  display: flex;\\n  gap: 6px;\\n  flex-wrap: wrap;\\n  align-items: center;\\n  border-radius: 10px;\\n  border: 1px solid rgba(26, 115, 232, 0.18);\\n  background: rgba(26, 115, 232, 0.06);\\n}\\n\\n#mobius-os-sidebar .guidance-action-btn {\\n  appearance: none;\\n  border: 1px solid rgba(26, 115, 232, 0.28);\\n  background: rgba(26, 115, 232, 0.10);\\n  color: #174ea6;\\n  padding: 5px 10px;\\n  border-radius: 999px;\\n  font-size: 12px;\\n  line-height: 1.2;\\n}\\n\\n#mobius-os-sidebar .guidance-action-btn:hover {\\n  background: rgba(26, 115, 232, 0.16);\\n  border-color: rgba(26, 115, 232, 0.38);\\n}\\n\\n/**\\n * Mini widget styles (scoped; does not affect host page nor #mobius-os-sidebar).\\n */\\n#mobius-os-mini,\\n#mobius-os-mini * {\\n  box-sizing: border-box;\\n}\\n\\n#mobius-os-mini {\\n  position: fixed !important;\\n  z-index: 2147483646 !important;\\n  width: 300px;\\n  background: #ffffff !important;\\n  color: #0b1220 !important;\\n  border: 1px solid rgba(11, 18, 32, 0.12) !important;\\n  border-radius: 14px !important;\\n  box-shadow: 0 16px 34px rgba(2, 6, 23, 0.14) !important;\\n  overflow: hidden !important;\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Google Sans', sans-serif !important;\\n  font-size: 12px !important;\\n  font-weight: 500 !important;\\n  user-select: none !important;\\n}\\n\\n#mobius-os-mini button,\\n#mobius-os-mini input {\\n  font: inherit;\\n}\\n\\n#mobius-os-mini .mobius-mini-header {\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  padding: 5px 8px;\\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\\n  background: rgba(11, 18, 32, 0.02);\\n  cursor: grab;\\n  touch-action: none;\\n}\\n\\n#mobius-os-mini .mobius-mini-drag-handle {\\n  width: 20px;\\n  height: 20px;\\n  border-radius: 6px;\\n  border: 1px solid rgba(11, 18, 32, 0.10);\\n  background: rgba(11, 18, 32, 0.03);\\n  display: grid;\\n  place-items: center;\\n  cursor: grab;\\n  flex: 0 0 auto;\\n  touch-action: none;\\n}\\n\\n#mobius-os-mini .mobius-mini-drag-handle:active {\\n  cursor: grabbing;\\n}\\n\\n#mobius-os-mini .mobius-mini-drag-dots {\\n  width: 8px;\\n  height: 14px;\\n  background:\\n    radial-gradient(circle, rgba(11,18,32,0.35) 1.5px, transparent 2px) 0 0/5px 5px;\\n  border-radius: 4px;\\n}\\n\\n#mobius-os-mini .mobius-mini-brand {\\n  display: inline-flex;\\n  align-items: center;\\n  gap: 5px;\\n  min-width: 0;\\n  flex: 1 1 auto;\\n}\\n\\n#mobius-os-mini .mobius-mini-brand .mobius-logo {\\n  width: 18px;\\n  height: 18px;\\n}\\n\\n/* Client logo in Mini widget */\\n#mobius-os-mini .client-logo {\\n  display: flex;\\n  align-items: center;\\n  gap: 4px;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-mini .client-logo.client-logo-compact {\\n  gap: 0;\\n}\\n\\n#mobius-os-mini .client-logo img {\\n  width: 18px;\\n  height: 18px;\\n  border-radius: 3px;\\n}\\n\\n#mobius-os-mini .client-logo-svg {\\n  width: 18px;\\n  height: 18px;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-mini .client-logo-svg svg {\\n  width: 100%;\\n  height: 100%;\\n  display: block;\\n}\\n\\n#mobius-os-mini .client-logo-placeholder {\\n  width: 18px;\\n  height: 18px;\\n  background: #e8eaed;\\n  border-radius: 3px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-size: 8px;\\n  color: #5f6368;\\n  font-weight: 600;\\n}\\n\\n#mobius-os-mini .client-name {\\n  font-size: 9px;\\n  font-weight: 500;\\n  color: #5f6368;\\n  white-space: nowrap;\\n}\\n\\n/* Divider between client logo and Mobius brand */\\n#mobius-os-mini .mobius-mini-brand-divider {\\n  width: 1px;\\n  height: 14px;\\n  background: rgba(11, 18, 32, 0.12);\\n  margin: 0 2px;\\n}\\n\\n#mobius-os-mini .mobius-logo {\\n  width: 18px;\\n  height: 18px;\\n  position: relative;\\n}\\n\\n#mobius-os-mini .mobius-logo svg {\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n/* Match sidebar/popup behavior: show only one path depending on status */\\n#mobius-os-mini .mobius-logo .path-normal {\\n  display: none;\\n}\\n\\n#mobius-os-mini .mobius-logo .path-processing {\\n  display: block;\\n}\\n\\n#mobius-os-mini .mobius-logo:not(.status-processing) .path-normal {\\n  display: block;\\n}\\n\\n#mobius-os-mini .mobius-logo:not(.status-processing) .path-processing {\\n  display: none;\\n}\\n\\n#mobius-os-mini .mobius-mini-brand-text {\\n  font-size: 10px;\\n  font-weight: 600;\\n  color: #0b1220;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n\\n#mobius-os-mini .mobius-mini-menu-btn {\\n  width: 22px;\\n  height: 22px;\\n  border-radius: 6px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n  font-weight: 600;\\n  font-size: 10px;\\n}\\n\\n#mobius-os-mini .mobius-mini-expand-btn {\\n  width: 22px;\\n  height: 22px;\\n  border-radius: 6px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n  font-weight: 600;\\n  font-size: 12px;\\n  line-height: 1;\\n}\\n\\n#mobius-os-mini .mobius-mini-expand-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n#mobius-os-mini .mobius-mini-minimize-btn {\\n  width: 22px;\\n  height: 22px;\\n  border-radius: 6px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n  font-weight: 600;\\n  font-size: 14px;\\n  line-height: 1;\\n  color: #374151;\\n}\\n\\n#mobius-os-mini .mobius-mini-minimize-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n#mobius-os-mini .mobius-mini-menu-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n/* Minimized state - compact pill */\\n#mobius-os-mini.mobius-mini-minimized {\\n  width: auto !important;\\n  min-width: unset !important;\\n  max-width: unset !important;\\n  padding: 0 !important;\\n  border-radius: 20px !important;\\n}\\n\\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-header {\\n  padding: 6px 10px;\\n  gap: 8px;\\n}\\n\\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-brand {\\n  display: none;\\n}\\n\\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-expand-btn,\\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-menu-btn {\\n  display: none;\\n}\\n\\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-row,\\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-attention-row,\\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-task-badge-row,\\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-note-row {\\n  display: none !important;\\n}\\n\\n/* Minimized info - patient name + attention dot (hidden by default) */\\n#mobius-os-mini .mobius-mini-minimized-info {\\n  display: none;\\n  align-items: center;\\n  gap: 6px;\\n  max-width: 140px;\\n}\\n\\n#mobius-os-mini .mobius-mini-minimized-patient {\\n  font-size: 10px;\\n  font-weight: 500;\\n  color: #374151;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n\\n/* Show minimized info only when minimized */\\n#mobius-os-mini.mobius-mini-minimized .mobius-mini-minimized-info {\\n  display: flex;\\n}\\n\\n#mobius-os-mini .mobius-mini-menu {\\n  position: absolute;\\n  top: 42px;\\n  right: 10px;\\n  background: #fff;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  border-radius: 12px;\\n  box-shadow: 0 14px 28px rgba(2,6,23,0.18);\\n  overflow: visible;\\n  z-index: 2147483647;\\n  min-width: 140px;\\n  pointer-events: auto !important;\\n}\\n\\n#mobius-os-mini .mobius-mini-menu-item {\\n  display: block;\\n  width: 100%;\\n  text-align: left;\\n  padding: 10px 12px;\\n  border: none;\\n  background: #fff;\\n  font-size: 12px;\\n  font-weight: 600;\\n  cursor: pointer;\\n  pointer-events: auto !important;\\n}\\n\\n#mobius-os-mini .mobius-mini-menu-item:hover {\\n  background: rgba(11, 18, 32, 0.04);\\n}\\n\\n#mobius-os-mini .mobius-mini-menu-item.danger {\\n  color: #b3261e;\\n}\\n\\n/* Theme submenu */\\n#mobius-os-mini .mobius-mini-theme-trigger {\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  color: #0b1220;\\n}\\n\\n#mobius-os-mini .mobius-mini-theme-trigger:hover {\\n  background: rgba(11, 18, 32, 0.04);\\n}\\n\\n#mobius-os-mini .mobius-mini-theme-submenu {\\n  background: #f8fafc;\\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n#mobius-os-mini .mobius-mini-theme-submenu .mobius-mini-menu-item {\\n  padding: 8px 12px 8px 16px;\\n  font-size: 11px;\\n  background: #f8fafc;\\n  color: #0b1220;\\n}\\n\\n#mobius-os-mini .mobius-mini-theme-submenu .mobius-mini-menu-item:hover {\\n  background: rgba(11, 18, 32, 0.08);\\n}\\n\\n#mobius-os-mini .mobius-mini-row {\\n  padding: 6px 10px;\\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n}\\n\\n#mobius-os-mini .mobius-mini-row:last-child {\\n  border-bottom: none;\\n}\\n\\n#mobius-os-mini .mobius-mini-row-label {\\n  width: 48px;\\n  flex: 0 0 auto;\\n  font-size: 9px;\\n  letter-spacing: 0.04em;\\n  text-transform: uppercase;\\n  color: rgba(91,102,122,0.95);\\n  font-weight: 600;\\n}\\n\\n#mobius-os-mini .mobius-mini-row-body {\\n  min-width: 0;\\n  flex: 1 1 auto;\\n  display: flex;\\n  flex-direction: column;\\n  gap: 2px;\\n}\\n\\n#mobius-os-mini .mobius-mini-patient-name {\\n  font-size: 11px;\\n  font-weight: 600;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n\\n#mobius-os-mini .mobius-mini-patient-id {\\n  font-size: 9px;\\n  font-weight: 500;\\n  color: rgba(91,102,122,0.95);\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n\\n#mobius-os-mini .mobius-mini-patient-dob {\\n  font-size: 9px;\\n  font-weight: 500;\\n  color: rgba(91,102,122,0.95);\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n\\n#mobius-os-mini .mobius-mini-inline-btn {\\n  height: 28px;\\n  border-radius: 10px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  font-weight: 600;\\n  font-size: 11px;\\n  padding: 0 10px;\\n}\\n\\n#mobius-os-mini .mobius-mini-inline-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n/* Icon-only button (e.g., edit patient) */\\n#mobius-os-mini .mobius-mini-icon-btn {\\n  width: 28px;\\n  height: 28px;\\n  border-radius: 10px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n  padding: 0;\\n}\\n\\n#mobius-os-mini .mobius-mini-icon-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n#mobius-os-mini .mobius-mini-icon-btn svg {\\n  width: 16px;\\n  height: 16px;\\n  fill: rgba(11, 18, 32, 0.80);\\n}\\n\\n#mobius-os-mini .mobius-mini-status {\\n  width: 100%;\\n  border: 1px solid rgba(11, 18, 32, 0.10);\\n  background: rgba(11, 18, 32, 0.03);\\n  border-radius: 10px;\\n  padding: 5px 8px;\\n  cursor: pointer;\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  font-size: 10px;\\n  font-weight: 600;\\n  color: #0b1220;\\n}\\n\\n#mobius-os-mini .mobius-mini-status:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n#mobius-os-mini .mobius-mini-dot {\\n  width: 8px;\\n  height: 8px;\\n  border-radius: 999px;\\n  flex: 0 0 auto;\\n  box-shadow: 0 0 0 3px rgba(148, 163, 184, 0.18);\\n  background: #94a3b8;\\n}\\n\\n#mobius-os-mini .dot-green {\\n  background: #16a34a;\\n  box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.14);\\n}\\n\\n#mobius-os-mini .dot-yellow {\\n  background: #f59e0b;\\n  box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.18);\\n}\\n\\n#mobius-os-mini .dot-blue {\\n  background: #2563eb;\\n  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.16);\\n}\\n\\n#mobius-os-mini .dot-grey {\\n  background: #94a3b8;\\n  box-shadow: 0 0 0 3px rgba(148, 163, 184, 0.18);\\n}\\n\\n#mobius-os-mini .dot-red {\\n  background: #dc2626;\\n  box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.18);\\n}\\n\\n#mobius-os-mini .dot-purple {\\n  background: #9333ea;\\n  box-shadow: 0 0 0 3px rgba(147, 51, 234, 0.18);\\n}\\n\\n#mobius-os-mini .mobius-mini-status-text {\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  min-width: 0;\\n  flex: 1;\\n}\\n\\n/* Needs Attention row - refined spacing */\\n#mobius-os-mini .mobius-mini-attention-row {\\n  padding: 10px;\\n  gap: 10px;\\n}\\n\\n#mobius-os-mini .mobius-mini-attention-row .mobius-mini-row-label {\\n  width: 48px;\\n  font-size: 9px;\\n  line-height: 1.2;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-mini .mobius-mini-attention-content {\\n  flex: 1;\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  flex-wrap: wrap;\\n}\\n\\n#mobius-os-mini .mobius-mini-question-text {\\n  flex: 1;\\n  font-size: 11px;\\n  color: #1e293b;\\n  line-height: 1.3;\\n  min-width: 100px;\\n}\\n\\n#mobius-os-mini .mobius-mini-attention-content {\\n  flex: 1;\\n  display: flex;\\n  align-items: flex-start;\\n  gap: 8px;\\n  min-width: 0;\\n}\\n\\n#mobius-os-mini .mobius-mini-attention-content .mobius-mini-dot {\\n  margin-top: 4px;\\n  margin-left: 2px;\\n  flex-shrink: 0;\\n}\\n\\n#mobius-os-mini .mobius-mini-problem-text {\\n  flex: 1;\\n  white-space: normal;\\n  word-wrap: break-word;\\n  text-align: left;\\n  min-width: 0;\\n  font-size: 9px;\\n  line-height: 1.35;\\n  color: #0b1220;\\n  padding-right: 6px;\\n}\\n\\n/* Status badge - clickable */\\n#mobius-os-mini .mobius-mini-status-badge {\\n  display: flex;\\n  align-items: center;\\n  gap: 4px;\\n  padding: 3px 8px;\\n  border: 1px solid rgba(11, 18, 32, 0.15);\\n  border-radius: 4px;\\n  background: rgba(11, 18, 32, 0.04);\\n  cursor: pointer;\\n  flex-shrink: 0;\\n  font-size: 8px;\\n  font-weight: 500;\\n  color: #64748b;\\n  margin-left: 4px;\\n}\\n\\n#mobius-os-mini .mobius-mini-status-badge:hover {\\n  background: rgba(11, 18, 32, 0.08);\\n}\\n\\n#mobius-os-mini .mobius-mini-status-badge.status-resolved {\\n  background: rgba(22, 163, 74, 0.1);\\n  border-color: rgba(22, 163, 74, 0.3);\\n  color: #16a34a;\\n}\\n\\n#mobius-os-mini .mobius-mini-status-badge.status-unresolved {\\n  background: rgba(245, 158, 11, 0.1);\\n  border-color: rgba(245, 158, 11, 0.3);\\n  color: #d97706;\\n}\\n\\n#mobius-os-mini .mobius-mini-status-badge.status-unconfirmed {\\n  background: rgba(148, 163, 184, 0.15);\\n  border-color: rgba(148, 163, 184, 0.4);\\n  color: #64748b;\\n}\\n\\n#mobius-os-mini .mobius-mini-dropdown-icon {\\n  font-size: 6px;\\n  color: inherit;\\n  opacity: 0.7;\\n}\\n\\n/* Task badge row - compact */\\n#mobius-os-mini .mobius-mini-task-badge-row {\\n  padding: 6px 10px;\\n}\\n\\n#mobius-os-mini .mobius-mini-task-badge-row .mobius-mini-row-label {\\n  width: 48px;\\n  font-size: 9px;\\n  line-height: 1.2;\\n}\\n\\n#mobius-os-mini .mobius-mini-task-badge {\\n  display: flex;\\n  align-items: center;\\n  gap: 4px;\\n  padding: 4px 8px;\\n  border: 1px solid rgba(11, 18, 32, 0.10);\\n  background: rgba(37, 99, 235, 0.06);\\n  border-radius: 8px;\\n  cursor: pointer;\\n  font-size: 9px;\\n  font-weight: 500;\\n  color: #2563eb;\\n}\\n\\n#mobius-os-mini .mobius-mini-task-badge:hover {\\n  background: rgba(37, 99, 235, 0.12);\\n}\\n\\n#mobius-os-mini .mobius-mini-task-count {\\n  font-weight: 700;\\n}\\n\\n/* Answer dropdown styling */\\n.mobius-mini-answer-dropdown {\\n  background: white !important;\\n  border-radius: 6px !important;\\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12) !important;\\n  padding: 4px 0 !important;\\n  min-width: 160px !important;\\n  display: flex !important;\\n  flex-direction: column !important;\\n}\\n\\n.mobius-mini-answer-dropdown .mobius-mini-dropdown-item {\\n  display: block !important;\\n  width: 100% !important;\\n  padding: 8px 12px !important;\\n  font-size: 10px !important;\\n  text-align: left !important;\\n  background: transparent !important;\\n  border: none !important;\\n  cursor: pointer !important;\\n  color: #1e293b !important;\\n  line-height: 1.3 !important;\\n}\\n\\n.mobius-mini-answer-dropdown .mobius-mini-dropdown-item:hover {\\n  background: rgba(37, 99, 235, 0.08) !important;\\n}\\n\\n#mobius-os-mini .mobius-mini-step-question {\\n  font-size: 10px;\\n  font-weight: 500;\\n  color: #1e293b;\\n  line-height: 1.3;\\n}\\n\\n#mobius-os-mini .mobius-mini-step-buttons {\\n  display: flex;\\n  flex-wrap: wrap;\\n  gap: 4px;\\n}\\n\\n#mobius-os-mini .mobius-mini-quick-answer-btn {\\n  padding: 4px 8px;\\n  font-size: 9px;\\n  font-weight: 500;\\n  border: 1px solid rgba(37, 99, 235, 0.2);\\n  background: white;\\n  color: #2563eb;\\n  border-radius: 12px;\\n  cursor: pointer;\\n  transition: all 0.15s ease;\\n}\\n\\n#mobius-os-mini .mobius-mini-quick-answer-btn:hover {\\n  background: rgba(37, 99, 235, 0.08);\\n  border-color: #2563eb;\\n}\\n\\n#mobius-os-mini .mobius-mini-quick-answer-btn:disabled {\\n  opacity: 0.5;\\n  cursor: not-allowed;\\n}\\n\\n#mobius-os-mini .mobius-mini-quick-answer-btn.suggested {\\n  background: rgba(34, 197, 94, 0.1);\\n  border-color: rgba(34, 197, 94, 0.3);\\n  color: #16a34a;\\n}\\n\\n#mobius-os-mini .mobius-mini-quick-answer-btn.suggested:hover {\\n  background: rgba(34, 197, 94, 0.2);\\n}\\n\\n#mobius-os-mini .mobius-mini-open-sidecar-btn {\\n  padding: 4px 10px;\\n  font-size: 9px;\\n  font-weight: 500;\\n  border: none;\\n  background: #2563eb;\\n  color: white;\\n  border-radius: 12px;\\n  cursor: pointer;\\n  transition: all 0.15s ease;\\n}\\n\\n#mobius-os-mini .mobius-mini-open-sidecar-btn:hover {\\n  background: #1d4ed8;\\n}\\n\\n/* Dark theme for status row */\\n#mobius-os-mini.theme-dark .mobius-mini-question-text {\\n  color: #e5e7eb;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-quick-answer-btn {\\n  background: rgba(255, 255, 255, 0.08);\\n  border-color: rgba(255, 255, 255, 0.2);\\n  color: #e5e7eb;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-quick-answer-btn:hover {\\n  background: rgba(255, 255, 255, 0.15);\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-quick-answer-btn.suggested {\\n  background: rgba(34, 197, 94, 0.2);\\n  border-color: rgba(34, 197, 94, 0.4);\\n  color: #4ade80;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-open-sidecar-btn {\\n  background: #3b82f6;\\n}\\n\\n/* User Greeting Row */\\n#mobius-os-mini .mobius-mini-greeting-row {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding: 5px 10px;\\n  background: linear-gradient(90deg, rgba(37, 99, 235, 0.04), rgba(99, 102, 241, 0.02));\\n  border-bottom: 1px solid rgba(11, 18, 32, 0.06);\\n  position: relative;\\n}\\n\\n#mobius-os-mini .mobius-mini-greeting-main {\\n  display: flex;\\n  align-items: center;\\n  gap: 3px;\\n  background: none;\\n  border: none;\\n  padding: 0;\\n  cursor: pointer;\\n  color: inherit;\\n  font: inherit;\\n}\\n\\n#mobius-os-mini .mobius-mini-greeting-main:hover {\\n  opacity: 0.8;\\n}\\n\\n#mobius-os-mini .mobius-mini-greeting-text {\\n  font-size: 9px;\\n  font-weight: 500;\\n  color: #3b82f6;\\n}\\n\\n#mobius-os-mini .mobius-mini-greeting-chevron {\\n  color: #60a5fa;\\n  opacity: 0.6;\\n  width: 10px;\\n  height: 10px;\\n}\\n\\n#mobius-os-mini .mobius-mini-greeting-dismiss {\\n  width: 16px;\\n  height: 16px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  background: none;\\n  border: none;\\n  border-radius: 3px;\\n  cursor: pointer;\\n  color: #94a3b8;\\n  padding: 0;\\n}\\n\\n#mobius-os-mini .mobius-mini-greeting-dismiss:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n  color: #64748b;\\n}\\n\\n#mobius-os-mini .mobius-mini-greeting-dismiss svg {\\n  width: 10px;\\n  height: 10px;\\n}\\n\\n/* User Dropdown */\\n#mobius-os-mini .mobius-mini-user-dropdown {\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\\n}\\n\\n/* Locked Overlay */\\n#mobius-os-mini .mobius-mini-locked-overlay {\\n  padding: 16px;\\n  text-align: center;\\n  background: linear-gradient(180deg, rgba(248, 250, 252, 0.98), rgba(241, 245, 249, 0.98));\\n}\\n\\n/* Theme variations for greeting */\\n#mobius-os-mini.theme-dark .mobius-mini-greeting-row {\\n  background: linear-gradient(90deg, rgba(37, 99, 235, 0.12), rgba(99, 102, 241, 0.08));\\n  border-bottom-color: rgba(255, 255, 255, 0.08);\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-greeting-text {\\n  color: #93c5fd;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-greeting-chevron {\\n  color: #60a5fa;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-greeting-dismiss {\\n  color: rgba(148, 163, 184, 0.7);\\n}\\n\\n#mobius-os-mini.theme-blue .mobius-mini-greeting-row {\\n  background: linear-gradient(90deg, rgba(37, 99, 235, 0.1), rgba(96, 165, 250, 0.08));\\n}\\n\\n#mobius-os-mini.theme-blue .mobius-mini-greeting-text {\\n  color: #1d4ed8;\\n}\\n\\n/* Attention dropdown - compact */\\n#mobius-os-mini .mobius-mini-attention-dropdown {\\n  min-width: 180px !important;\\n  max-width: 220px;\\n}\\n\\n#mobius-os-mini .mobius-mini-note-wrap {\\n  width: 100%;\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n}\\n\\n#mobius-os-mini .mobius-mini-note-input {\\n  width: 100%;\\n  height: 28px;\\n  border-radius: 10px;\\n  border: 1px solid rgba(11, 18, 32, 0.14);\\n  background: #fff;\\n  padding: 0 34px 0 8px;\\n  font-size: 10px;\\n  font-weight: 500;\\n  color: #0b1220;\\n  outline: none;\\n}\\n\\n#mobius-os-mini .mobius-mini-note-input::placeholder {\\n  color: rgba(91,102,122,0.75);\\n  font-weight: 500;\\n}\\n\\n#mobius-os-mini .mobius-mini-note-input:focus {\\n  border-color: rgba(37, 99, 235, 0.55);\\n}\\n\\n#mobius-os-mini .mobius-mini-send-btn {\\n  position: absolute;\\n  right: 6px;\\n  width: 28px;\\n  height: 28px;\\n  border-radius: 10px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n  padding: 0;\\n}\\n\\n#mobius-os-mini .mobius-mini-send-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n#mobius-os-mini .mobius-mini-send-btn svg {\\n  width: 16px;\\n  height: 16px;\\n  display: block;\\n  fill: rgba(11, 18, 32, 0.85);\\n}\\n\\n/* =============================================================================\\n   Mini Widget Themes\\n   ============================================================================= */\\n\\n/* Theme: Light (default) - already applied via base styles */\\n#mobius-os-mini.theme-light {\\n  background: #ffffff !important;\\n  color: #0b1220 !important;\\n  border-color: rgba(11, 18, 32, 0.12) !important;\\n  box-shadow: 0 16px 34px rgba(2, 6, 23, 0.14) !important;\\n}\\n\\n/* Theme: Dark */\\n#mobius-os-mini.theme-dark {\\n  background: #1e293b !important;\\n  color: #f1f5f9 !important;\\n  border-color: #334155 !important;\\n  box-shadow: 0 16px 34px rgba(0, 0, 0, 0.4) !important;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-header {\\n  background: rgba(255, 255, 255, 0.03);\\n  border-bottom-color: rgba(255, 255, 255, 0.08);\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-brand-text {\\n  color: #f1f5f9;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-row {\\n  border-bottom-color: rgba(255, 255, 255, 0.08);\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-row-label {\\n  color: rgba(148, 163, 184, 0.9);\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-patient-name {\\n  color: #f1f5f9;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-patient-id,\\n#mobius-os-mini.theme-dark .mobius-mini-patient-dob {\\n  color: rgba(148, 163, 184, 0.9);\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-minimized-patient {\\n  color: #e2e8f0;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-problem-text {\\n  color: #e2e8f0;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-status-badge {\\n  background: rgba(255, 255, 255, 0.08);\\n  border-color: rgba(255, 255, 255, 0.15);\\n  color: #94a3b8;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-note-input {\\n  background: #0f172a;\\n  border-color: rgba(255, 255, 255, 0.12);\\n  color: #f1f5f9;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-note-input::placeholder {\\n  color: rgba(148, 163, 184, 0.6);\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-menu-btn,\\n#mobius-os-mini.theme-dark .mobius-mini-expand-btn,\\n#mobius-os-mini.theme-dark .mobius-mini-minimize-btn,\\n#mobius-os-mini.theme-dark .mobius-mini-drag-handle,\\n#mobius-os-mini.theme-dark .mobius-mini-icon-btn,\\n#mobius-os-mini.theme-dark .mobius-mini-send-btn {\\n  background: rgba(255, 255, 255, 0.06);\\n  border-color: rgba(255, 255, 255, 0.12);\\n  color: #e5e7eb;\\n}\\n\\n#mobius-os-mini.theme-dark .mobius-mini-task-badge {\\n  background: rgba(37, 99, 235, 0.15);\\n  border-color: rgba(37, 99, 235, 0.3);\\n}\\n\\n/* Theme: Blue */\\n#mobius-os-mini.theme-blue {\\n  background: #eff6ff !important;\\n  color: #1e3a5f !important;\\n  border-color: #bfdbfe !important;\\n  box-shadow: 0 16px 34px rgba(37, 99, 235, 0.15) !important;\\n}\\n\\n#mobius-os-mini.theme-blue .mobius-mini-header {\\n  background: rgba(37, 99, 235, 0.05);\\n  border-bottom-color: rgba(37, 99, 235, 0.1);\\n}\\n\\n#mobius-os-mini.theme-blue .mobius-mini-brand-text {\\n  color: #1e40af;\\n}\\n\\n#mobius-os-mini.theme-blue .mobius-mini-row {\\n  border-bottom-color: rgba(37, 99, 235, 0.1);\\n}\\n\\n#mobius-os-mini.theme-blue .mobius-mini-row-label {\\n  color: #3b82f6;\\n}\\n\\n#mobius-os-mini.theme-blue .mobius-mini-patient-name {\\n  color: #1e3a5f;\\n}\\n\\n#mobius-os-mini.theme-blue .mobius-mini-status-badge {\\n  background: rgba(37, 99, 235, 0.1);\\n  border-color: rgba(37, 99, 235, 0.25);\\n}\\n\\n#mobius-os-mini.theme-blue .mobius-mini-note-input {\\n  background: #ffffff;\\n  border-color: #bfdbfe;\\n}\\n\\n/* Theme: Glass */\\n#mobius-os-mini.theme-glass {\\n  background: rgba(255, 255, 255, 0.8) !important;\\n  color: #0b1220 !important;\\n  border-color: rgba(255, 255, 255, 0.5) !important;\\n  box-shadow: 0 16px 34px rgba(2, 6, 23, 0.12), 0 0 0 1px rgba(255,255,255,0.2) inset !important;\\n  backdrop-filter: blur(12px) !important;\\n  -webkit-backdrop-filter: blur(12px) !important;\\n}\\n\\n#mobius-os-mini.theme-glass .mobius-mini-header {\\n  background: rgba(255, 255, 255, 0.3);\\n  border-bottom-color: rgba(11, 18, 32, 0.06);\\n}\\n\\n#mobius-os-mini.theme-glass .mobius-mini-row {\\n  border-bottom-color: rgba(11, 18, 32, 0.06);\\n}\\n\\n#mobius-os-mini.theme-glass .mobius-mini-note-input {\\n  background: rgba(255, 255, 255, 0.6);\\n}\\n\\n#mobius-os-mini.theme-glass .mobius-mini-menu-btn,\\n#mobius-os-mini.theme-glass .mobius-mini-expand-btn,\\n#mobius-os-mini.theme-glass .mobius-mini-minimize-btn,\\n#mobius-os-mini.theme-glass .mobius-mini-drag-handle {\\n  background: rgba(255, 255, 255, 0.4);\\n}\\n\\n#mobius-os-mini.theme-glass .mobius-mini-minimized-patient {\\n  color: #1e293b;\\n}\\n\\n/* Patient edit modal */\\n.mobius-mini-modal-overlay {\\n  position: fixed;\\n  inset: 0;\\n  background: rgba(2, 6, 23, 0.28);\\n  z-index: 2147483647;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  padding: 18px;\\n}\\n\\n.mobius-mini-modal {\\n  width: 360px;\\n  max-width: calc(100vw - 36px);\\n  background: #fff;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  border-radius: 14px;\\n  box-shadow: 0 18px 40px rgba(2, 6, 23, 0.20);\\n  overflow: hidden;\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Google Sans', sans-serif;\\n  color: #0b1220;\\n}\\n\\n.mobius-mini-modal-header {\\n  padding: 10px 12px;\\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  gap: 10px;\\n}\\n\\n.mobius-mini-modal-title {\\n  font-size: 12px;\\n  font-weight: 600;\\n}\\n\\n.mobius-mini-modal-close {\\n  width: 28px;\\n  height: 28px;\\n  border-radius: 10px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n  font-weight: 600;\\n}\\n\\n.mobius-mini-modal-close:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n.mobius-mini-modal-body {\\n  padding: 14px 16px 12px;\\n  display: flex;\\n  flex-direction: column;\\n  gap: 12px;\\n}\\n\\n.mobius-mini-field {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 6px;\\n}\\n\\n.mobius-mini-field-label {\\n  font-size: 9px;\\n  letter-spacing: 0.10em;\\n  text-transform: uppercase;\\n  color: rgba(91,102,122,0.95);\\n  font-weight: 600;\\n  margin-bottom: 0;\\n}\\n\\n.mobius-mini-search-input {\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n}\\n\\n.mobius-mini-search-icon {\\n  position: absolute;\\n  left: 10px;\\n  width: 16px;\\n  height: 16px;\\n  display: grid;\\n  place-items: center;\\n  opacity: 0.75;\\n  pointer-events: none;\\n}\\n\\n.mobius-mini-search-icon svg {\\n  width: 16px;\\n  height: 16px;\\n  fill: rgba(91, 102, 122, 0.95);\\n}\\n\\n.mobius-mini-input.mobius-mini-input-with-icon {\\n  padding-left: 34px;\\n}\\n\\n.mobius-mini-input {\\n  width: 100%;\\n  height: 34px;\\n  border-radius: 12px;\\n  border: 1px solid rgba(11, 18, 32, 0.14);\\n  padding: 0 10px;\\n  font-size: 12px;\\n  font-weight: 500;\\n  outline: none;\\n}\\n\\n.mobius-mini-input:focus {\\n  border-color: rgba(37, 99, 235, 0.55);\\n}\\n\\n.mobius-mini-field-hint {\\n  font-size: 12px;\\n  color: rgba(91,102,122,0.95);\\n}\\n\\n.mobius-mini-suggestions {\\n  display: none;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  border-radius: 12px;\\n  background: #fff;\\n  overflow: hidden;\\n  box-shadow: 0 12px 24px rgba(2,6,23,0.12);\\n}\\n\\n.mobius-mini-suggestion {\\n  width: 100%;\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  gap: 10px;\\n  padding: 10px 12px;\\n  border: none;\\n  background: #fff;\\n  cursor: pointer;\\n  font: inherit;\\n}\\n\\n.mobius-mini-suggestion:hover {\\n  background: rgba(11, 18, 32, 0.04);\\n}\\n\\n.mobius-mini-suggestion.active {\\n  background: rgba(37, 99, 235, 0.10);\\n}\\n\\n.mobius-mini-suggestion .name {\\n  font-size: 12px;\\n  font-weight: 600;\\n  color: #0b1220;\\n  min-width: 0;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n}\\n\\n.mobius-mini-suggestion .id {\\n  font-size: 11px;\\n  font-weight: 500;\\n  color: rgba(91,102,122,0.95);\\n  white-space: nowrap;\\n  flex: 0 0 auto;\\n}\\n\\n.mobius-mini-modal-actions {\\n  padding: 10px 12px;\\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\\n  display: flex;\\n  justify-content: flex-end;\\n  gap: 8px;\\n}\\n\\n.mobius-mini-btn-secondary,\\n.mobius-mini-btn-primary {\\n  height: 34px;\\n  border-radius: 12px;\\n  padding: 0 12px;\\n  font-size: 12px;\\n  font-weight: 600;\\n  cursor: pointer;\\n}\\n\\n.mobius-mini-btn-secondary {\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n}\\n\\n.mobius-mini-btn-secondary:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n.mobius-mini-btn-primary {\\n  border: 1px solid rgba(37, 99, 235, 0.22);\\n  background: rgba(37, 99, 235, 0.12);\\n  color: #1e40af;\\n}\\n\\n.mobius-mini-btn-primary:hover {\\n  background: rgba(37, 99, 235, 0.16);\\n}\\n\\n/* Mini toast */\\n.mobius-mini-toast {\\n  position: fixed;\\n  left: 50%;\\n  top: 16px;\\n  transform: translateX(-50%);\\n  background: rgba(15,23,42,0.92);\\n  color: #fff;\\n  padding: 10px 12px;\\n  border-radius: 12px;\\n  font-size: 12px;\\n  font-weight: 600;\\n  z-index: 2147483647;\\n  box-shadow: 0 14px 28px rgba(2,6,23,0.22);\\n}\\n\\n/* =============================================================================\\n   SIDECAR COMPONENTS\\n   Minimalist, bottleneck-focused design\\n   ============================================================================= */\\n\\n/* Status Bar - Modern minimal design */\\n.sidecar-status-bar {\\n  padding: 6px 12px;\\n  background: #ffffff;\\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\\n  display: flex;\\n  flex-direction: column;\\n  gap: 4px;\\n}\\n\\n.sidecar-status-bar-title-row {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  gap: 8px;\\n}\\n\\n.sidecar-status-bar-title {\\n  font-size: 7px;\\n  font-weight: 600;\\n  color: rgba(91, 102, 122, 0.95);\\n  text-transform: uppercase;\\n  letter-spacing: 0.04em;\\n}\\n\\n.sidecar-status-bar-context {\\n  font-size: 8px;\\n  font-weight: 400;\\n  color: rgba(91, 102, 122, 0.8);\\n  white-space: nowrap;\\n}\\n\\n.sidecar-status-bar-progress-row {\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n}\\n\\n.sidecar-status-bar-track-wrapper {\\n  flex: 1;\\n  min-width: 0;\\n}\\n\\n.sidecar-status-bar-track {\\n  position: relative;\\n  height: 3px;\\n  border-radius: 2px;\\n  /* Mono grey gradient - subtle, modern */\\n  background: linear-gradient(90deg, \\n    rgba(11, 18, 32, 0.08) 0%, \\n    rgba(11, 18, 32, 0.12) 50%,\\n    rgba(11, 18, 32, 0.06) 100%\\n  );\\n}\\n\\n/* Progress fill - darker grey to show completion */\\n.sidecar-status-bar-progress {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  height: 100%;\\n  background: rgba(11, 18, 32, 0.35);\\n  border-radius: 2px;\\n  transition: width 0.3s ease;\\n}\\n\\n/* Current position marker */\\n.sidecar-status-bar-marker {\\n  position: absolute;\\n  top: -3px;\\n  width: 9px;\\n  height: 9px;\\n  border-radius: 50%;\\n  transform: translateX(-50%);\\n  background: #0b1220;\\n  border: 2px solid #ffffff;\\n  box-shadow: 0 1px 3px rgba(2, 6, 23, 0.2);\\n  z-index: 2;\\n}\\n\\n/* Percentage label */\\n.sidecar-status-bar-percent {\\n  font-size: 9px;\\n  font-weight: 600;\\n  color: #0b1220;\\n  white-space: nowrap;\\n}\\n\\n/* Bottleneck Card - Core UI */\\n/* Mobius Greeting */\\n.sidecar-greeting {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 2px;\\n  padding-bottom: 8px;\\n  margin-bottom: 6px;\\n  border-bottom: 1px solid rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-greeting-text {\\n  font-size: 12px;\\n  font-weight: 500;\\n  color: #0b1220;\\n}\\n\\n.sidecar-greeting-subtext {\\n  font-size: 10px;\\n  font-weight: 400;\\n  color: rgba(91, 102, 122, 0.6);\\n}\\n\\n.sidecar-bottleneck-card {\\n  padding: 0;\\n  display: flex;\\n  flex-direction: column;\\n  gap: 8px;\\n}\\n\\n.sidecar-bottleneck-card--clear {\\n  padding: 6px 0;\\n}\\n\\n.sidecar-bottleneck-header {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding-bottom: 6px;\\n  border-bottom: 1px solid rgba(11, 18, 32, 0.08);\\n}\\n\\n.sidecar-bottleneck-count {\\n  font-size: 11px;\\n  font-weight: 500;\\n  color: #0b1220;\\n}\\n\\n.sidecar-bottleneck-hint {\\n  font-size: 9px;\\n  font-weight: 400;\\n  color: rgba(91, 102, 122, 0.6);\\n}\\n\\n.sidecar-bottleneck-item {\\n  background: #ffffff;\\n  border: 1px solid rgba(11, 18, 32, 0.08);\\n  border-radius: 6px;\\n  padding: 6px 8px;\\n  display: flex;\\n  box-shadow: none;\\n  flex-direction: column;\\n  gap: 4px;\\n}\\n\\n.sidecar-bottleneck-question-row {\\n  display: flex;\\n  align-items: flex-start;\\n  gap: 4px;\\n}\\n\\n.sidecar-bottleneck-question-row::before {\\n  content: '';\\n  display: inline-block;\\n  width: 4px;\\n  height: 4px;\\n  min-width: 4px;\\n  background: #3b82f6;\\n  border-radius: 50%;\\n  margin-top: 4px;\\n  flex-shrink: 0;\\n}\\n\\n.sidecar-bottleneck-checkbox {\\n  width: 14px;\\n  height: 14px;\\n  cursor: pointer;\\n  margin-top: 1px;\\n}\\n\\n.sidecar-bottleneck-question {\\n  flex: 1;\\n  font-size: 10px;\\n  font-weight: 500;\\n  color: #0b1220;\\n  line-height: 1.25;\\n}\\n\\n.sidecar-source-badge {\\n  font-size: 10px;\\n  opacity: 0.7;\\n}\\n\\n.sidecar-conflict-badge {\\n  font-size: 12px;\\n}\\n\\n.sidecar-bottleneck-answers {\\n  display: flex;\\n  gap: 10px;\\n  flex-wrap: wrap;\\n  margin-top: 4px;\\n  padding: 4px 0;\\n  align-items: center;\\n  border-top: 1px solid rgba(11, 18, 32, 0.04);\\n}\\n\\n#mobius-os-sidebar .sidecar-bottleneck-answers button.sidecar-answer-btn,\\n.sidecar-answer-btn {\\n  /* Reset all button defaults with high specificity */\\n  all: unset !important;\\n  box-sizing: border-box !important;\\n  /* Apply our styles - pill buttons with grey background */\\n  display: inline-block !important;\\n  padding: 3px 8px !important;\\n  margin: 0 !important;\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\\n  font-size: 9px !important;\\n  font-weight: 400 !important;\\n  background: rgba(11, 18, 32, 0.06) !important;\\n  background-color: rgba(11, 18, 32, 0.06) !important;\\n  border: 1px solid rgba(11, 18, 32, 0.08) !important;\\n  border-radius: 4px !important;\\n  color: rgba(91, 102, 122, 0.85) !important;\\n  cursor: pointer !important;\\n  transition: all 0.15s ease !important;\\n  text-decoration: none !important;\\n  line-height: 1.3 !important;\\n  white-space: nowrap !important;\\n  box-shadow: none !important;\\n  outline: none !important;\\n}\\n\\n#mobius-os-sidebar .sidecar-bottleneck-answers button.sidecar-answer-btn:hover,\\n.sidecar-answer-btn:hover {\\n  background: rgba(11, 18, 32, 0.1) !important;\\n  background-color: rgba(11, 18, 32, 0.1) !important;\\n  border-color: rgba(11, 18, 32, 0.15) !important;\\n  color: #0b1220 !important;\\n}\\n\\n#mobius-os-sidebar .sidecar-bottleneck-answers button.sidecar-answer-btn.sidecar-answer-btn--selected,\\n#mobius-os-sidebar button.sidecar-answer-btn.sidecar-answer-btn--selected,\\n.sidecar-bottleneck-answers .sidecar-answer-btn.sidecar-answer-btn--selected,\\n.sidecar-answer-btn.sidecar-answer-btn--selected,\\n.sidecar-answer-btn--selected {\\n  background: rgba(37, 99, 235, 0.15) !important;\\n  background-color: rgba(37, 99, 235, 0.15) !important;\\n  border: 1px solid rgba(37, 99, 235, 0.35) !important;\\n  border-color: rgba(37, 99, 235, 0.35) !important;\\n  color: #2563eb !important;\\n  font-weight: 500 !important;\\n}\\n\\n/* Assignment Dropdown - compact, near question */\\n.sidecar-assign-dropdown {\\n  position: relative;\\n  flex-shrink: 0;\\n  margin-left: auto;\\n}\\n\\n.sidecar-assign-btn {\\n  display: flex;\\n  align-items: center;\\n  gap: 3px;\\n  padding: 3px 6px;\\n  font-size: 9px;\\n  font-weight: 400;\\n  color: rgba(37, 99, 235, 0.9);\\n  background: rgba(37, 99, 235, 0.06);\\n  border: 1px solid rgba(37, 99, 235, 0.15);\\n  border-radius: 6px;\\n  cursor: pointer;\\n  transition: all 0.15s ease;\\n}\\n\\n.sidecar-assign-btn:hover {\\n  background: rgba(37, 99, 235, 0.12);\\n  border-color: rgba(37, 99, 235, 0.25);\\n}\\n\\n.sidecar-assign-btn--assigned {\\n  background: rgba(34, 197, 94, 0.08);\\n  border-color: rgba(34, 197, 94, 0.25);\\n  color: rgba(34, 197, 94, 0.9);\\n}\\n\\n.sidecar-assign-label {\\n  font-size: 9px;\\n}\\n\\n.sidecar-assign-arrow {\\n  font-size: 8px;\\n  opacity: 0.6;\\n}\\n\\n.sidecar-assign-menu {\\n  position: absolute;\\n  top: 100%;\\n  right: 0;\\n  margin-top: 4px;\\n  min-width: 140px;\\n  background: #ffffff;\\n  border: 1px solid rgba(11, 18, 32, 0.10);\\n  border-radius: 8px;\\n  box-shadow: 0 4px 16px rgba(2, 6, 23, 0.10);\\n  z-index: 100;\\n  overflow: hidden;\\n  padding: 4px 0;\\n}\\n\\n.sidecar-assign-option {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: flex-start;\\n  gap: 1px;\\n  width: 100%;\\n  padding: 6px 10px;\\n  font-size: 9px;\\n  font-weight: 400;\\n  color: #0b1220;\\n  background: transparent;\\n  border: none;\\n  cursor: pointer;\\n  text-align: left;\\n}\\n\\n.sidecar-assign-option:hover {\\n  background: rgba(37, 99, 235, 0.06);\\n}\\n\\n.sidecar-assign-option-text {\\n  font-size: 10px;\\n  font-weight: 400;\\n  color: #0b1220;\\n}\\n\\n.sidecar-assign-option-hint {\\n  font-size: 8px;\\n  font-weight: 400;\\n  color: rgba(91, 102, 122, 0.6);\\n}\\n\\n.sidecar-assign-divider {\\n  height: 1px;\\n  background: rgba(11, 18, 32, 0.08);\\n  margin: 4px 0;\\n}\\n\\n/* Legacy delegate row - hidden but kept for compatibility */\\n.sidecar-bottleneck-delegate {\\n  display: none;\\n}\\n\\n.sidecar-bottleneck-separator {\\n  font-size: 9px;\\n  color: rgba(91, 102, 122, 0.7);\\n  text-align: center;\\n}\\n\\n.sidecar-mode-btn {\\n  padding: 3px 8px;\\n  font-size: 9px;\\n  font-weight: 500;\\n  border-radius: 8px;\\n  cursor: pointer;\\n  transition: all 0.15s ease;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  color: #0b1220;\\n}\\n\\n.sidecar-mode-btn--mobius {\\n  background: rgba(11, 18, 32, 0.03);\\n}\\n\\n.sidecar-mode-btn--mobius:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-mode-btn--user {\\n  background: rgba(11, 18, 32, 0.03);\\n}\\n\\n.sidecar-mode-btn--user:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-mode-btn--selected {\\n  background: rgba(37, 99, 235, 0.1);\\n  border-color: rgba(37, 99, 235, 0.35);\\n  color: #2563eb;\\n}\\n\\n/* Mobius tip - encourages user adoption */\\n.sidecar-bottleneck-mobius-tip {\\n  display: flex;\\n  align-items: center;\\n  gap: 4px;\\n  margin-top: 4px;\\n  padding: 3px 6px;\\n  font-size: 8px;\\n  font-weight: 400;\\n  color: rgba(37, 99, 235, 0.75);\\n  background: rgba(37, 99, 235, 0.04);\\n  border-radius: 4px;\\n}\\n\\n.sidecar-bottleneck-mobius-tip:hover {\\n  background: rgba(37, 99, 235, 0.08);\\n  color: #2563eb;\\n}\\n\\n.sidecar-mobius-tip-icon {\\n  font-size: 9px;\\n}\\n\\n.sidecar-bottleneck-mobius-tip--assigned {\\n  color: rgba(34, 197, 94, 0.85);\\n  background: rgba(34, 197, 94, 0.06);\\n  cursor: default;\\n}\\n\\n.sidecar-bottleneck-mobius-tip--assigned:hover {\\n  background: rgba(34, 197, 94, 0.06);\\n  color: rgba(34, 197, 94, 0.85);\\n}\\n\\n/* Inline note row - matches Mini note styling */\\n.sidecar-bottleneck-note-row {\\n  margin-top: 4px;\\n  padding-top: 4px;\\n  border-top: 1px solid rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-bottleneck-note-wrap {\\n  width: 100%;\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n}\\n\\n.sidecar-bottleneck-note-input {\\n  width: 100%;\\n  height: 22px;\\n  border-radius: 6px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: #fff;\\n  padding: 0 26px 0 6px;\\n  font-size: 9px;\\n  font-weight: 400;\\n  color: #0b1220;\\n  outline: none;\\n}\\n\\n.sidecar-bottleneck-note-input::placeholder {\\n  color: rgba(91, 102, 122, 0.75);\\n  font-weight: 500;\\n}\\n\\n.sidecar-bottleneck-note-input:focus {\\n  border-color: rgba(37, 99, 235, 0.55);\\n}\\n\\n.sidecar-bottleneck-note-send {\\n  position: absolute;\\n  right: 0;\\n  width: 22px;\\n  height: 22px;\\n  border-radius: 6px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n}\\n\\n.sidecar-bottleneck-note-send:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-bottleneck-note-send svg {\\n  width: 14px;\\n  height: 14px;\\n  display: block;\\n  fill: rgba(11, 18, 32, 0.85);\\n}\\n\\n/* Inline button (Edit, small actions) */\\n.sidecar-inline-btn {\\n  height: 22px;\\n  padding: 0 8px;\\n  border-radius: 8px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  font-size: 9px;\\n  font-weight: 600;\\n  color: #0b1220;\\n}\\n\\n.sidecar-inline-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n/* Icon-only button (pencil edit, etc) - matches Mini */\\n.sidecar-icon-btn {\\n  width: 22px;\\n  height: 22px;\\n  border-radius: 8px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n  padding: 0;\\n}\\n\\n.sidecar-icon-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-icon-btn svg {\\n  width: 12px;\\n  height: 12px;\\n  fill: rgba(11, 18, 32, 0.80);\\n}\\n\\n.sidecar-bottleneck-bulk {\\n  padding-top: 12px;\\n  border-top: 1px solid #e5e7eb;\\n}\\n\\n.sidecar-bottleneck-bulk-btn {\\n  width: 100%;\\n  padding: 8px 12px;\\n  font-size: 10px;\\n  font-weight: 600;\\n  background: rgba(11, 18, 32, 0.03);\\n  color: #0b1220;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  border-radius: 10px;\\n  cursor: pointer;\\n  transition: all 0.15s ease;\\n}\\n\\n.sidecar-bottleneck-bulk-btn:hover:not(:disabled) {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-bottleneck-bulk-btn:disabled {\\n  opacity: 0.5;\\n  cursor: not-allowed;\\n}\\n\\n.sidecar-bottleneck-clear {\\n  display: flex;\\n  align-items: center;\\n  gap: 10px;\\n  padding: 10px 12px;\\n  background: rgba(34, 197, 94, 0.08);\\n  border: 1px solid rgba(34, 197, 94, 0.15);\\n  border-radius: 10px;\\n}\\n\\n.sidecar-bottleneck-clear-icon {\\n  width: 24px;\\n  height: 24px;\\n  background: #22c55e;\\n  color: white;\\n  border-radius: 50%;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-size: 12px;\\n  font-weight: bold;\\n}\\n\\n.sidecar-bottleneck-clear-text {\\n  font-size: 11px;\\n  color: #166534;\\n  font-weight: 500;\\n}\\n\\n/* Context Expander */\\n/* Context Expander - matches Mini row styling */\\n.sidecar-context-expander {\\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\\n  margin-top: 8px;\\n}\\n\\n.sidecar-context-expander-toggle {\\n  width: 100%;\\n  padding: 6px 0;\\n  background: none;\\n  border: none;\\n  display: flex;\\n  align-items: center;\\n  gap: 4px;\\n  cursor: pointer;\\n  font-size: 10px;\\n  font-weight: 400;\\n  color: rgba(91, 102, 122, 0.95);\\n  transition: background 0.15s ease;\\n}\\n\\n.sidecar-context-expander-toggle:hover {\\n  background: rgba(11, 18, 32, 0.02);\\n}\\n\\n.sidecar-context-expander-arrow {\\n  font-size: 8px;\\n  color: rgba(91, 102, 122, 0.4);\\n  transition: transform 0.15s ease;\\n}\\n\\n.sidecar-context-expander-toggle[aria-expanded=\\\"true\\\"] .sidecar-context-expander-arrow {\\n  transform: none;\\n}\\n\\n.sidecar-context-expander-label {\\n  font-weight: 400;\\n  color: rgba(91, 102, 122, 0.7);\\n}\\n\\n.sidecar-context-expander-content {\\n  padding: 0 0 8px;\\n}\\n\\n.sidecar-section-title {\\n  font-size: 7px;\\n  font-weight: 500;\\n  color: rgba(91, 102, 122, 0.6);\\n  text-transform: uppercase;\\n  letter-spacing: 0.04em;\\n  margin-bottom: 4px;\\n}\\n\\n/* Resolution Plan Section */\\n.sidecar-plan-section {\\n  margin-bottom: 10px;\\n  padding-bottom: 8px;\\n  border-bottom: 1px solid rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-plan-summary {\\n  margin-bottom: 6px;\\n}\\n\\n.sidecar-plan-factors {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 4px;\\n}\\n\\n.sidecar-plan-factor {\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  font-size: 9px;\\n}\\n\\n.sidecar-plan-factor-label {\\n  flex: 1;\\n  color: rgba(91, 102, 122, 0.85);\\n  font-weight: 400;\\n}\\n\\n.sidecar-plan-factor-progress {\\n  font-size: 8px;\\n  color: rgba(91, 102, 122, 0.6);\\n  font-weight: 400;\\n}\\n\\n.sidecar-plan-factor-bar {\\n  width: 40px;\\n  height: 3px;\\n  background: rgba(11, 18, 32, 0.08);\\n  border-radius: 2px;\\n  overflow: hidden;\\n}\\n\\n.sidecar-plan-factor-fill {\\n  height: 100%;\\n  background: rgba(11, 18, 32, 0.35);\\n  border-radius: 2px;\\n  transition: width 0.3s ease;\\n}\\n\\n.sidecar-plan-current {\\n  display: flex;\\n  align-items: flex-start;\\n  gap: 4px;\\n  padding: 4px 6px;\\n  background: rgba(11, 18, 32, 0.03);\\n  border-radius: 6px;\\n  margin-top: 6px;\\n}\\n\\n.sidecar-plan-current-label {\\n  font-size: 8px;\\n  font-weight: 400;\\n  color: rgba(91, 102, 122, 0.6);\\n  flex-shrink: 0;\\n}\\n\\n.sidecar-plan-current-text {\\n  font-size: 9px;\\n  font-weight: 400;\\n  color: rgba(91, 102, 122, 0.85);\\n  line-height: 1.3;\\n}\\n\\n.sidecar-plan-actions {\\n  font-size: 8px;\\n  font-weight: 400;\\n  color: rgba(37, 99, 235, 0.8);\\n  margin-top: 4px;\\n}\\n\\n/* Milestones - matches Mini compact styling */\\n.sidecar-milestones-list {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 4px;\\n}\\n\\n.sidecar-milestone {\\n  background: rgba(11, 18, 32, 0.02);\\n  border: 1px solid rgba(11, 18, 32, 0.06);\\n  border-radius: 8px;\\n  overflow: hidden;\\n}\\n\\n.sidecar-milestone-header {\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  padding: 6px 10px;\\n}\\n\\n.sidecar-milestone-icon {\\n  width: 20px;\\n  height: 20px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-size: 12px;\\n}\\n\\n.sidecar-milestone--complete .sidecar-milestone-icon {\\n  color: #22c55e;\\n}\\n\\n.sidecar-milestone--in_progress .sidecar-milestone-icon {\\n  color: #f59e0b;\\n}\\n\\n.sidecar-milestone--blocked .sidecar-milestone-icon {\\n  color: #ef4444;\\n}\\n\\n.sidecar-milestone--pending .sidecar-milestone-icon {\\n  color: #9ca3af;\\n}\\n\\n.sidecar-milestone-label {\\n  flex: 1;\\n  font-size: 13px;\\n  color: #374151;\\n}\\n\\n.sidecar-milestone-arrow {\\n  font-size: 10px;\\n  color: rgba(91, 102, 122, 0.7);\\n}\\n\\n.sidecar-milestone-details {\\n  padding: 8px 12px 12px 40px;\\n  border-top: 1px solid #e5e7eb;\\n}\\n\\n/* Substeps */\\n.sidecar-substeps {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 4px;\\n  margin-bottom: 8px;\\n}\\n\\n.sidecar-substep {\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  font-size: 12px;\\n  color: #6b7280;\\n}\\n\\n.sidecar-substep-icon {\\n  font-size: 8px;\\n}\\n\\n.sidecar-substep--complete .sidecar-substep-icon {\\n  color: #22c55e;\\n}\\n\\n.sidecar-substep--current .sidecar-substep-icon {\\n  color: #2563eb;\\n}\\n\\n/* Timeline */\\n.sidecar-timeline {\\n  border-left: 2px solid #e5e7eb;\\n  padding-left: 12px;\\n}\\n\\n.sidecar-timeline-title {\\n  font-size: 11px;\\n  font-weight: 600;\\n  color: #9ca3af;\\n  margin-bottom: 8px;\\n}\\n\\n.sidecar-timeline-entry {\\n  display: flex;\\n  flex-wrap: wrap;\\n  align-items: center;\\n  gap: 6px;\\n  font-size: 12px;\\n  margin-bottom: 6px;\\n  position: relative;\\n}\\n\\n.sidecar-timeline-entry::before {\\n  content: '';\\n  position: absolute;\\n  left: -16px;\\n  width: 8px;\\n  height: 8px;\\n  background: #e5e7eb;\\n  border-radius: 50%;\\n}\\n\\n.sidecar-timeline-actor {\\n  font-weight: 500;\\n  color: #374151;\\n}\\n\\n.sidecar-timeline-actor--mobius {\\n  color: #2563eb;\\n}\\n\\n.sidecar-timeline-actor--user {\\n  color: #059669;\\n}\\n\\n.sidecar-timeline-action {\\n  color: #6b7280;\\n}\\n\\n.sidecar-timeline-time {\\n  color: #9ca3af;\\n  font-size: 11px;\\n}\\n\\n.sidecar-timeline-artifact {\\n  color: #2563eb;\\n  text-decoration: none;\\n  font-size: 11px;\\n}\\n\\n.sidecar-timeline-artifact:hover {\\n  text-decoration: underline;\\n}\\n\\n/* Payer Info */\\n.sidecar-payer-section {\\n  margin-top: 16px;\\n  padding-top: 16px;\\n  border-top: 1px solid #e5e7eb;\\n}\\n\\n.sidecar-payer-info {\\n  background: #f9fafb;\\n  border-radius: 6px;\\n  padding: 12px;\\n}\\n\\n.sidecar-payer-name {\\n  font-size: 14px;\\n  font-weight: 600;\\n  color: #1f2937;\\n  margin-bottom: 8px;\\n}\\n\\n.sidecar-payer-phone,\\n.sidecar-payer-portal,\\n.sidecar-payer-response-time {\\n  font-size: 12px;\\n  color: #6b7280;\\n  margin-bottom: 4px;\\n}\\n\\n.sidecar-payer-phone a,\\n.sidecar-payer-portal a {\\n  color: #2563eb;\\n  text-decoration: none;\\n}\\n\\n.sidecar-payer-phone a:hover,\\n.sidecar-payer-portal a:hover {\\n  text-decoration: underline;\\n}\\n\\n.sidecar-policy-excerpts {\\n  margin-top: 12px;\\n}\\n\\n.sidecar-excerpts-title {\\n  font-size: 11px;\\n  font-weight: 600;\\n  color: #9ca3af;\\n  margin-bottom: 8px;\\n}\\n\\n.sidecar-policy-excerpt {\\n  background: white;\\n  border: 1px solid #e5e7eb;\\n  border-radius: 6px;\\n  padding: 10px;\\n  margin-bottom: 8px;\\n}\\n\\n.sidecar-excerpt-topic {\\n  font-size: 12px;\\n  font-weight: 600;\\n  color: #374151;\\n  margin-bottom: 4px;\\n}\\n\\n.sidecar-excerpt-content {\\n  font-size: 12px;\\n  color: #6b7280;\\n  line-height: 1.4;\\n}\\n\\n.sidecar-excerpt-source {\\n  font-size: 10px;\\n  color: #9ca3af;\\n  margin-top: 4px;\\n}\\n\\n/* Quick Chat */\\n/* Quick Chat - matches Mini note input styling */\\n.sidecar-quick-chat {\\n  padding: 10px 10px;\\n  border-top: 1px solid rgba(11, 18, 32, 0.08);\\n  background: #ffffff;\\n}\\n\\n.sidecar-quick-chat-wrapper {\\n  display: flex;\\n  align-items: center;\\n  position: relative;\\n}\\n\\n.sidecar-quick-chat-input {\\n  flex: 1;\\n  height: 28px;\\n  padding: 0 32px 0 8px;\\n  font-size: 9px;\\n  font-weight: 400;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  border-radius: 6px;\\n  outline: none;\\n  color: #0b1220;\\n  background: #fff;\\n}\\n\\n.sidecar-quick-chat-input::placeholder {\\n  color: rgba(91, 102, 122, 0.5);\\n  font-weight: 400;\\n}\\n\\n.sidecar-quick-chat-input:focus {\\n  border-color: rgba(37, 99, 235, 0.35);\\n}\\n\\n.sidecar-quick-chat-input:disabled {\\n  background: rgba(11, 18, 32, 0.02);\\n}\\n\\n.sidecar-quick-chat-send {\\n  position: absolute;\\n  right: 0;\\n  width: 28px;\\n  height: 28px;\\n  background: transparent;\\n  border: none;\\n  border-radius: 6px;\\n  font-size: 12px;\\n  cursor: pointer;\\n  transition: background 0.15s ease;\\n  display: grid;\\n  place-items: center;\\n}\\n\\n.sidecar-quick-chat-send:hover:not(:disabled) {\\n  background: rgba(11, 18, 32, 0.04);\\n}\\n\\n.sidecar-quick-chat-send:disabled {\\n  cursor: not-allowed;\\n}\\n\\n.sidecar-quick-chat-send svg {\\n  width: 14px;\\n  height: 14px;\\n  display: block;\\n  fill: rgba(91, 102, 122, 0.6);\\n}\\n\\n.sidecar-quick-chat-send:hover:not(:disabled) svg {\\n  fill: rgba(91, 102, 122, 0.9);\\n}\\n\\n.sidecar-quick-chat-send:disabled svg {\\n  fill: rgba(11, 18, 32, 0.2);\\n}\\n\\n.sidecar-quick-chat-hint {\\n  font-size: 9px;\\n  font-weight: 400;\\n  color: rgba(91, 102, 122, 0.5);\\n  margin-top: 6px;\\n}\\n\\n.sidecar-quick-chat-response {\\n  background: #f0f9ff;\\n  border: 1px solid #bae6fd;\\n  border-radius: 8px;\\n  padding: 12px;\\n  margin-bottom: 8px;\\n  position: relative;\\n}\\n\\n.sidecar-quick-chat-response-text {\\n  font-size: 13px;\\n  color: #1e3a5f;\\n  line-height: 1.4;\\n}\\n\\n.sidecar-quick-chat-response-source {\\n  font-size: 11px;\\n  color: #6b7280;\\n  margin-top: 6px;\\n}\\n\\n.sidecar-quick-chat-response-dismiss {\\n  position: absolute;\\n  top: 8px;\\n  right: 8px;\\n  background: none;\\n  border: none;\\n  color: #9ca3af;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n/* Sidecar Menu */\\n/* Sidecar Menu - matches Mini menu styling */\\n.sidecar-menu {\\n  position: relative;\\n}\\n\\n.sidecar-menu-btn {\\n  width: 22px;\\n  height: 22px;\\n  border-radius: 6px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n  padding: 0;\\n}\\n\\n.sidecar-menu-btn svg {\\n  width: 14px;\\n  height: 14px;\\n  fill: rgba(11, 18, 32, 0.7);\\n}\\n\\n.sidecar-menu-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-menu-dropdown {\\n  position: absolute;\\n  top: 100%;\\n  right: 0;\\n  margin-top: 4px;\\n  min-width: 140px;\\n  background: #fff;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  border-radius: 10px;\\n  box-shadow: 0 8px 24px rgba(2, 6, 23, 0.12);\\n  z-index: 2147483647;\\n  overflow: visible;\\n  pointer-events: auto;\\n  padding: 4px 0;\\n}\\n\\n.sidecar-menu-item {\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  width: 100%;\\n  text-align: left;\\n  padding: 8px 12px;\\n  border: none;\\n  background: transparent;\\n  font-size: 11px;\\n  font-weight: 400;\\n  color: #0b1220;\\n  cursor: pointer;\\n  pointer-events: auto;\\n  transition: background 0.15s ease;\\n  position: relative;\\n}\\n\\n.sidecar-menu-item:hover {\\n  background: rgba(11, 18, 32, 0.04);\\n}\\n\\n.sidecar-menu-item.danger {\\n  color: #b3261e;\\n}\\n\\n.sidecar-menu-icon {\\n  width: 14px;\\n  height: 14px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  flex-shrink: 0;\\n}\\n\\n.sidecar-menu-icon svg {\\n  width: 14px;\\n  height: 14px;\\n  fill: rgba(11, 18, 32, 0.6);\\n}\\n\\n.sidecar-menu-label {\\n  flex: 1;\\n  font-size: 11px;\\n  font-weight: 400;\\n}\\n\\n.sidecar-menu-arrow {\\n  font-size: 10px;\\n  color: rgba(91, 102, 122, 0.6);\\n  margin-left: auto;\\n}\\n\\n.sidecar-menu-divider {\\n  height: 1px;\\n  background: rgba(11, 18, 32, 0.08);\\n  margin: 4px 0;\\n}\\n\\n/* Theme submenu - positioned to the left since sidecar is on right edge */\\n.sidecar-menu-submenu {\\n  position: absolute;\\n  right: 100%;\\n  left: auto;\\n  top: 0;\\n  margin-right: 4px;\\n  min-width: 100px;\\n  background: #fff;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  border-radius: 8px;\\n  box-shadow: 0 4px 12px rgba(2, 6, 23, 0.1);\\n  padding: 4px 0;\\n  z-index: 2147483648;\\n}\\n\\n.sidecar-menu-submenu-item {\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  padding: 6px 10px;\\n  font-size: 10px;\\n  font-weight: 400;\\n  color: #0b1220;\\n  cursor: pointer;\\n  transition: background 0.15s ease;\\n}\\n\\n.sidecar-menu-submenu-item:hover {\\n  background: rgba(11, 18, 32, 0.04);\\n}\\n\\n.sidecar-menu-theme-icon {\\n  font-size: 8px;\\n  color: rgba(91, 102, 122, 0.7);\\n}\\n\\n.sidecar-menu-theme-label {\\n  font-size: 10px;\\n  font-weight: 400;\\n}\\n\\n/* Toggle switch - matches Mini style */\\n.sidecar-menu-toggle {\\n  position: relative;\\n  width: 32px;\\n  height: 18px;\\n}\\n\\n.sidecar-menu-toggle-input {\\n  opacity: 0;\\n  width: 0;\\n  height: 0;\\n}\\n\\n.sidecar-menu-toggle-slider {\\n  position: absolute;\\n  cursor: pointer;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  background: rgba(11, 18, 32, 0.15);\\n  border-radius: 9px;\\n  transition: background 0.2s ease;\\n}\\n\\n.sidecar-menu-toggle-slider::before {\\n  content: '';\\n  position: absolute;\\n  height: 14px;\\n  width: 14px;\\n  left: 2px;\\n  bottom: 2px;\\n  background: white;\\n  border-radius: 50%;\\n  transition: transform 0.2s ease;\\n  box-shadow: 0 1px 3px rgba(2, 6, 23, 0.15);\\n}\\n\\n.sidecar-menu-toggle-input:checked + .sidecar-menu-toggle-slider {\\n  background: #2563eb;\\n}\\n\\n.sidecar-menu-toggle-input:checked + .sidecar-menu-toggle-slider::before {\\n  transform: translateX(14px);\\n}\\n\\n/* Collapse button - matches Mini expand/minimize buttons */\\n.sidecar-collapse-btn {\\n  width: 22px;\\n  height: 22px;\\n  border-radius: 6px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n  padding: 0;\\n}\\n\\n.sidecar-collapse-btn svg {\\n  width: 14px;\\n  height: 14px;\\n  fill: rgba(11, 18, 32, 0.7);\\n}\\n\\n.sidecar-collapse-btn:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n/* Alert Indicator */\\n/* Alert Indicator - matches Mini button styling */\\n.sidecar-alert-indicator {\\n  position: relative;\\n  width: 22px;\\n  height: 22px;\\n  border-radius: 6px;\\n  border: 1px solid rgba(11, 18, 32, 0.12);\\n  background: rgba(11, 18, 32, 0.03);\\n  cursor: pointer;\\n  display: grid;\\n  place-items: center;\\n}\\n\\n.sidecar-alert-indicator:hover {\\n  background: rgba(11, 18, 32, 0.06);\\n}\\n\\n.sidecar-alert-icon {\\n  width: 14px;\\n  height: 14px;\\n  display: inline-flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.sidecar-alert-icon svg {\\n  width: 14px;\\n  height: 14px;\\n  display: block;\\n  fill: none;\\n  stroke: rgba(11, 18, 32, 0.85);\\n  stroke-width: 1.6;\\n  stroke-linecap: round;\\n  stroke-linejoin: round;\\n}\\n\\n.sidecar-alert-badge {\\n  position: absolute;\\n  top: -4px;\\n  right: -4px;\\n  min-width: 14px;\\n  height: 14px;\\n  background: #2563eb;\\n  color: white;\\n  font-size: 9px;\\n  font-weight: 600;\\n  border-radius: 7px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  padding: 0 3px;\\n}\\n\\n.sidecar-alert-badge--high {\\n  background: #dc2626;\\n}\\n\\n.sidecar-notification-dot {\\n  width: 6px;\\n  height: 6px;\\n  background: #2563eb;\\n  border-radius: 50%;\\n}\\n\\n.sidecar-notification-dot--high {\\n  background: #dc2626;\\n}\\n\\n/* Privacy indicator - matches Mini style */\\n.sidecar-privacy-indicator {\\n  font-size: 11px;\\n  color: rgba(91, 102, 122, 0.95);\\n}\\n\\n/* ========================================\\n   SIDECAR THEMES\\n   ======================================== */\\n\\n/* Dark Theme */\\n#mobius-os-sidebar.theme-dark {\\n  background: #1a1f2e;\\n  color: #e5e7eb;\\n  border-left-color: rgba(255, 255, 255, 0.08);\\n}\\n\\n#mobius-os-sidebar.theme-dark .top-row {\\n  background: rgba(255, 255, 255, 0.02);\\n  border-bottom-color: rgba(255, 255, 255, 0.06);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-status-bar {\\n  background: #1a1f2e;\\n  border-bottom-color: rgba(255, 255, 255, 0.06);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-context {\\n  color: rgba(229, 231, 235, 0.8);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-track {\\n  background: linear-gradient(90deg, \\n    rgba(255, 255, 255, 0.06) 0%, \\n    rgba(255, 255, 255, 0.1) 50%,\\n    rgba(255, 255, 255, 0.04) 100%\\n  );\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-progress {\\n  background: rgba(255, 255, 255, 0.3);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-marker {\\n  background: #e5e7eb;\\n  border-color: #1a1f2e;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-percent {\\n  color: #e5e7eb;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-item {\\n  background: rgba(255, 255, 255, 0.04);\\n  border-color: rgba(255, 255, 255, 0.08);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-question {\\n  color: #e5e7eb;\\n}\\n\\n/* Dark theme answer buttons moved to complete dark theme section below */\\n\\n#mobius-os-sidebar.theme-dark .sidecar-menu-btn,\\n#mobius-os-sidebar.theme-dark .sidecar-collapse-btn,\\n#mobius-os-sidebar.theme-dark .sidecar-alert-indicator {\\n  background: rgba(255, 255, 255, 0.06);\\n  border-color: rgba(255, 255, 255, 0.12);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-menu-btn svg,\\n#mobius-os-sidebar.theme-dark .sidecar-collapse-btn svg,\\n#mobius-os-sidebar.theme-dark .sidecar-alert-icon svg {\\n  fill: rgba(229, 231, 235, 0.8);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-menu-dropdown,\\n#mobius-os-sidebar.theme-dark .sidecar-menu-submenu {\\n  background: #252b3b;\\n  border-color: rgba(255, 255, 255, 0.1);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-menu-item {\\n  color: #e5e7eb;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-menu-item:hover {\\n  background: rgba(255, 255, 255, 0.06);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-menu-icon svg {\\n  fill: rgba(229, 231, 235, 0.6);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat {\\n  background: rgba(255, 255, 255, 0.02);\\n  border-top-color: rgba(255, 255, 255, 0.06);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat-input {\\n  background: rgba(255, 255, 255, 0.06);\\n  border-color: rgba(255, 255, 255, 0.12);\\n  color: #e5e7eb;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat-input::placeholder {\\n  color: rgba(229, 231, 235, 0.5);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat-send {\\n  background: rgba(255, 255, 255, 0.06);\\n  border-color: rgba(255, 255, 255, 0.12);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-quick-chat-send svg {\\n  fill: rgba(229, 231, 235, 0.7);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-section-title {\\n  color: rgba(229, 231, 235, 0.7);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-toggle {\\n  color: #e5e7eb;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-toggle:hover {\\n  background: rgba(255, 255, 255, 0.04);\\n}\\n\\n/* Glass Theme */\\n#mobius-os-sidebar.theme-glass {\\n  background: rgba(255, 255, 255, 0.75);\\n  backdrop-filter: blur(20px);\\n  -webkit-backdrop-filter: blur(20px);\\n  border-left-color: rgba(255, 255, 255, 0.3);\\n}\\n\\n#mobius-os-sidebar.theme-glass .top-row {\\n  background: rgba(255, 255, 255, 0.4);\\n}\\n\\n#mobius-os-sidebar.theme-glass .sidecar-status-bar {\\n  background: rgba(255, 255, 255, 0.5);\\n}\\n\\n#mobius-os-sidebar.theme-glass .sidecar-bottleneck-item {\\n  background: rgba(255, 255, 255, 0.6);\\n  border-color: rgba(255, 255, 255, 0.4);\\n  box-shadow: 0 2px 8px rgba(2, 6, 23, 0.06);\\n}\\n\\n#mobius-os-sidebar.theme-glass .sidecar-menu-btn,\\n#mobius-os-sidebar.theme-glass .sidecar-collapse-btn,\\n#mobius-os-sidebar.theme-glass .sidecar-alert-indicator {\\n  background: rgba(255, 255, 255, 0.5);\\n  border-color: rgba(255, 255, 255, 0.4);\\n}\\n\\n#mobius-os-sidebar.theme-glass .sidecar-menu-dropdown,\\n#mobius-os-sidebar.theme-glass .sidecar-menu-submenu {\\n  background: rgba(255, 255, 255, 0.9);\\n  backdrop-filter: blur(10px);\\n  -webkit-backdrop-filter: blur(10px);\\n}\\n\\n#mobius-os-sidebar.theme-glass .sidecar-quick-chat {\\n  background: rgba(255, 255, 255, 0.4);\\n}\\n\\n#mobius-os-sidebar.theme-glass .sidecar-quick-chat-input {\\n  background: rgba(255, 255, 255, 0.7);\\n}\\n\\n/* ============================================\\n   COMPLETE DARK THEME - All Sidecar Elements\\n   ============================================ */\\n\\n/* Dark: Greeting */\\n#mobius-os-sidebar.theme-dark .sidecar-greeting {\\n  border-bottom-color: rgba(255, 255, 255, 0.08);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-greeting-text {\\n  color: #f1f5f9;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-greeting-subtext {\\n  color: rgba(148, 163, 184, 0.7);\\n}\\n\\n/* Dark: Patient Row */\\n#mobius-os-sidebar.theme-dark .sidecar-patient-row {\\n  border-bottom-color: rgba(255, 255, 255, 0.08) !important;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-patient-row label {\\n  color: rgba(148, 163, 184, 0.8);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-patient-row span {\\n  color: #f1f5f9;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-icon-btn {\\n  background: rgba(255, 255, 255, 0.06);\\n  border-color: rgba(255, 255, 255, 0.12);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-icon-btn svg {\\n  fill: rgba(229, 231, 235, 0.7);\\n}\\n\\n/* Dark: Status Bar Title */\\n#mobius-os-sidebar.theme-dark .sidecar-status-bar-title {\\n  color: rgba(148, 163, 184, 0.8);\\n}\\n\\n/* Dark: Bottleneck Header */\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-header {\\n  color: rgba(229, 231, 235, 0.8);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-count {\\n  color: #f1f5f9;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-hint {\\n  color: rgba(148, 163, 184, 0.6);\\n}\\n\\n/* Dark: Answer Buttons */\\n#mobius-os-sidebar.theme-dark .sidecar-answer-btn {\\n  background: rgba(255, 255, 255, 0.08) !important;\\n  background-color: rgba(255, 255, 255, 0.08) !important;\\n  border-color: rgba(255, 255, 255, 0.12) !important;\\n  color: rgba(229, 231, 235, 0.85) !important;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-answer-btn:hover {\\n  background: rgba(255, 255, 255, 0.12) !important;\\n  background-color: rgba(255, 255, 255, 0.12) !important;\\n  border-color: rgba(255, 255, 255, 0.18) !important;\\n  color: #f1f5f9 !important;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-answer-btn--selected,\\n#mobius-os-sidebar.theme-dark .sidecar-answer-btn.sidecar-answer-btn--selected {\\n  background: rgba(37, 99, 235, 0.25) !important;\\n  background-color: rgba(37, 99, 235, 0.25) !important;\\n  border-color: rgba(37, 99, 235, 0.4) !important;\\n  color: #93c5fd !important;\\n}\\n\\n/* Dark: Note Input */\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-note-row {\\n  border-top-color: rgba(255, 255, 255, 0.06);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-note-input {\\n  background: rgba(255, 255, 255, 0.06);\\n  border-color: rgba(255, 255, 255, 0.12);\\n  color: #f1f5f9;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-note-input::placeholder {\\n  color: rgba(148, 163, 184, 0.5);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-note-send svg {\\n  fill: rgba(229, 231, 235, 0.6);\\n}\\n\\n/* Dark: Mobius Tip */\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-mobius-tip {\\n  background: rgba(37, 99, 235, 0.15);\\n  color: #93c5fd;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-bottleneck-mobius-tip--assigned {\\n  background: rgba(34, 197, 94, 0.15);\\n  color: #86efac;\\n}\\n\\n/* Dark: Assign Button */\\n#mobius-os-sidebar.theme-dark .sidecar-assign-btn {\\n  background: rgba(37, 99, 235, 0.2);\\n  border-color: rgba(37, 99, 235, 0.4);\\n  color: #93c5fd;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-assign-btn:hover {\\n  background: rgba(37, 99, 235, 0.3);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-assign-menu {\\n  background: #252b3b;\\n  border-color: rgba(255, 255, 255, 0.1);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-assign-option {\\n  color: #e5e7eb;\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-assign-option:hover {\\n  background: rgba(255, 255, 255, 0.06);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-assign-option-hint {\\n  color: rgba(148, 163, 184, 0.6);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-assign-divider {\\n  background: rgba(255, 255, 255, 0.08);\\n}\\n\\n/* Dark: Context Expander */\\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-arrow {\\n  color: rgba(148, 163, 184, 0.6);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-label {\\n  color: rgba(148, 163, 184, 0.7);\\n}\\n\\n#mobius-os-sidebar.theme-dark .sidecar-context-expander-content {\\n  border-top-color: rgba(255, 255, 255, 0.06);\\n}\\n\\n/* Dark: Cards Container */\\n#mobius-os-sidebar.theme-dark .sidecar-cards-container {\\n  background: transparent;\\n}\\n\\n/* Dark: Brand Text */\\n#mobius-os-sidebar.theme-dark .sidecar-brand-text {\\n  color: #f1f5f9;\\n}\\n\\n/* ============================================\\n   BLUE THEME - All Sidecar Elements\\n   ============================================ */\\n\\n#mobius-os-sidebar.theme-blue {\\n  background: #eff6ff !important;\\n  color: #1e3a5f !important;\\n  border-color: rgba(37, 99, 235, 0.15) !important;\\n}\\n\\n#mobius-os-sidebar.theme-blue .top-row {\\n  background: rgba(37, 99, 235, 0.05);\\n  border-bottom-color: rgba(37, 99, 235, 0.1);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-brand-text {\\n  color: #1e40af;\\n}\\n\\n/* Blue: Greeting */\\n#mobius-os-sidebar.theme-blue .sidecar-greeting {\\n  border-bottom-color: rgba(37, 99, 235, 0.1);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-greeting-text {\\n  color: #1e3a5f;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-greeting-subtext {\\n  color: #3b82f6;\\n}\\n\\n/* Blue: Patient Row */\\n#mobius-os-sidebar.theme-blue .sidecar-patient-row {\\n  border-bottom-color: rgba(37, 99, 235, 0.1) !important;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-patient-row label {\\n  color: #3b82f6;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-icon-btn {\\n  background: rgba(37, 99, 235, 0.08);\\n  border-color: rgba(37, 99, 235, 0.2);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-icon-btn svg {\\n  fill: #3b82f6;\\n}\\n\\n/* Blue: Status Bar */\\n#mobius-os-sidebar.theme-blue .sidecar-status-bar {\\n  background: rgba(37, 99, 235, 0.03);\\n  border-bottom-color: rgba(37, 99, 235, 0.1);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-title {\\n  color: #3b82f6;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-context {\\n  color: #1e40af;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-track {\\n  background: linear-gradient(90deg, \\n    rgba(37, 99, 235, 0.08) 0%, \\n    rgba(37, 99, 235, 0.15) 50%, \\n    rgba(37, 99, 235, 0.2) 100%);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-progress {\\n  background: rgba(37, 99, 235, 0.5);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-marker {\\n  background: #2563eb;\\n  border-color: #eff6ff;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-status-bar-percent {\\n  color: #1e40af;\\n}\\n\\n/* Blue: Bottleneck Card */\\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-item {\\n  background: rgba(255, 255, 255, 0.7);\\n  border-color: rgba(37, 99, 235, 0.15);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-question {\\n  color: #1e3a5f;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-count {\\n  color: #1e40af;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-hint {\\n  color: #3b82f6;\\n}\\n\\n/* Blue: Answer Buttons */\\n#mobius-os-sidebar.theme-blue .sidecar-answer-btn {\\n  background: rgba(37, 99, 235, 0.08) !important;\\n  background-color: rgba(37, 99, 235, 0.08) !important;\\n  border-color: rgba(37, 99, 235, 0.15) !important;\\n  color: #3b82f6 !important;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-answer-btn:hover {\\n  background: rgba(37, 99, 235, 0.12) !important;\\n  background-color: rgba(37, 99, 235, 0.12) !important;\\n  border-color: rgba(37, 99, 235, 0.25) !important;\\n  color: #1e40af !important;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-answer-btn--selected,\\n#mobius-os-sidebar.theme-blue .sidecar-answer-btn.sidecar-answer-btn--selected {\\n  background: rgba(37, 99, 235, 0.2) !important;\\n  background-color: rgba(37, 99, 235, 0.2) !important;\\n  border-color: rgba(37, 99, 235, 0.4) !important;\\n  color: #1d4ed8 !important;\\n}\\n\\n/* Blue: Note Input */\\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-note-row {\\n  border-top-color: rgba(37, 99, 235, 0.1);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-note-input {\\n  background: #ffffff;\\n  border-color: #bfdbfe;\\n}\\n\\n/* Blue: Mobius Tip */\\n#mobius-os-sidebar.theme-blue .sidecar-bottleneck-mobius-tip {\\n  background: rgba(37, 99, 235, 0.1);\\n  color: #1e40af;\\n}\\n\\n/* Blue: Assign Button */\\n#mobius-os-sidebar.theme-blue .sidecar-assign-btn {\\n  background: #2563eb;\\n  border-color: #1d4ed8;\\n  color: #ffffff;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-assign-btn:hover {\\n  background: #1d4ed8;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-assign-menu {\\n  background: #ffffff;\\n  border-color: rgba(37, 99, 235, 0.2);\\n}\\n\\n/* Blue: Context Expander */\\n#mobius-os-sidebar.theme-blue .sidecar-context-expander-toggle:hover {\\n  background: rgba(37, 99, 235, 0.06);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-context-expander-arrow {\\n  color: #3b82f6;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-context-expander-label {\\n  color: #3b82f6;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-context-expander-content {\\n  border-top-color: rgba(37, 99, 235, 0.1);\\n}\\n\\n/* Blue: Menu */\\n#mobius-os-sidebar.theme-blue .sidecar-menu-btn,\\n#mobius-os-sidebar.theme-blue .sidecar-collapse-btn,\\n#mobius-os-sidebar.theme-blue .sidecar-alert-indicator {\\n  background: rgba(37, 99, 235, 0.08);\\n  border-color: rgba(37, 99, 235, 0.2);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-menu-btn svg,\\n#mobius-os-sidebar.theme-blue .sidecar-collapse-btn svg,\\n#mobius-os-sidebar.theme-blue .sidecar-alert-icon svg {\\n  fill: #3b82f6;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-menu-dropdown,\\n#mobius-os-sidebar.theme-blue .sidecar-menu-submenu {\\n  background: #ffffff;\\n  border-color: rgba(37, 99, 235, 0.15);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-menu-item {\\n  color: #1e3a5f;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-menu-item:hover {\\n  background: rgba(37, 99, 235, 0.08);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-menu-icon svg {\\n  fill: #3b82f6;\\n}\\n\\n/* Blue: Quick Chat */\\n#mobius-os-sidebar.theme-blue .sidecar-quick-chat {\\n  background: rgba(255, 255, 255, 0.7);\\n  border-top-color: rgba(37, 99, 235, 0.1);\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-quick-chat-input {\\n  background: #ffffff;\\n  border-color: #bfdbfe;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-quick-chat-input:focus {\\n  border-color: #3b82f6;\\n}\\n\\n#mobius-os-sidebar.theme-blue .sidecar-quick-chat-send svg {\\n  fill: #3b82f6;\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\nmodule.exports = insertStyleElement;","\"use strict\";\n\nvar memo = {};\n\n/* istanbul ignore next  */\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target);\n\n    // Special case to return head of iframe instead of iframe itself\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n    memo[target] = styleTarget;\n  }\n  return memo[target];\n}\n\n/* istanbul ignore next  */\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n  target.appendChild(style);\n}\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n  var needLayer = typeof obj.layer !== \"undefined\";\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n  css += obj.css;\n  if (needLayer) {\n    css += \"}\";\n  }\n  if (obj.media) {\n    css += \"}\";\n  }\n  if (obj.supports) {\n    css += \"}\";\n  }\n  var sourceMap = obj.sourceMap;\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  }\n\n  // For old IE\n  /* istanbul ignore if  */\n  options.styleTagTransform(css, styleElement, options.options);\n}\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n  styleElement.parentNode.removeChild(styleElement);\n}\n\n/* istanbul ignore next  */\nfunction domAPI(options) {\n  if (typeof document === \"undefined\") {\n    return {\n      update: function update() {},\n      remove: function remove() {}\n    };\n  }\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\nmodule.exports = domAPI;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.nc = undefined;","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./sidebar.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./sidebar.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\n * Mobius OS Extension Configuration\n *\n * Toggle PRODUCTION to switch between dev and production servers.\n */\n// Set to true for production build, false for local development\nexport const PRODUCTION = false;\n// API Base URLs\nconst DEV_API_BASE = 'http://localhost:5001';\nconst PROD_API_BASE = 'https://mobius-os-backend-mc2ivyhdxq-uc.a.run.app';\n// Export the active API base URL\nexport const API_BASE_URL = PRODUCTION ? PROD_API_BASE : DEV_API_BASE;\nexport const API_V1_URL = `${API_BASE_URL}/api/v1`;\n","/**\n * Session management utilities\n */\nconst SESSION_STORAGE_KEY = 'current_session_id';\n/**\n * Generate a new session ID (UUID v4)\n */\nexport function generateSessionId() {\n    return 'session_' + crypto.randomUUID();\n}\n/**\n * Get current session ID from storage, or generate a new one\n */\nexport async function getOrCreateSessionId() {\n    return new Promise((resolve) => {\n        chrome.storage.local.get([SESSION_STORAGE_KEY], (result) => {\n            if (result[SESSION_STORAGE_KEY]) {\n                resolve(result[SESSION_STORAGE_KEY]);\n            }\n            else {\n                const newSessionId = generateSessionId();\n                chrome.storage.local.set({ [SESSION_STORAGE_KEY]: newSessionId }, () => {\n                    resolve(newSessionId);\n                });\n            }\n        });\n    });\n}\n/**\n * Get current session ID (synchronous check)\n */\nexport async function getSessionId() {\n    return new Promise((resolve) => {\n        chrome.storage.local.get([SESSION_STORAGE_KEY], (result) => {\n            resolve(result[SESSION_STORAGE_KEY] || null);\n        });\n    });\n}\n","/**\n * Authentication Service for User Awareness Sprint\n *\n * Handles:\n * - Email/password login and registration\n * - Token storage in chrome.storage.session\n * - Token refresh\n * - Current user state management\n */\nimport { API_V1_URL } from '../config';\nconst API_BASE = API_V1_URL;\nconst STORAGE_KEYS = {\n    accessToken: 'mobius.auth.accessToken',\n    refreshToken: 'mobius.auth.refreshToken',\n    expiresAt: 'mobius.auth.expiresAt',\n    userProfile: 'mobius.auth.userProfile',\n};\n/**\n * Authentication Service\n */\nclass AuthService {\n    constructor() {\n        this.listeners = new Set();\n        this.refreshTimer = null;\n    }\n    /**\n     * Subscribe to auth events\n     */\n    on(callback) {\n        this.listeners.add(callback);\n        return () => this.listeners.delete(callback);\n    }\n    /**\n     * Emit an auth event\n     */\n    emit(event, data) {\n        this.listeners.forEach(callback => {\n            try {\n                callback(event, data);\n            }\n            catch (error) {\n                console.error('[AuthService] Error in event listener:', error);\n            }\n        });\n    }\n    // ===========================================================================\n    // Storage Helpers (via background script for content script compatibility)\n    // ===========================================================================\n    /**\n     * Get items from session storage via background script\n     */\n    async storageGet(keys) {\n        return new Promise((resolve) => {\n            chrome.runtime.sendMessage({ type: 'mobius:auth:getStorage', keys }, (response) => {\n                if (chrome.runtime.lastError) {\n                    console.error('[AuthService] Storage get error:', chrome.runtime.lastError);\n                    resolve({});\n                    return;\n                }\n                resolve(response?.ok ? response.data : {});\n            });\n        });\n    }\n    /**\n     * Set items in session storage via background script\n     */\n    async storageSet(items) {\n        return new Promise((resolve) => {\n            chrome.runtime.sendMessage({ type: 'mobius:auth:setStorage', items }, (response) => {\n                if (chrome.runtime.lastError) {\n                    console.error('[AuthService] Storage set error:', chrome.runtime.lastError);\n                }\n                resolve();\n            });\n        });\n    }\n    /**\n     * Clear items from session storage via background script\n     */\n    async storageClear(keys) {\n        return new Promise((resolve) => {\n            chrome.runtime.sendMessage({ type: 'mobius:auth:clearStorage', keys }, (response) => {\n                if (chrome.runtime.lastError) {\n                    console.error('[AuthService] Storage clear error:', chrome.runtime.lastError);\n                }\n                resolve();\n            });\n        });\n    }\n    // ===========================================================================\n    // Token Storage\n    // ===========================================================================\n    /**\n     * Store auth tokens in chrome.storage.session\n     */\n    async storeTokens(tokens) {\n        const expiresAt = Date.now() + (tokens.expires_in * 1000);\n        await this.storageSet({\n            [STORAGE_KEYS.accessToken]: tokens.access_token,\n            [STORAGE_KEYS.refreshToken]: tokens.refresh_token,\n            [STORAGE_KEYS.expiresAt]: expiresAt,\n        });\n        // Schedule token refresh\n        this.scheduleTokenRefresh(tokens.expires_in);\n        console.log('[AuthService] Tokens stored, expires at:', new Date(expiresAt).toISOString());\n    }\n    /**\n     * Get stored access token\n     *\n     * If no access token exists (e.g., browser was restarted), attempts to\n     * refresh using the persistent refresh token from local storage.\n     */\n    async getAccessToken() {\n        try {\n            const result = await this.storageGet([\n                STORAGE_KEYS.accessToken,\n                STORAGE_KEYS.expiresAt,\n            ]);\n            const token = result[STORAGE_KEYS.accessToken];\n            const expiresAt = result[STORAGE_KEYS.expiresAt];\n            // No access token - try to restore from refresh token\n            if (!token) {\n                console.log('[AuthService] No access token, attempting restore from refresh token...');\n                const refreshToken = await this.getRefreshToken();\n                if (refreshToken) {\n                    const refreshed = await this.refreshAccessToken();\n                    if (refreshed) {\n                        // Recursively get the new token\n                        return this.getAccessToken();\n                    }\n                }\n                return null;\n            }\n            // Check if expired (with 60 second buffer)\n            if (expiresAt && Date.now() > expiresAt - 60000) {\n                console.log('[AuthService] Token expired, attempting refresh...');\n                const refreshed = await this.refreshAccessToken();\n                return refreshed ? await this.getAccessToken() : null;\n            }\n            return token;\n        }\n        catch (error) {\n            console.error('[AuthService] Error getting access token:', error);\n            return null;\n        }\n    }\n    /**\n     * Get stored refresh token\n     */\n    async getRefreshToken() {\n        try {\n            const result = await this.storageGet([STORAGE_KEYS.refreshToken]);\n            return result[STORAGE_KEYS.refreshToken] || null;\n        }\n        catch (error) {\n            console.error('[AuthService] Error getting refresh token:', error);\n            return null;\n        }\n    }\n    /**\n     * Clear all stored tokens\n     */\n    async clearTokens() {\n        await this.storageClear([\n            STORAGE_KEYS.accessToken,\n            STORAGE_KEYS.refreshToken,\n            STORAGE_KEYS.expiresAt,\n            STORAGE_KEYS.userProfile,\n        ]);\n        if (this.refreshTimer) {\n            clearTimeout(this.refreshTimer);\n            this.refreshTimer = null;\n        }\n        console.log('[AuthService] Tokens cleared');\n    }\n    /**\n     * Store user profile\n     */\n    async storeUserProfile(profile) {\n        await this.storageSet({\n            [STORAGE_KEYS.userProfile]: profile,\n        });\n    }\n    /**\n     * Get stored user profile\n     */\n    async getUserProfile() {\n        try {\n            const result = await this.storageGet([STORAGE_KEYS.userProfile]);\n            return result[STORAGE_KEYS.userProfile] || null;\n        }\n        catch (error) {\n            console.error('[AuthService] Error getting user profile:', error);\n            return null;\n        }\n    }\n    // ===========================================================================\n    // Token Refresh\n    // ===========================================================================\n    /**\n     * Schedule automatic token refresh\n     */\n    scheduleTokenRefresh(expiresIn) {\n        if (this.refreshTimer) {\n            clearTimeout(this.refreshTimer);\n        }\n        // Refresh 5 minutes before expiry\n        const refreshIn = Math.max((expiresIn - 300) * 1000, 60000);\n        this.refreshTimer = window.setTimeout(async () => {\n            console.log('[AuthService] Auto-refreshing token...');\n            await this.refreshAccessToken();\n        }, refreshIn);\n    }\n    /**\n     * Refresh the access token\n     */\n    async refreshAccessToken() {\n        const refreshToken = await this.getRefreshToken();\n        if (!refreshToken) {\n            console.log('[AuthService] No refresh token available');\n            return false;\n        }\n        try {\n            const response = await fetch(`${API_BASE}/auth/refresh`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ refresh_token: refreshToken }),\n            });\n            if (!response.ok) {\n                console.error('[AuthService] Token refresh failed');\n                await this.clearTokens();\n                return false;\n            }\n            const data = await response.json();\n            // Store new access token (keep existing refresh token)\n            const expiresAt = Date.now() + (data.expires_in * 1000);\n            await chrome.storage.session.set({\n                [STORAGE_KEYS.accessToken]: data.access_token,\n                [STORAGE_KEYS.expiresAt]: expiresAt,\n            });\n            this.scheduleTokenRefresh(data.expires_in);\n            this.emit('tokenRefreshed');\n            console.log('[AuthService] Token refreshed successfully');\n            return true;\n        }\n        catch (error) {\n            console.error('[AuthService] Token refresh error:', error);\n            return false;\n        }\n    }\n    // ===========================================================================\n    // Authentication\n    // ===========================================================================\n    /**\n     * Login with email and password\n     */\n    async login(email, password, tenantId) {\n        try {\n            const response = await fetch(`${API_BASE}/auth/login`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    email,\n                    password,\n                    tenant_id: tenantId,\n                }),\n            });\n            const data = await response.json();\n            if (!response.ok || !data.ok) {\n                return { success: false, error: data.error || 'Login failed' };\n            }\n            // Store tokens\n            await this.storeTokens({\n                access_token: data.access_token,\n                refresh_token: data.refresh_token,\n                expires_in: data.expires_in,\n            });\n            // Store user profile with transformed activities\n            let profile;\n            if (data.user) {\n                const user = data.user;\n                const pref = user.preference || {};\n                profile = {\n                    user_id: user.user_id,\n                    tenant_id: user.tenant_id || '',\n                    email: user.email,\n                    display_name: user.display_name,\n                    first_name: user.first_name,\n                    preferred_name: user.preferred_name,\n                    greeting_name: user.preferred_name || user.first_name || user.display_name,\n                    timezone: user.timezone || 'America/New_York',\n                    locale: user.locale || 'en-US',\n                    is_onboarded: user.is_onboarded || false,\n                    // Transform activities from [{activity_code: '...'}] to string[]\n                    activities: (user.activities || []).map((a) => a.activity_code),\n                    tone: pref.tone || 'professional',\n                    greeting_enabled: pref.greeting_enabled !== false,\n                    autonomy_routine_tasks: pref.autonomy_routine_tasks || 'confirm_first',\n                    autonomy_sensitive_tasks: pref.autonomy_sensitive_tasks || 'manual',\n                };\n                await this.storeUserProfile(profile);\n            }\n            this.emit('login', profile);\n            return { success: true, user: profile };\n        }\n        catch (error) {\n            console.error('[AuthService] Login error:', error);\n            return { success: false, error: 'Network error' };\n        }\n    }\n    /**\n     * Register a new account\n     */\n    async register(email, password, displayName, firstName, tenantId) {\n        try {\n            const response = await fetch(`${API_BASE}/auth/register`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    email,\n                    password,\n                    display_name: displayName,\n                    first_name: firstName,\n                    tenant_id: tenantId,\n                }),\n            });\n            const data = await response.json();\n            if (!response.ok || !data.ok) {\n                return { success: false, error: data.error || 'Registration failed' };\n            }\n            // Store tokens (auto-login after registration)\n            await this.storeTokens({\n                access_token: data.access_token,\n                refresh_token: data.refresh_token,\n                expires_in: data.expires_in,\n            });\n            // Store user profile with transformed activities\n            let profile;\n            if (data.user) {\n                const user = data.user;\n                const pref = user.preference || {};\n                profile = {\n                    user_id: user.user_id,\n                    tenant_id: user.tenant_id || '',\n                    email: user.email,\n                    display_name: user.display_name,\n                    first_name: user.first_name,\n                    preferred_name: user.preferred_name,\n                    greeting_name: user.preferred_name || user.first_name || user.display_name,\n                    timezone: user.timezone || 'America/New_York',\n                    locale: user.locale || 'en-US',\n                    is_onboarded: user.is_onboarded || false,\n                    // Transform activities from [{activity_code: '...'}] to string[]\n                    activities: (user.activities || []).map((a) => a.activity_code),\n                    tone: pref.tone || 'professional',\n                    greeting_enabled: pref.greeting_enabled !== false,\n                    autonomy_routine_tasks: pref.autonomy_routine_tasks || 'confirm_first',\n                    autonomy_sensitive_tasks: pref.autonomy_sensitive_tasks || 'manual',\n                };\n                await this.storeUserProfile(profile);\n            }\n            this.emit('login', profile);\n            return { success: true, user: profile };\n        }\n        catch (error) {\n            console.error('[AuthService] Registration error:', error);\n            return { success: false, error: 'Network error' };\n        }\n    }\n    /**\n     * Logout\n     */\n    async logout() {\n        const refreshToken = await this.getRefreshToken();\n        // Call backend to invalidate session\n        if (refreshToken) {\n            try {\n                await fetch(`${API_BASE}/auth/logout`, {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({ refresh_token: refreshToken }),\n                });\n            }\n            catch (error) {\n                console.warn('[AuthService] Logout API call failed:', error);\n            }\n        }\n        await this.clearTokens();\n        this.emit('logout');\n    }\n    /**\n     * Get current user from backend\n     */\n    async getCurrentUser() {\n        const token = await this.getAccessToken();\n        if (!token) {\n            return null;\n        }\n        try {\n            const response = await fetch(`${API_BASE}/auth/me`, {\n                method: 'GET',\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                    'Content-Type': 'application/json',\n                },\n            });\n            if (!response.ok) {\n                return null;\n            }\n            const data = await response.json();\n            if (data.ok && data.user) {\n                // Flatten nested preference into user profile\n                const user = data.user;\n                const pref = user.preference || {};\n                const profile = {\n                    user_id: user.user_id,\n                    tenant_id: user.tenant_id,\n                    email: user.email,\n                    display_name: user.display_name,\n                    first_name: user.first_name,\n                    preferred_name: user.preferred_name,\n                    greeting_name: user.preferred_name || user.first_name || user.display_name || 'there',\n                    avatar_url: user.avatar_url,\n                    timezone: user.timezone || 'America/New_York',\n                    locale: user.locale || 'en-US',\n                    is_onboarded: user.is_onboarded || false,\n                    activities: (user.activities || []).map((a) => a.activity_code),\n                    tone: pref.tone || 'professional',\n                    greeting_enabled: pref.greeting_enabled !== false,\n                    autonomy_routine_tasks: pref.autonomy_routine_tasks || 'confirm_first',\n                    autonomy_sensitive_tasks: pref.autonomy_sensitive_tasks || 'manual',\n                };\n                await this.storeUserProfile(profile);\n                return profile;\n            }\n            return null;\n        }\n        catch (error) {\n            console.error('[AuthService] Error fetching current user:', error);\n            return null;\n        }\n    }\n    /**\n     * Check if user is authenticated\n     */\n    async isAuthenticated() {\n        const token = await this.getAccessToken();\n        return token !== null;\n    }\n    /**\n     * Get auth state\n     */\n    async getAuthState() {\n        const token = await this.getAccessToken();\n        if (!token) {\n            return 'unauthenticated';\n        }\n        const profile = await this.getUserProfile();\n        if (profile && !profile.is_onboarded) {\n            return 'onboarding';\n        }\n        return 'authenticated';\n    }\n    /**\n     * Check if email exists in system (for page detection)\n     */\n    async checkEmail(email, tenantId) {\n        try {\n            const response = await fetch(`${API_BASE}/auth/check-email`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ email, tenant_id: tenantId }),\n            });\n            const data = await response.json();\n            return {\n                exists: data.exists === true,\n                user: data.user,\n            };\n        }\n        catch (error) {\n            console.error('[AuthService] Error checking email:', error);\n            return { exists: false };\n        }\n    }\n}\n// Singleton instance\nlet _authService = null;\nexport function getAuthService() {\n    if (!_authService) {\n        _authService = new AuthService();\n    }\n    return _authService;\n}\n/**\n * Get Authorization header for API calls.\n * Returns the header object or null if not authenticated.\n */\nexport async function getAuthHeader() {\n    const authService = getAuthService();\n    const token = await authService.getAccessToken();\n    if (!token) {\n        return null;\n    }\n    return { Authorization: `Bearer ${token}` };\n}\nexport { AuthService };\n","/**\n * API service for backend communication.\n *\n * Separate paths for Mini vs Sidecar (PRD surface separation),\n * both referencing the same underlying patient state.\n */\nimport { getAuthService } from './auth';\nimport { API_V1_URL } from '../config';\nconst API_BASE_URL = API_V1_URL;\n// =============================================================================\n// Authenticated Fetch Helper\n// =============================================================================\n/**\n * Make an authenticated API request.\n * Automatically adds Authorization header if user is logged in.\n */\nasync function authenticatedFetch(url, options = {}) {\n    const authService = getAuthService();\n    const token = await authService.getAccessToken();\n    const headers = new Headers(options.headers);\n    headers.set('Content-Type', 'application/json');\n    if (token) {\n        headers.set('Authorization', `Bearer ${token}`);\n    }\n    return fetch(url, {\n        ...options,\n        headers,\n    });\n}\n// =============================================================================\n// Chat Mode (existing)\n// =============================================================================\n/**\n * Send a chat message to the backend.\n */\nexport async function sendChatMessage(message, sessionId) {\n    const response = await fetch(`${API_BASE_URL}/modes/chat/message`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ message, session_id: sessionId }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to send message');\n    }\n    return response.json();\n}\nexport async function fetchMiniStatus(sessionId, patientKey) {\n    // Use authenticated fetch to include user context\n    const response = await authenticatedFetch(`${API_BASE_URL}/mini/status`, {\n        method: 'POST',\n        body: JSON.stringify({ session_id: sessionId, patient_key: patientKey }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to fetch mini status');\n    }\n    return response.json();\n}\n/**\n * Submit acknowledgement from Mini (Send action).\n */\nexport async function submitMiniAck(sessionId, note, options) {\n    const response = await fetch(`${API_BASE_URL}/mini/ack`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n            session_id: sessionId,\n            note,\n            patient_key: options?.patientKey,\n            override_proceed: options?.overrideProceed,\n            override_tasking: options?.overrideTasking,\n            attention_status: options?.attentionStatus,\n        }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to submit acknowledgement');\n    }\n    return response.json();\n}\n/**\n * Submit attention status change from Mini (workflow action).\n * This is a valid acknowledgement even without a note.\n */\nexport async function submitAttentionStatus(sessionId, patientKey, attentionStatus) {\n    const response = await fetch(`${API_BASE_URL}/mini/ack`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n            session_id: sessionId,\n            patient_key: patientKey,\n            attention_status: attentionStatus,\n        }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to update attention status');\n    }\n    return response.json();\n}\n/**\n * Report a new issue from Mini widget.\n * Creates a UserReportedIssue for batch job processing.\n */\nexport async function reportIssue(sessionId, patientKey, issueText) {\n    const response = await fetch(`${API_BASE_URL}/mini/issue`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n            session_id: sessionId,\n            patient_key: patientKey,\n            issue_text: issueText,\n        }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to report issue');\n    }\n    return response.json();\n}\n/**\n * Submit a note from Mini with optional resolution plan context.\n */\nexport async function submitMiniNote(sessionId, note, patient, planContext) {\n    // Use authenticatedFetch to include auth token\n    const response = await authenticatedFetch(`${API_BASE_URL}/mini/ack`, {\n        method: 'POST',\n        body: JSON.stringify({\n            session_id: sessionId,\n            note,\n            patient_key: patient?.id || '',\n            // Include plan context so notes are linked to the workflow\n            resolution_plan_id: planContext?.resolution_plan_id,\n            plan_step_id: planContext?.plan_step_id,\n        }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to submit note');\n    }\n    return response.json();\n}\nexport async function searchMiniPatients(query, limit = 8) {\n    const q = (query || '').trim();\n    const url = new URL(`${API_BASE_URL}/mini/patient/search`);\n    url.searchParams.set('q', q);\n    url.searchParams.set('limit', String(limit));\n    const response = await fetch(url.toString(), { method: 'GET' });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to search patients');\n    }\n    return response.json();\n}\n/**\n * Get full patient state for Sidecar.\n */\nexport async function fetchSidecarState(sessionId, patientKey) {\n    const response = await fetch(`${API_BASE_URL}/sidecar/state`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ session_id: sessionId, patient_key: patientKey }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to fetch sidecar state');\n    }\n    return response.json();\n}\n/**\n * Submit acknowledgement from Sidecar (Send action).\n */\nexport async function submitSidecarAck(sessionId, note, options) {\n    const response = await fetch(`${API_BASE_URL}/sidecar/ack`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n            session_id: sessionId,\n            note,\n            patient_key: options?.patientKey,\n            override_proceed: options?.overrideProceed,\n            override_tasking: options?.overrideTasking,\n        }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to submit acknowledgement');\n    }\n    return response.json();\n}\n/**\n * Get event history for Sidecar.\n */\nexport async function fetchSidecarHistory(sessionId, patientKey, limit = 50) {\n    const response = await fetch(`${API_BASE_URL}/sidecar/history`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ session_id: sessionId, patient_key: patientKey, limit }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to fetch history');\n    }\n    return response.json();\n}\n/**\n * Get user inbox (open assignments) for Sidecar.\n */\nexport async function fetchSidecarInbox(sessionId, userId) {\n    const response = await fetch(`${API_BASE_URL}/sidecar/inbox`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ session_id: sessionId, user_id: userId }),\n    });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to fetch inbox');\n    }\n    return response.json();\n}\n// =============================================================================\n// Context Detection (/api/v1/context/*)\n// =============================================================================\n/**\n * Resolve a detected patient identifier to internal Mobius context.\n *\n * This is called by the PatientContextDetector when it detects a potential\n * patient identifier on the current webpage.\n *\n * @param detected - The detected patient identifier from the webpage\n * @param tenantId - Optional tenant ID\n * @returns Resolved patient context with internal IDs and display info\n */\nexport async function resolvePatientContext(detected, tenantId) {\n    const domain = window.location.hostname;\n    const requestBody = {\n        id_type: detected.id_type,\n        id_value: detected.id_value,\n        source_hint: detected.source_hint,\n        domain,\n        tenant_id: tenantId,\n    };\n    try {\n        const response = await fetch(`${API_BASE_URL}/context/detect`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(requestBody),\n        });\n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(error.error || 'Failed to resolve patient context');\n        }\n        const data = await response.json();\n        return {\n            found: data.found,\n            detected,\n            patient_context_id: data.patient_context_id,\n            patient_key: data.patient_key,\n            display_name: data.display_name,\n            id_masked: data.id_masked,\n        };\n    }\n    catch (error) {\n        console.error('[API] Error resolving patient context:', error);\n        return {\n            found: false,\n            detected,\n        };\n    }\n}\n/**\n * Get tenant-specific detection configuration for a domain.\n *\n * This allows tenants to customize detection patterns for their specific\n * EMR systems or custom implementations.\n *\n * @param domain - The domain to get configuration for\n * @param tenantId - Optional tenant ID\n * @returns Pattern configuration or null if no custom config exists\n */\nexport async function fetchDetectionConfig(domain, tenantId) {\n    const url = new URL(`${API_BASE_URL}/context/config`);\n    url.searchParams.set('domain', domain);\n    if (tenantId) {\n        url.searchParams.set('tenant_id', tenantId);\n    }\n    try {\n        const response = await fetch(url.toString(), { method: 'GET' });\n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(error.error || 'Failed to fetch detection config');\n        }\n        const data = await response.json();\n        return data.has_config ? data.patterns : null;\n    }\n    catch (error) {\n        console.error('[API] Error fetching detection config:', error);\n        return null;\n    }\n}\n/**\n * Simple patient lookup by ID type and value.\n *\n * @param idType - Type of identifier (mrn, insurance, patient_key, etc.)\n * @param idValue - The identifier value\n * @param tenantId - Optional tenant ID\n * @returns Context detection response\n */\nexport async function lookupPatientById(idType, idValue, tenantId) {\n    const url = new URL(`${API_BASE_URL}/context/lookup`);\n    url.searchParams.set('id_type', idType);\n    url.searchParams.set('id_value', idValue);\n    if (tenantId) {\n        url.searchParams.set('tenant_id', tenantId);\n    }\n    const response = await fetch(url.toString(), { method: 'GET' });\n    if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to lookup patient');\n    }\n    return response.json();\n}\n","/**\n * ClientLogo Component\n * Displays client/customer logo and name\n */\n/**\n * Aspire Health FL logo as inline SVG (teal/cyan healthcare brand)\n * Used for CMHC (Community Mental Health Center) in Florida\n */\nconst ASPIRE_HEALTH_LOGO_SVG = `\n<svg viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n  <rect width=\"32\" height=\"32\" rx=\"6\" fill=\"#0891b2\"/>\n  <path d=\"M16 6L22 18H10L16 6Z\" fill=\"white\" opacity=\"0.9\"/>\n  <circle cx=\"16\" cy=\"22\" r=\"4\" fill=\"white\" opacity=\"0.9\"/>\n  <path d=\"M8 24C8 20 11 17 16 17C21 17 24 20 24 24\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" opacity=\"0.6\"/>\n</svg>\n`;\n/**\n * Known client logos mapping (client name -> SVG or URL)\n */\nconst CLIENT_LOGOS = {\n    'CMHC': ASPIRE_HEALTH_LOGO_SVG,\n    'Aspire Health': ASPIRE_HEALTH_LOGO_SVG,\n    'Aspire Health FL': ASPIRE_HEALTH_LOGO_SVG,\n};\n/**\n * Client display names (internal name -> display name)\n */\nconst CLIENT_DISPLAY_NAMES = {\n    'CMHC': 'Aspire Health FL',\n};\nexport function ClientLogo({ logoUrl, clientName, compact = false }) {\n    const container = document.createElement('div');\n    container.className = compact ? 'client-logo client-logo-compact' : 'client-logo';\n    // Determine display name (may differ from internal clientName)\n    const displayName = CLIENT_DISPLAY_NAMES[clientName] || clientName;\n    // Check for known client logo\n    const knownLogo = CLIENT_LOGOS[clientName];\n    if (logoUrl) {\n        // External logo URL provided\n        const img = document.createElement('img');\n        img.src = logoUrl;\n        img.alt = displayName;\n        container.appendChild(img);\n    }\n    else if (knownLogo && knownLogo.trim().startsWith('<svg')) {\n        // Inline SVG logo - create properly sized wrapper\n        const logoWrapper = document.createElement('div');\n        logoWrapper.className = 'client-logo-svg';\n        // Set explicit inline styles to ensure visibility\n        const size = compact ? '18px' : '24px';\n        logoWrapper.style.cssText = `width: ${size}; height: ${size}; flex-shrink: 0; display: flex; align-items: center; justify-content: center;`;\n        logoWrapper.innerHTML = knownLogo.trim();\n        // Ensure SVG fills the wrapper\n        const svg = logoWrapper.querySelector('svg');\n        if (svg) {\n            svg.style.cssText = 'width: 100%; height: 100%; display: block;';\n        }\n        container.appendChild(logoWrapper);\n    }\n    else if (knownLogo) {\n        // URL to logo\n        const img = document.createElement('img');\n        img.src = knownLogo;\n        img.alt = displayName;\n        container.appendChild(img);\n    }\n    else {\n        // Fallback: placeholder with initials\n        const placeholder = document.createElement('div');\n        placeholder.className = 'client-logo-placeholder';\n        const initials = displayName\n            .split(/\\s+/)\n            .filter(Boolean)\n            .map((w) => w[0]?.toUpperCase())\n            .join('')\n            .slice(0, 3);\n        placeholder.textContent = initials || displayName.slice(0, 1).toUpperCase();\n        container.appendChild(placeholder);\n    }\n    // Add client name text (hide on compact mode to save space)\n    if (!compact) {\n        const name = document.createElement('span');\n        name.className = 'client-name';\n        name.textContent = displayName;\n        container.appendChild(name);\n    }\n    return container;\n}\n","/**\n * MobiusLogo Component\n * Animated infinity symbol logo with status indication\n */\nexport function MobiusLogo({ status, size = 32 }) {\n    const uid = typeof crypto !== 'undefined' && typeof crypto.randomUUID === 'function'\n        ? crypto.randomUUID()\n        : String(Math.random()).slice(2);\n    const normalId = `infinityGradNormal_${uid}`;\n    const processingId = `infinityGradProcessing_${uid}`;\n    const container = document.createElement('div');\n    container.className = `mobius-logo status-${status}`;\n    container.style.cssText = `width: ${size}px; height: ${size}px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;`;\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    svg.setAttribute('viewBox', '0 0 100 100');\n    svg.setAttribute('width', size.toString());\n    svg.setAttribute('height', size.toString());\n    const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');\n    // Normal gradient (grey to white)\n    const normalGrad = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');\n    normalGrad.setAttribute('id', normalId);\n    normalGrad.setAttribute('x1', '0%');\n    normalGrad.setAttribute('y1', '50%');\n    normalGrad.setAttribute('x2', '100%');\n    normalGrad.setAttribute('y2', '50%');\n    const stop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');\n    stop1.setAttribute('offset', '0%');\n    stop1.setAttribute('style', 'stop-color:#666;stop-opacity:1');\n    normalGrad.appendChild(stop1);\n    const stop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');\n    stop2.setAttribute('offset', '50%');\n    stop2.setAttribute('style', 'stop-color:#ffffff;stop-opacity:1');\n    normalGrad.appendChild(stop2);\n    const stop3 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');\n    stop3.setAttribute('offset', '100%');\n    stop3.setAttribute('style', 'stop-color:#666;stop-opacity:1');\n    normalGrad.appendChild(stop3);\n    defs.appendChild(normalGrad);\n    // Processing gradient (animated)\n    const processingGrad = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');\n    processingGrad.setAttribute('id', processingId);\n    processingGrad.setAttribute('x1', '0%');\n    processingGrad.setAttribute('y1', '50%');\n    processingGrad.setAttribute('x2', '100%');\n    processingGrad.setAttribute('y2', '50%');\n    const procStop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');\n    procStop1.setAttribute('offset', '0%');\n    procStop1.setAttribute('style', 'stop-color:#666;stop-opacity:1');\n    const animate1 = document.createElementNS('http://www.w3.org/2000/svg', 'animate');\n    animate1.setAttribute('attributeName', 'stop-color');\n    animate1.setAttribute('values', '#666;#ffffff;#666');\n    animate1.setAttribute('dur', '2s');\n    animate1.setAttribute('repeatCount', 'indefinite');\n    procStop1.appendChild(animate1);\n    processingGrad.appendChild(procStop1);\n    const procStop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');\n    procStop2.setAttribute('offset', '50%');\n    procStop2.setAttribute('style', 'stop-color:#ffffff;stop-opacity:1');\n    const animate2 = document.createElementNS('http://www.w3.org/2000/svg', 'animate');\n    animate2.setAttribute('attributeName', 'stop-color');\n    animate2.setAttribute('values', '#ffffff;#666;#ffffff');\n    animate2.setAttribute('dur', '2s');\n    animate2.setAttribute('repeatCount', 'indefinite');\n    procStop2.appendChild(animate2);\n    processingGrad.appendChild(procStop2);\n    const procStop3 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');\n    procStop3.setAttribute('offset', '100%');\n    procStop3.setAttribute('style', 'stop-color:#666;stop-opacity:1');\n    const animate3 = document.createElementNS('http://www.w3.org/2000/svg', 'animate');\n    animate3.setAttribute('attributeName', 'stop-color');\n    animate3.setAttribute('values', '#666;#ffffff;#666');\n    animate3.setAttribute('dur', '2s');\n    animate3.setAttribute('repeatCount', 'indefinite');\n    procStop3.appendChild(animate3);\n    processingGrad.appendChild(procStop3);\n    defs.appendChild(processingGrad);\n    svg.appendChild(defs);\n    // Infinity symbol paths\n    const pathData = 'M 25 50 C 25 30, 35 20, 50 30 C 50 30, 50 30, 50 50 C 50 70, 70 80, 80 50 C 80 30, 70 20, 50 30 C 50 30, 50 30, 50 50 C 50 70, 30 80, 25 50';\n    // Normal path\n    const normalGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n    normalGroup.setAttribute('class', 'path-normal');\n    const normalPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n    normalPath.setAttribute('d', pathData);\n    normalPath.setAttribute('stroke', `url(#${normalId})`);\n    normalPath.setAttribute('stroke-width', '4.5');\n    normalPath.setAttribute('fill', 'none');\n    normalPath.setAttribute('stroke-linecap', 'round');\n    normalGroup.appendChild(normalPath);\n    svg.appendChild(normalGroup);\n    // Processing path\n    const processingGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n    processingGroup.setAttribute('class', 'path-processing');\n    const processingPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n    processingPath.setAttribute('d', pathData);\n    processingPath.setAttribute('stroke', `url(#${processingId})`);\n    processingPath.setAttribute('stroke-width', '4.5');\n    processingPath.setAttribute('fill', 'none');\n    processingPath.setAttribute('stroke-linecap', 'round');\n    processingGroup.appendChild(processingPath);\n    svg.appendChild(processingGroup);\n    container.appendChild(svg);\n    return container;\n}\n","/**\n * Personalization Service\n *\n * Handles name interpolation and privacy mode for the Sidecar UI.\n * Ensures consistent, personalized text across Mini and Sidecar.\n */\n// Storage key for privacy mode preference\nconst PRIVACY_MODE_KEY = 'mobius.privacyMode';\n/**\n * Get initials from a full name\n * \"John Smith\" -> \"J.S.\"\n */\nexport function getInitials(fullName) {\n    const parts = fullName.trim().split(/\\s+/);\n    if (parts.length === 0)\n        return '';\n    return parts\n        .map(part => part.charAt(0).toUpperCase())\n        .join('.') + '.';\n}\n/**\n * Get display name based on privacy mode\n * Privacy ON: \"J.S.\"\n * Privacy OFF: \"John Smith\"\n */\nexport function getDisplayName(record, isPrivate) {\n    if (isPrivate) {\n        return getInitials(record.displayName);\n    }\n    return record.displayName;\n}\n/**\n * Get short name based on privacy mode\n * Privacy ON: \"J.\"\n * Privacy OFF: \"John\"\n */\nexport function getShortName(record, isPrivate) {\n    if (isPrivate) {\n        const firstName = record.shortName.split(/\\s+/)[0];\n        return firstName.charAt(0).toUpperCase() + '.';\n    }\n    return record.shortName;\n}\n/**\n * Get possessive form based on privacy mode\n * Privacy ON: \"J.S.'s\"\n * Privacy OFF: \"John's\"\n */\nexport function getPossessive(record, isPrivate) {\n    if (isPrivate) {\n        return getInitials(record.displayName) + \"'s\";\n    }\n    return record.possessive;\n}\n/**\n * Interpolate template with record context\n *\n * @param template - Template string with {{tokens}}\n * @param context - Privacy context with record and optional staff info\n * @returns Interpolated string\n *\n * @example\n * formatLabel(\"{{possessive}} insurance verified\", context)\n * // Privacy OFF: \"John's insurance verified\"\n * // Privacy ON: \"J.S.'s insurance verified\"\n */\nexport function formatLabel(template, context) {\n    const { isPrivate, record, staff } = context;\n    const tokens = {\n        '{{name}}': getDisplayName(record, isPrivate),\n        '{{shortName}}': getShortName(record, isPrivate),\n        '{{possessive}}': getPossessive(record, isPrivate),\n        '{{staffName}}': staff ? (isPrivate ? getInitials(staff.displayName) : staff.displayName) : 'Team member',\n        '{{staffShortName}}': staff ? (isPrivate ? staff.shortName.charAt(0) + '.' : staff.shortName) : '',\n    };\n    let result = template;\n    for (const [token, value] of Object.entries(tokens)) {\n        result = result.replace(new RegExp(token.replace(/[{}]/g, '\\\\$&'), 'g'), value);\n    }\n    return result;\n}\n/**\n * Generate celebration text for wins\n */\nexport function getCelebrationText(milestoneName, context, completedBy) {\n    const possessive = getPossessive(context.record, context.isPrivate);\n    const templates = {\n        'visit': {\n            user: `Great work! ${possessive} visit is confirmed.`,\n            mobius: `${possessive} visit has been confirmed.`,\n            external: `${possessive} visit is now confirmed!`,\n        },\n        'eligibility': {\n            user: `Nice! You verified ${possessive} insurance.`,\n            mobius: `${possessive} insurance has been verified.`,\n            external: `${possessive} insurance is confirmed!`,\n        },\n        'authorization': {\n            user: `Excellent! ${possessive} authorization is secured.`,\n            mobius: `${possessive} authorization has been approved!`,\n            external: `${possessive} auth came through!`,\n        },\n        'documentation': {\n            user: `Well done! ${possessive} documentation is ready.`,\n            mobius: `${possessive} documentation is complete.`,\n            external: `${possessive} docs are all set!`,\n        },\n    };\n    const milestoneTemplates = templates[milestoneName.toLowerCase()] || templates['visit'];\n    return milestoneTemplates[completedBy] || milestoneTemplates['external'];\n}\n/**\n * Privacy mode preference management\n */\nexport const PrivacyMode = {\n    /**\n     * Check if privacy mode is enabled\n     */\n    async isEnabled() {\n        return new Promise((resolve) => {\n            if (typeof chrome !== 'undefined' && chrome.storage?.local) {\n                chrome.storage.local.get([PRIVACY_MODE_KEY], (result) => {\n                    resolve(result[PRIVACY_MODE_KEY] === true);\n                });\n            }\n            else {\n                // Fallback for non-extension context\n                resolve(localStorage.getItem(PRIVACY_MODE_KEY) === 'true');\n            }\n        });\n    },\n    /**\n     * Set privacy mode\n     */\n    async setEnabled(enabled) {\n        return new Promise((resolve) => {\n            if (typeof chrome !== 'undefined' && chrome.storage?.local) {\n                chrome.storage.local.set({ [PRIVACY_MODE_KEY]: enabled }, () => {\n                    resolve();\n                });\n            }\n            else {\n                localStorage.setItem(PRIVACY_MODE_KEY, String(enabled));\n                resolve();\n            }\n        });\n    },\n    /**\n     * Toggle privacy mode\n     */\n    async toggle() {\n        const current = await this.isEnabled();\n        const newValue = !current;\n        await this.setEnabled(newValue);\n        return newValue;\n    },\n};\n/**\n * Build a PrivacyContext from available data\n */\nexport function buildPrivacyContext(record, staffName, isPrivate = false) {\n    return {\n        isPrivate,\n        record,\n        staff: staffName ? {\n            displayName: staffName,\n            shortName: staffName.split(/\\s+/)[0] || staffName,\n        } : undefined,\n    };\n}\n/**\n * Create a RecordContext for a patient\n */\nexport function createPatientContext(id, fullName, firstName) {\n    const shortName = firstName || fullName.split(/\\s+/)[0] || fullName;\n    // Handle possessive form (simple English rules)\n    const possessive = shortName.endsWith('s')\n        ? `${shortName}'`\n        : `${shortName}'s`;\n    return {\n        type: 'patient',\n        id,\n        displayName: fullName,\n        shortName,\n        possessive,\n    };\n}\n","/**\n * Data Hierarchy Service\n *\n * Resolves data precedence when multiple sources have different values.\n * Hierarchy: User (real-time) > Page (detected) > Backend (knowledge) > Batch (periodic)\n */\n/**\n * Source priority order (higher index = higher priority)\n */\nconst SOURCE_PRIORITY = ['batch', 'backend', 'page', 'user'];\n/**\n * Source display badges\n */\nconst SOURCE_BADGES = {\n    batch: '', // Moon = ran overnight/periodically\n    backend: '', // Book = from knowledge base\n    page: '', // Document = from current page\n    user: '', // Checkmark = user confirmed\n};\n/**\n * Source display labels\n */\nconst SOURCE_LABELS = {\n    batch: 'From batch analysis',\n    backend: 'From system records',\n    page: 'Detected on page',\n    user: 'You confirmed',\n};\n/**\n * Resolve the highest-priority value from multiple sources\n */\nexport function resolveValue(sources) {\n    // Collect all available sources with their values\n    const available = [];\n    if (sources.user) {\n        available.push({ source: 'user', value: sources.user.value, timestamp: sources.user.set_at });\n    }\n    if (sources.page) {\n        available.push({ source: 'page', value: sources.page.value, timestamp: sources.page.detected_at });\n    }\n    if (sources.backend) {\n        available.push({ source: 'backend', value: sources.backend.value, timestamp: sources.backend.fetched_at });\n    }\n    if (sources.batch) {\n        available.push({ source: 'batch', value: sources.batch.value, timestamp: sources.batch.updated_at });\n    }\n    if (available.length === 0) {\n        return null;\n    }\n    // Sort by priority (highest first)\n    available.sort((a, b) => SOURCE_PRIORITY.indexOf(b.source) - SOURCE_PRIORITY.indexOf(a.source));\n    const winner = available[0];\n    // Check for conflicts (different values from different sources)\n    const uniqueValues = new Set(available.map(s => s.value.toLowerCase().trim()));\n    const hasConflict = uniqueValues.size > 1;\n    let conflictingSources;\n    if (hasConflict) {\n        conflictingSources = available\n            .filter(s => s.value.toLowerCase().trim() !== winner.value.toLowerCase().trim())\n            .map(s => s.source);\n    }\n    return {\n        value: winner.value,\n        source: winner.source,\n        timestamp: winner.timestamp,\n        hasConflict,\n        conflictingSources,\n    };\n}\n/**\n * Check if sources have conflicting values\n */\nexport function hasConflict(sources) {\n    const values = [];\n    if (sources.user)\n        values.push(sources.user.value.toLowerCase().trim());\n    if (sources.page)\n        values.push(sources.page.value.toLowerCase().trim());\n    if (sources.backend)\n        values.push(sources.backend.value.toLowerCase().trim());\n    if (sources.batch)\n        values.push(sources.batch.value.toLowerCase().trim());\n    const uniqueValues = new Set(values);\n    return uniqueValues.size > 1;\n}\n/**\n * Get the display badge for a source type\n */\nexport function getSourceBadge(source) {\n    return SOURCE_BADGES[source] || '';\n}\n/**\n * Get the display label for a source type\n */\nexport function getSourceLabel(source) {\n    return SOURCE_LABELS[source] || 'Unknown source';\n}\n/**\n * Format a conflict message for display\n */\nexport function formatConflictMessage(sources) {\n    const resolved = resolveValue(sources);\n    if (!resolved || !resolved.hasConflict || !resolved.conflictingSources) {\n        return null;\n    }\n    // Get the conflicting value (from highest priority conflicting source)\n    const conflictSource = resolved.conflictingSources[0];\n    const conflictValue = sources[conflictSource]?.value || 'different value';\n    return `Using \"${resolved.value}\" (${getSourceLabel(resolved.source)}). ` +\n        `${getSourceLabel(conflictSource)} shows \"${conflictValue}\".`;\n}\n/**\n * Build a summary of all sources for tooltip/detail view\n */\nexport function buildSourcesSummary(sources) {\n    const summary = [];\n    if (sources.user) {\n        summary.push(`${SOURCE_BADGES.user} You: \"${sources.user.value}\" (${formatTimestamp(sources.user.set_at)})`);\n    }\n    if (sources.page) {\n        summary.push(`${SOURCE_BADGES.page} Page: \"${sources.page.value}\" (${formatTimestamp(sources.page.detected_at)})`);\n    }\n    if (sources.backend) {\n        summary.push(`${SOURCE_BADGES.backend} System: \"${sources.backend.value}\" (${formatTimestamp(sources.backend.fetched_at)})`);\n    }\n    if (sources.batch) {\n        summary.push(`${SOURCE_BADGES.batch} Batch: \"${sources.batch.value}\" (${formatTimestamp(sources.batch.updated_at)})`);\n    }\n    return summary;\n}\n/**\n * Format timestamp for display\n */\nfunction formatTimestamp(isoString) {\n    try {\n        const date = new Date(isoString);\n        const now = new Date();\n        const diffMs = now.getTime() - date.getTime();\n        const diffMins = Math.floor(diffMs / 60000);\n        const diffHours = Math.floor(diffMs / 3600000);\n        const diffDays = Math.floor(diffMs / 86400000);\n        if (diffMins < 1)\n            return 'just now';\n        if (diffMins < 60)\n            return `${diffMins}m ago`;\n        if (diffHours < 24)\n            return `${diffHours}h ago`;\n        if (diffDays < 7)\n            return `${diffDays}d ago`;\n        return date.toLocaleDateString();\n    }\n    catch {\n        return 'unknown time';\n    }\n}\n/**\n * Get relative time string\n */\nexport function getRelativeTime(isoString) {\n    return formatTimestamp(isoString);\n}\n","/**\n * BottleneckCard Component\n *\n * The core UI for displaying questions/bottlenecks.\n * Uses question format for consistency with Mini.\n * Compact assignment dropdown near question.\n * Checkboxes always visible for bulk selection.\n */\nimport { formatLabel } from '../../services/personalization';\nimport { resolveValue, getSourceBadge, hasConflict } from '../../services/dataHierarchy';\n/**\n * Create the BottleneckCard element\n */\nexport function BottleneckCard(props) {\n    const { bottlenecks, privacyContext, onAnswer, onAssign, onOwn, onAddNote, onBulkAssign } = props;\n    const container = document.createElement('div');\n    container.className = 'sidecar-bottleneck-card';\n    // No bottlenecks = all clear\n    if (bottlenecks.length === 0) {\n        container.innerHTML = `\n      <div class=\"sidecar-bottleneck-clear\">\n        <span class=\"sidecar-bottleneck-clear-icon\"></span>\n        <span class=\"sidecar-bottleneck-clear-text\">All clear! No issues detected.</span>\n      </div>\n    `;\n        return container;\n    }\n    // Header - always show task count context\n    const header = document.createElement('div');\n    header.className = 'sidecar-bottleneck-header';\n    if (bottlenecks.length > 1) {\n        header.innerHTML = `\n      <span class=\"sidecar-bottleneck-count\">${bottlenecks.length} tasks</span>\n      <span class=\"sidecar-bottleneck-hint\">Assign each to Mobius or resolve yourself</span>\n    `;\n    }\n    else {\n        header.innerHTML = `\n      <span class=\"sidecar-bottleneck-count\">1 task</span>\n      <span class=\"sidecar-bottleneck-hint\">Assign to Mobius or resolve yourself</span>\n    `;\n    }\n    container.appendChild(header);\n    // Render each bottleneck - no checkboxes, assign one at a time\n    for (const bottleneck of bottlenecks) {\n        const item = createBottleneckItem(bottleneck, privacyContext, onAnswer, onAssign, onOwn, onAddNote);\n        container.appendChild(item);\n    }\n    return container;\n}\n/**\n * Create a single bottleneck item\n */\nfunction createBottleneckItem(bottleneck, privacyContext, onAnswer, onAssign, onOwn, onAddNote) {\n    const item = document.createElement('div');\n    item.className = 'sidecar-bottleneck-item';\n    item.dataset.id = bottleneck.id;\n    // Question row with question and assignment dropdown\n    const questionRow = document.createElement('div');\n    questionRow.className = 'sidecar-bottleneck-question-row';\n    // Question text\n    const questionText = document.createElement('div');\n    questionText.className = 'sidecar-bottleneck-question';\n    questionText.textContent = formatLabel(bottleneck.question_text, privacyContext);\n    questionRow.appendChild(questionText);\n    // Source badge (if not from user)\n    const resolved = resolveValue(bottleneck.sources);\n    if (resolved && resolved.source !== 'user') {\n        const badge = document.createElement('span');\n        badge.className = 'sidecar-source-badge';\n        badge.textContent = getSourceBadge(resolved.source);\n        badge.title = `Data ${resolved.source === 'batch' ? 'from batch analysis' : 'detected on page'}`;\n        questionRow.appendChild(badge);\n    }\n    // Conflict indicator\n    if (hasConflict(bottleneck.sources)) {\n        const conflict = document.createElement('span');\n        conflict.className = 'sidecar-conflict-badge';\n        conflict.textContent = '';\n        conflict.title = 'Different sources show different values';\n        questionRow.appendChild(conflict);\n    }\n    // Assignment dropdown (compact, near question)\n    const assignDropdown = createAssignDropdown(bottleneck, onAssign, onOwn);\n    questionRow.appendChild(assignDropdown);\n    item.appendChild(questionRow);\n    // Answer options row\n    const answersRow = document.createElement('div');\n    answersRow.className = 'sidecar-bottleneck-answers';\n    for (const option of bottleneck.answer_options) {\n        const btn = createAnswerButton(option, () => {\n            onAnswer(bottleneck.id, option.id);\n        });\n        answersRow.appendChild(btn);\n    }\n    item.appendChild(answersRow);\n    // Mobius tip - informational only, not clickable\n    if (bottleneck.mobius_can_handle) {\n        const mobiusTip = document.createElement('div');\n        mobiusTip.className = 'sidecar-bottleneck-mobius-tip';\n        mobiusTip.innerHTML = `<span class=\"sidecar-mobius-tip-icon\"></span> Mobius can handle this for you`;\n        item.appendChild(mobiusTip);\n    }\n    // Inline note input (compact)\n    const noteRow = document.createElement('div');\n    noteRow.className = 'sidecar-bottleneck-note-row';\n    const noteWrap = document.createElement('div');\n    noteWrap.className = 'sidecar-bottleneck-note-wrap';\n    const noteInput = document.createElement('input');\n    noteInput.type = 'text';\n    noteInput.className = 'sidecar-bottleneck-note-input';\n    noteInput.placeholder = 'Add note...';\n    const sendBtn = document.createElement('button');\n    sendBtn.className = 'sidecar-bottleneck-note-send';\n    sendBtn.type = 'button';\n    sendBtn.innerHTML = '<svg viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"></path></svg>';\n    sendBtn.title = 'Send note';\n    const doSendNote = () => {\n        const note = noteInput.value.trim();\n        if (note) {\n            onAddNote(bottleneck.id, note);\n            noteInput.value = '';\n        }\n    };\n    sendBtn.addEventListener('click', doSendNote);\n    noteInput.addEventListener('keydown', (e) => {\n        if (e.key === 'Enter') {\n            e.preventDefault();\n            doSendNote();\n        }\n    });\n    noteWrap.appendChild(noteInput);\n    noteWrap.appendChild(sendBtn);\n    noteRow.appendChild(noteWrap);\n    item.appendChild(noteRow);\n    return item;\n}\n/**\n * Create assignment dropdown\n */\nfunction createAssignDropdown(bottleneck, onAssign, onOwn) {\n    const wrapper = document.createElement('div');\n    wrapper.className = 'sidecar-assign-dropdown';\n    // Dropdown button - more prominent\n    const btn = document.createElement('button');\n    btn.className = 'sidecar-assign-btn';\n    btn.innerHTML = `\n    <span class=\"sidecar-assign-label\">Assign</span>\n    <span class=\"sidecar-assign-arrow\"></span>\n  `;\n    btn.title = 'Assign task';\n    // Dropdown menu\n    const menu = document.createElement('div');\n    menu.className = 'sidecar-assign-menu';\n    menu.style.display = 'none';\n    // Option 1: Let Mobius handle (agentic)\n    const mobiusOption = document.createElement('button');\n    mobiusOption.className = 'sidecar-assign-option';\n    mobiusOption.innerHTML = `\n    <span class=\"sidecar-assign-option-text\">Let Mobius handle</span>\n    <span class=\"sidecar-assign-option-hint\">Fully automated</span>\n  `;\n    if (bottleneck.mobius_action) {\n        mobiusOption.title = bottleneck.mobius_action;\n    }\n    mobiusOption.addEventListener('click', (e) => {\n        e.stopPropagation();\n        menu.style.display = 'none';\n        btn.querySelector('.sidecar-assign-label').textContent = 'Mobius';\n        btn.classList.add('sidecar-assign-btn--assigned');\n        onAssign(bottleneck.id, 'agentic');\n    });\n    menu.appendChild(mobiusOption);\n    // Option 2: Watch Mobius do it (copilot)\n    const copilotOption = document.createElement('button');\n    copilotOption.className = 'sidecar-assign-option';\n    copilotOption.innerHTML = `\n    <span class=\"sidecar-assign-option-text\">Watch Mobius do it</span>\n    <span class=\"sidecar-assign-option-hint\">You review each step</span>\n  `;\n    copilotOption.addEventListener('click', (e) => {\n        e.stopPropagation();\n        menu.style.display = 'none';\n        btn.querySelector('.sidecar-assign-label').textContent = 'Copilot';\n        btn.classList.add('sidecar-assign-btn--assigned');\n        onAssign(bottleneck.id, 'copilot');\n    });\n    menu.appendChild(copilotOption);\n    // Divider\n    const divider = document.createElement('div');\n    divider.className = 'sidecar-assign-divider';\n    menu.appendChild(divider);\n    // Option 3: I'll do it\n    const userOption = document.createElement('button');\n    userOption.className = 'sidecar-assign-option';\n    userOption.innerHTML = `\n    <span class=\"sidecar-assign-option-text\">I'll do it myself</span>\n    <span class=\"sidecar-assign-option-hint\">Manual resolution</span>\n  `;\n    userOption.addEventListener('click', (e) => {\n        e.stopPropagation();\n        menu.style.display = 'none';\n        btn.querySelector('.sidecar-assign-label').textContent = 'Me';\n        btn.classList.add('sidecar-assign-btn--assigned');\n        onOwn(bottleneck.id);\n    });\n    menu.appendChild(userOption);\n    // Toggle menu\n    btn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        const isOpen = menu.style.display !== 'none';\n        menu.style.display = isOpen ? 'none' : 'block';\n    });\n    // Close on outside click\n    document.addEventListener('click', () => {\n        menu.style.display = 'none';\n    });\n    wrapper.appendChild(btn);\n    wrapper.appendChild(menu);\n    return wrapper;\n}\n/**\n * Create an answer button\n */\nfunction createAnswerButton(option, onClick) {\n    const btn = document.createElement('button');\n    btn.className = 'sidecar-answer-btn';\n    btn.textContent = option.label;\n    if (option.description) {\n        btn.title = option.description;\n    }\n    btn.addEventListener('click', () => {\n        selectAnswerButton(btn);\n        onClick();\n    });\n    return btn;\n}\nfunction selectAnswerButton(btn) {\n    const container = btn.closest('.sidecar-bottleneck-answers');\n    if (!container) {\n        console.log('[BottleneckCard] Container not found for button');\n        return;\n    }\n    // Remove selected class from all buttons in this container\n    const allBtns = container.querySelectorAll('.sidecar-answer-btn');\n    allBtns.forEach(el => {\n        el.classList.remove('sidecar-answer-btn--selected');\n    });\n    // Add selected class to clicked button\n    btn.classList.add('sidecar-answer-btn--selected');\n    console.log('[BottleneckCard] Selected button:', btn.textContent, 'Classes:', btn.className);\n}\n/**\n * Create the \"All Clear\" state\n */\nexport function AllClearCard() {\n    const container = document.createElement('div');\n    container.className = 'sidecar-bottleneck-card sidecar-bottleneck-card--clear';\n    container.innerHTML = `\n    <div class=\"sidecar-bottleneck-clear\">\n      <span class=\"sidecar-bottleneck-clear-icon\"></span>\n      <div class=\"sidecar-bottleneck-clear-text\">\n        <strong>All clear!</strong>\n        <span>No issues detected for this patient.</span>\n      </div>\n    </div>\n  `;\n    return container;\n}\n","/**\n * ContextExpander Component\n *\n * Collapsible section showing detailed context:\n * - Full resolution plan with all steps\n * - Milestone progress\n * - Journey timeline\n * - Payer info from knowledge context\n */\nimport { formatLabel } from '../../services/personalization';\nimport { getRelativeTime } from '../../services/dataHierarchy';\n/**\n * Create the ContextExpander element\n */\nexport function ContextExpander(props) {\n    const { milestones, knowledgeContext, privacyContext, resolutionPlan, defaultExpanded = false } = props;\n    const container = document.createElement('div');\n    container.className = 'sidecar-context-expander';\n    // Toggle header\n    const header = document.createElement('button');\n    header.className = 'sidecar-context-expander-toggle';\n    header.innerHTML = `\n    <span class=\"sidecar-context-expander-arrow\">${defaultExpanded ? '' : ''}</span>\n    <span class=\"sidecar-context-expander-label\">More info</span>\n  `;\n    // Content container\n    const content = document.createElement('div');\n    content.className = 'sidecar-context-expander-content';\n    content.style.display = defaultExpanded ? 'block' : 'none';\n    // Toggle behavior\n    header.addEventListener('click', () => {\n        const isExpanded = content.style.display !== 'none';\n        content.style.display = isExpanded ? 'none' : 'block';\n        const arrow = header.querySelector('.sidecar-context-expander-arrow');\n        if (arrow)\n            arrow.textContent = isExpanded ? '' : '';\n    });\n    // Resolution Plan section (if available)\n    if (resolutionPlan && resolutionPlan.status !== 'resolved') {\n        const planSection = createResolutionPlanSection(resolutionPlan, privacyContext);\n        content.appendChild(planSection);\n    }\n    // Milestones section\n    const milestonesSection = createMilestonesSection(milestones, privacyContext);\n    content.appendChild(milestonesSection);\n    // Payer info section (if available)\n    if (knowledgeContext.payer.name) {\n        const payerSection = createPayerSection(knowledgeContext);\n        content.appendChild(payerSection);\n    }\n    container.appendChild(header);\n    container.appendChild(content);\n    return container;\n}\n/**\n * Create the resolution plan section showing all steps\n */\nfunction createResolutionPlanSection(plan, privacyContext) {\n    const section = document.createElement('div');\n    section.className = 'sidecar-plan-section';\n    const title = document.createElement('div');\n    title.className = 'sidecar-section-title';\n    title.textContent = 'Resolution Plan';\n    section.appendChild(title);\n    // Plan summary\n    const summary = document.createElement('div');\n    summary.className = 'sidecar-plan-summary';\n    // Show factors progress\n    const factorEntries = Object.entries(plan.factors || {});\n    if (factorEntries.length > 0) {\n        const factorsList = document.createElement('div');\n        factorsList.className = 'sidecar-plan-factors';\n        for (const [factorKey, factor] of factorEntries) {\n            const factorEl = document.createElement('div');\n            factorEl.className = 'sidecar-plan-factor';\n            const factorLabel = factorKey.replace(/_/g, ' ').replace(/\\b\\w/g, c => c.toUpperCase());\n            const progress = factor.total > 0 ? Math.round((factor.done / factor.total) * 100) : 0;\n            factorEl.innerHTML = `\n        <span class=\"sidecar-plan-factor-label\">${factorLabel}</span>\n        <span class=\"sidecar-plan-factor-progress\">${factor.done}/${factor.total}</span>\n        <div class=\"sidecar-plan-factor-bar\">\n          <div class=\"sidecar-plan-factor-fill\" style=\"width: ${progress}%\"></div>\n        </div>\n      `;\n            factorsList.appendChild(factorEl);\n        }\n        summary.appendChild(factorsList);\n    }\n    section.appendChild(summary);\n    // Current step highlight\n    if (plan.current_step) {\n        const currentStepEl = document.createElement('div');\n        currentStepEl.className = 'sidecar-plan-current';\n        currentStepEl.innerHTML = `\n      <span class=\"sidecar-plan-current-label\">Current:</span>\n      <span class=\"sidecar-plan-current-text\">${formatLabel(plan.current_step.question_text, privacyContext)}</span>\n    `;\n        section.appendChild(currentStepEl);\n    }\n    // Actions count\n    if (plan.actions_for_user > 0) {\n        const actionsEl = document.createElement('div');\n        actionsEl.className = 'sidecar-plan-actions';\n        actionsEl.textContent = `${plan.actions_for_user} action${plan.actions_for_user > 1 ? 's' : ''} for you`;\n        section.appendChild(actionsEl);\n    }\n    return section;\n}\n/**\n * Create the milestones progress section\n */\nfunction createMilestonesSection(milestones, privacyContext) {\n    const section = document.createElement('div');\n    section.className = 'sidecar-milestones-section';\n    const title = document.createElement('div');\n    title.className = 'sidecar-section-title';\n    title.textContent = 'Progress';\n    section.appendChild(title);\n    const list = document.createElement('div');\n    list.className = 'sidecar-milestones-list';\n    for (const milestone of milestones) {\n        const item = createMilestoneItem(milestone, privacyContext);\n        list.appendChild(item);\n    }\n    section.appendChild(list);\n    return section;\n}\n/**\n * Create a single milestone item (expandable)\n */\nfunction createMilestoneItem(milestone, privacyContext) {\n    const item = document.createElement('div');\n    item.className = `sidecar-milestone sidecar-milestone--${milestone.status}`;\n    // Status icon\n    const statusIcons = {\n        complete: '',\n        in_progress: '',\n        blocked: '',\n        pending: '',\n    };\n    // Header (always visible)\n    const header = document.createElement('div');\n    header.className = 'sidecar-milestone-header';\n    const icon = document.createElement('span');\n    icon.className = 'sidecar-milestone-icon';\n    icon.textContent = statusIcons[milestone.status] || '';\n    header.appendChild(icon);\n    const label = document.createElement('span');\n    label.className = 'sidecar-milestone-label';\n    label.textContent = formatLabel(milestone.label, privacyContext);\n    header.appendChild(label);\n    // Expand arrow (if has history or substeps)\n    const hasDetails = milestone.history.length > 0 || milestone.substeps.length > 0;\n    if (hasDetails) {\n        const arrow = document.createElement('span');\n        arrow.className = 'sidecar-milestone-arrow';\n        arrow.textContent = '';\n        header.appendChild(arrow);\n    }\n    item.appendChild(header);\n    // Details section (hidden by default)\n    if (hasDetails) {\n        const details = document.createElement('div');\n        details.className = 'sidecar-milestone-details';\n        details.style.display = 'none';\n        // Substeps\n        if (milestone.substeps.length > 0) {\n            const substepsContainer = document.createElement('div');\n            substepsContainer.className = 'sidecar-substeps';\n            for (const substep of milestone.substeps) {\n                const substepEl = document.createElement('div');\n                substepEl.className = `sidecar-substep sidecar-substep--${substep.status}`;\n                substepEl.innerHTML = `\n          <span class=\"sidecar-substep-icon\">${substep.status === 'complete' ? '' : substep.status === 'current' ? '' : ''}</span>\n          <span class=\"sidecar-substep-label\">${substep.label}</span>\n        `;\n                substepsContainer.appendChild(substepEl);\n            }\n            details.appendChild(substepsContainer);\n        }\n        // History/timeline\n        if (milestone.history.length > 0) {\n            const timeline = createTimeline(milestone.history);\n            details.appendChild(timeline);\n        }\n        item.appendChild(details);\n        // Toggle behavior\n        header.style.cursor = 'pointer';\n        header.addEventListener('click', () => {\n            const isExpanded = details.style.display !== 'none';\n            details.style.display = isExpanded ? 'none' : 'block';\n            const arrowEl = header.querySelector('.sidecar-milestone-arrow');\n            if (arrowEl)\n                arrowEl.textContent = isExpanded ? '' : '';\n        });\n    }\n    return item;\n}\n/**\n * Create a timeline from history entries\n */\nfunction createTimeline(history) {\n    const timeline = document.createElement('div');\n    timeline.className = 'sidecar-timeline';\n    const title = document.createElement('div');\n    title.className = 'sidecar-timeline-title';\n    title.textContent = 'History';\n    timeline.appendChild(title);\n    for (const entry of history.slice().reverse()) {\n        const entryEl = document.createElement('div');\n        entryEl.className = 'sidecar-timeline-entry';\n        // Actor badge\n        const actorBadge = document.createElement('span');\n        actorBadge.className = `sidecar-timeline-actor sidecar-timeline-actor--${entry.actor}`;\n        actorBadge.textContent = entry.actor_name || entry.actor;\n        entryEl.appendChild(actorBadge);\n        // Action text\n        const action = document.createElement('span');\n        action.className = 'sidecar-timeline-action';\n        action.textContent = entry.action;\n        entryEl.appendChild(action);\n        // Timestamp\n        const time = document.createElement('span');\n        time.className = 'sidecar-timeline-time';\n        time.textContent = getRelativeTime(entry.timestamp);\n        entryEl.appendChild(time);\n        // Artifact link (if any)\n        if (entry.artifact) {\n            const artifact = document.createElement('a');\n            artifact.className = 'sidecar-timeline-artifact';\n            artifact.textContent = entry.artifact.label;\n            if (entry.artifact.url) {\n                artifact.href = entry.artifact.url;\n                artifact.target = '_blank';\n            }\n            entryEl.appendChild(artifact);\n        }\n        timeline.appendChild(entryEl);\n    }\n    return timeline;\n}\n/**\n * Create the payer info section\n */\nfunction createPayerSection(knowledgeContext) {\n    const section = document.createElement('div');\n    section.className = 'sidecar-payer-section';\n    const title = document.createElement('div');\n    title.className = 'sidecar-section-title';\n    title.textContent = 'Payer Info';\n    section.appendChild(title);\n    const info = document.createElement('div');\n    info.className = 'sidecar-payer-info';\n    // Payer name\n    const name = document.createElement('div');\n    name.className = 'sidecar-payer-name';\n    name.textContent = knowledgeContext.payer.name;\n    info.appendChild(name);\n    // Phone (if available)\n    if (knowledgeContext.payer.phone) {\n        const phone = document.createElement('div');\n        phone.className = 'sidecar-payer-phone';\n        phone.innerHTML = ` <a href=\"tel:${knowledgeContext.payer.phone}\">${knowledgeContext.payer.phone}</a>`;\n        info.appendChild(phone);\n    }\n    // Portal URL (if available)\n    if (knowledgeContext.payer.portal_url) {\n        const portal = document.createElement('div');\n        portal.className = 'sidecar-payer-portal';\n        portal.innerHTML = ` <a href=\"${knowledgeContext.payer.portal_url}\" target=\"_blank\">Payer Portal</a>`;\n        info.appendChild(portal);\n    }\n    // Response time (if available)\n    if (knowledgeContext.payer.avg_response_time) {\n        const responseTime = document.createElement('div');\n        responseTime.className = 'sidecar-payer-response-time';\n        responseTime.textContent = ` Typical response: ${knowledgeContext.payer.avg_response_time}`;\n        info.appendChild(responseTime);\n    }\n    section.appendChild(info);\n    // Policy excerpts (if any)\n    if (knowledgeContext.policy_excerpts.length > 0) {\n        const excerpts = document.createElement('div');\n        excerpts.className = 'sidecar-policy-excerpts';\n        const excerptsTitle = document.createElement('div');\n        excerptsTitle.className = 'sidecar-excerpts-title';\n        excerptsTitle.textContent = 'Relevant Policies';\n        excerpts.appendChild(excerptsTitle);\n        for (const excerpt of knowledgeContext.policy_excerpts.slice(0, 3)) {\n            const excerptEl = document.createElement('div');\n            excerptEl.className = 'sidecar-policy-excerpt';\n            excerptEl.innerHTML = `\n        <div class=\"sidecar-excerpt-topic\">${excerpt.topic}</div>\n        <div class=\"sidecar-excerpt-content\">${excerpt.content}</div>\n        <div class=\"sidecar-excerpt-source\">${excerpt.source}</div>\n      `;\n            excerpts.appendChild(excerptEl);\n        }\n        section.appendChild(excerpts);\n    }\n    return section;\n}\n","/**\n * Toast Manager Service\n *\n * Global service for managing toast notifications.\n * Runs independently of sidecar/mini state.\n * Toasts appear in top-right corner of browser window.\n */\nimport { getAuthHeader } from './auth';\n// Configuration\nconst POLL_INTERVAL_MS = 30000; // 30 seconds\nconst TOAST_CONTAINER_ID = 'mobius-toast-container';\nconst NOTIFICATIONS_ENABLED_KEY = 'mobius.notificationsEnabled';\n// Auto-dismiss durations by type\nconst AUTO_DISMISS_MS = {\n    win: 5000, // 5 seconds for celebrations\n    update: 3000, // 3 seconds for updates\n    reminder: 0, // Don't auto-dismiss reminders (need action)\n    conflict: 0, // Don't auto-dismiss conflicts (need resolution)\n};\n// State\nlet isInitialized = false;\nlet isPolling = false;\nlet pollIntervalId = null;\nlet previousAlertIds = new Set();\nlet toastQueue = [];\nlet activeToasts = new Map();\nlet notificationsEnabled = true;\nlet onToastAction = null;\nlet onJumpToPatient = null;\n/**\n * Initialize the toast manager\n * Should be called once on extension load\n */\nexport async function init(options) {\n    if (isInitialized) {\n        console.log('[ToastManager] Already initialized');\n        return;\n    }\n    console.log('[ToastManager] Initializing...');\n    // Set callbacks\n    if (options?.onAction)\n        onToastAction = options.onAction;\n    if (options?.onJumpToPatient)\n        onJumpToPatient = options.onJumpToPatient;\n    // Load notification preference\n    notificationsEnabled = await loadNotificationPreference();\n    // Create toast container\n    createToastContainer();\n    isInitialized = true;\n    console.log('[ToastManager] Initialized, notifications enabled:', notificationsEnabled);\n}\n/**\n * Start polling for alerts\n */\nexport function startPolling() {\n    if (isPolling) {\n        console.log('[ToastManager] Already polling');\n        return;\n    }\n    console.log('[ToastManager] Starting polling...');\n    isPolling = true;\n    // Poll immediately, then on interval\n    void pollForAlerts();\n    pollIntervalId = window.setInterval(() => {\n        void pollForAlerts();\n    }, POLL_INTERVAL_MS);\n}\n/**\n * Stop polling for alerts\n */\nexport function stopPolling() {\n    if (!isPolling)\n        return;\n    console.log('[ToastManager] Stopping polling...');\n    isPolling = false;\n    if (pollIntervalId !== null) {\n        window.clearInterval(pollIntervalId);\n        pollIntervalId = null;\n    }\n}\n/**\n * Show a toast notification\n */\nexport function show(toast) {\n    if (!isInitialized) {\n        console.warn('[ToastManager] Not initialized, queueing toast');\n        toastQueue.push(toast);\n        return;\n    }\n    if (!notificationsEnabled && toast.type !== 'conflict') {\n        // Still show conflicts even when notifications disabled\n        console.log('[ToastManager] Notifications disabled, skipping toast:', toast.id);\n        return;\n    }\n    renderToast(toast);\n}\n/**\n * Dismiss a toast\n */\nexport function dismiss(id) {\n    const element = activeToasts.get(id);\n    if (!element)\n        return;\n    // Animate out\n    element.classList.add('mobius-toast-exit');\n    setTimeout(() => {\n        element.remove();\n        activeToasts.delete(id);\n    }, 300);\n}\n/**\n * Dismiss all toasts\n */\nexport function dismissAll() {\n    for (const id of activeToasts.keys()) {\n        dismiss(id);\n    }\n}\n/**\n * Jump to a patient's sidecar\n */\nexport function jumpToPatient(patientKey) {\n    if (onJumpToPatient) {\n        onJumpToPatient(patientKey);\n    }\n    else {\n        console.warn('[ToastManager] No jump-to-patient callback registered');\n    }\n}\n/**\n * Set notifications enabled/disabled\n */\nexport async function setEnabled(enabled) {\n    notificationsEnabled = enabled;\n    await saveNotificationPreference(enabled);\n    if (!enabled) {\n        // Dismiss non-critical toasts when disabling\n        for (const [id, element] of activeToasts.entries()) {\n            const type = element.dataset.type;\n            if (type !== 'conflict' && type !== 'reminder') {\n                dismiss(id);\n            }\n        }\n    }\n}\n/**\n * Check if notifications are enabled\n */\nexport function isEnabled() {\n    return notificationsEnabled;\n}\n// =============================================================================\n// Internal Functions\n// =============================================================================\n/**\n * Create the toast container element\n */\nfunction createToastContainer() {\n    // Remove existing container if present\n    const existing = document.getElementById(TOAST_CONTAINER_ID);\n    if (existing)\n        existing.remove();\n    const container = document.createElement('div');\n    container.id = TOAST_CONTAINER_ID;\n    container.setAttribute('style', `\n    position: fixed !important;\n    top: 16px !important;\n    right: 16px !important;\n    z-index: 2147483647 !important;\n    display: flex !important;\n    flex-direction: column !important;\n    gap: 8px !important;\n    pointer-events: none !important;\n    max-width: 320px !important;\n  `);\n    document.body.appendChild(container);\n    // Add styles\n    addToastStyles();\n}\n/**\n * Get emoji for toast type\n */\nfunction getToastEmoji(type) {\n    switch (type) {\n        case 'win': return '';\n        case 'update': return '';\n        case 'reminder': return '';\n        case 'conflict': return '';\n        default: return '';\n    }\n}\n/**\n * Add toast CSS styles - minimal tag style\n */\nfunction addToastStyles() {\n    const styleId = 'mobius-toast-styles';\n    if (document.getElementById(styleId))\n        return;\n    const style = document.createElement('style');\n    style.id = styleId;\n    style.textContent = `\n    .mobius-toast {\n      pointer-events: auto !important;\n      background: rgba(255, 255, 255, 0.95) !important;\n      backdrop-filter: blur(8px) !important;\n      border-radius: 6px !important;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;\n      padding: 6px 10px !important;\n      display: flex !important;\n      align-items: center !important;\n      gap: 6px !important;\n      cursor: pointer !important;\n      animation: mobius-toast-enter 0.2s ease-out !important;\n      border: 1px solid rgba(11, 18, 32, 0.08) !important;\n      max-width: 260px !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n    }\n    \n    .mobius-toast-emoji {\n      font-size: 14px !important;\n      line-height: 1 !important;\n      flex-shrink: 0 !important;\n    }\n    \n    .mobius-toast-content {\n      flex: 1 !important;\n      min-width: 0 !important;\n    }\n    \n    .mobius-toast-title {\n      font-weight: 500 !important;\n      font-size: 10px !important;\n      color: #0b1220 !important;\n      margin: 0 !important;\n      line-height: 1.3 !important;\n      white-space: nowrap !important;\n      overflow: hidden !important;\n      text-overflow: ellipsis !important;\n    }\n    \n    .mobius-toast-subtitle {\n      font-size: 9px !important;\n      color: rgba(91, 102, 122, 0.7) !important;\n      margin: 0 !important;\n      line-height: 1.3 !important;\n      white-space: nowrap !important;\n      overflow: hidden !important;\n      text-overflow: ellipsis !important;\n    }\n    \n    .mobius-toast-close {\n      background: none !important;\n      border: none !important;\n      cursor: pointer !important;\n      color: rgba(91, 102, 122, 0.4) !important;\n      font-size: 12px !important;\n      line-height: 1 !important;\n      padding: 0 !important;\n      margin-left: 2px !important;\n      flex-shrink: 0 !important;\n    }\n    \n    .mobius-toast-close:hover {\n      color: rgba(91, 102, 122, 0.7) !important;\n    }\n    \n    .mobius-toast-exit {\n      animation: mobius-toast-exit 0.2s ease-in forwards !important;\n    }\n    \n    @keyframes mobius-toast-enter {\n      from {\n        opacity: 0;\n        transform: translateY(-8px);\n      }\n      to {\n        opacity: 1;\n        transform: translateY(0);\n      }\n    }\n    \n    @keyframes mobius-toast-exit {\n      from {\n        opacity: 1;\n        transform: translateY(0);\n      }\n      to {\n        opacity: 0;\n        transform: translateY(-8px);\n      }\n    }\n  `;\n    document.head.appendChild(style);\n}\n/**\n * Render a toast to the DOM - minimal tag style with emoji\n */\nfunction renderToast(toast) {\n    const container = document.getElementById(TOAST_CONTAINER_ID);\n    if (!container) {\n        console.error('[ToastManager] Container not found');\n        return;\n    }\n    // Don't show duplicate toasts\n    if (activeToasts.has(toast.id)) {\n        return;\n    }\n    const element = document.createElement('div');\n    element.className = 'mobius-toast';\n    element.dataset.type = toast.type;\n    element.dataset.id = toast.id;\n    // Emoji indicator\n    const emoji = document.createElement('span');\n    emoji.className = 'mobius-toast-emoji';\n    emoji.textContent = getToastEmoji(toast.type);\n    element.appendChild(emoji);\n    // Content wrapper\n    const content = document.createElement('div');\n    content.className = 'mobius-toast-content';\n    // Title - simplified format\n    const title = document.createElement('div');\n    title.className = 'mobius-toast-title';\n    title.textContent = toast.title;\n    content.appendChild(title);\n    // Subtitle (patient name)\n    if (toast.subtitle) {\n        const subtitle = document.createElement('div');\n        subtitle.className = 'mobius-toast-subtitle';\n        subtitle.textContent = toast.subtitle;\n        content.appendChild(subtitle);\n    }\n    element.appendChild(content);\n    // Close button\n    const closeBtn = document.createElement('button');\n    closeBtn.className = 'mobius-toast-close';\n    closeBtn.innerHTML = '';\n    closeBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        dismiss(toast.id);\n    });\n    element.appendChild(closeBtn);\n    // Click to jump to patient\n    if (toast.patient_key) {\n        element.addEventListener('click', () => {\n            jumpToPatient(toast.patient_key);\n            dismiss(toast.id);\n        });\n    }\n    // Add to DOM\n    container.appendChild(element);\n    activeToasts.set(toast.id, element);\n    // Auto-dismiss\n    const autoDismissMs = toast.auto_dismiss_ms ?? AUTO_DISMISS_MS[toast.type];\n    if (autoDismissMs > 0) {\n        setTimeout(() => {\n            dismiss(toast.id);\n        }, autoDismissMs);\n    }\n}\n/**\n * Poll for new alerts from backend\n */\nasync function pollForAlerts() {\n    try {\n        const authHeader = await getAuthHeader();\n        if (!authHeader) {\n            // Not authenticated, skip polling\n            return;\n        }\n        const response = await fetch('/api/v1/user/alerts', {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                ...authHeader,\n            },\n        });\n        if (!response.ok) {\n            console.error('[ToastManager] Failed to fetch alerts:', response.status);\n            return;\n        }\n        const data = await response.json();\n        // Find new alerts\n        const newAlerts = data.alerts.filter(alert => !previousAlertIds.has(alert.id));\n        // Update previous IDs\n        previousAlertIds = new Set(data.alerts.map(a => a.id));\n        // Show toasts for new alerts\n        for (const alert of newAlerts) {\n            const toast = alertToToast(alert);\n            show(toast);\n        }\n    }\n    catch (error) {\n        console.error('[ToastManager] Error polling alerts:', error);\n    }\n}\n/**\n * Convert an Alert to a Toast\n */\nfunction alertToToast(alert) {\n    const toast = {\n        id: alert.id,\n        type: alert.type,\n        title: alert.title,\n        subtitle: alert.subtitle,\n        patient_key: alert.patient_key,\n        auto_dismiss_ms: AUTO_DISMISS_MS[alert.type],\n    };\n    // Add actions for reminders\n    if (alert.type === 'reminder') {\n        toast.actions = [\n            { id: 'still_on_it', label: 'Still on it' },\n            { id: 'hand_to_mobius', label: 'Hand to Mobius' },\n        ];\n    }\n    return toast;\n}\n/**\n * Load notification preference from storage\n */\nasync function loadNotificationPreference() {\n    return new Promise((resolve) => {\n        if (typeof chrome !== 'undefined' && chrome.storage?.local) {\n            chrome.storage.local.get([NOTIFICATIONS_ENABLED_KEY], (result) => {\n                // Default to true if not set\n                resolve(result[NOTIFICATIONS_ENABLED_KEY] !== false);\n            });\n        }\n        else {\n            const stored = localStorage.getItem(NOTIFICATIONS_ENABLED_KEY);\n            resolve(stored !== 'false');\n        }\n    });\n}\n/**\n * Save notification preference to storage\n */\nasync function saveNotificationPreference(enabled) {\n    return new Promise((resolve) => {\n        if (typeof chrome !== 'undefined' && chrome.storage?.local) {\n            chrome.storage.local.set({ [NOTIFICATIONS_ENABLED_KEY]: enabled }, () => {\n                resolve();\n            });\n        }\n        else {\n            localStorage.setItem(NOTIFICATIONS_ENABLED_KEY, String(enabled));\n            resolve();\n        }\n    });\n}\n/**\n * Cleanup - call when extension unloads\n */\nexport function cleanup() {\n    stopPolling();\n    dismissAll();\n    const container = document.getElementById(TOAST_CONTAINER_ID);\n    if (container)\n        container.remove();\n    isInitialized = false;\n}\n","/**\n * SidecarMenu Component\n *\n * Hamburger menu with settings and secondary features.\n * Includes notifications toggle, privacy mode, and theme selection.\n * Matches Mini's menu styling.\n */\nimport { PrivacyMode } from '../../services/personalization';\nimport * as ToastManager from '../../services/toastManager';\n// Available themes - matches Mini's themes\nconst THEMES = [\n    { id: 'light', label: 'Light', icon: '' },\n    { id: 'dark', label: 'Dark', icon: '' },\n    { id: 'blue', label: 'Blue', icon: '' },\n    { id: 'glass', label: 'Glass', icon: '' },\n];\n/**\n * Create the SidecarMenu element\n */\nexport function SidecarMenu(props) {\n    const { onHistoryClick, onSettingsClick, onHelpClick, onPrivacyChange, onNotificationsChange, onThemeChange } = props;\n    const container = document.createElement('div');\n    container.className = 'sidecar-menu';\n    // Hamburger button (three dots vertical)\n    const menuBtn = document.createElement('button');\n    menuBtn.className = 'sidecar-menu-btn';\n    menuBtn.innerHTML = `<svg viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"5\" r=\"2\"/><circle cx=\"12\" cy=\"12\" r=\"2\"/><circle cx=\"12\" cy=\"19\" r=\"2\"/></svg>`;\n    menuBtn.title = 'Menu';\n    // Dropdown menu\n    const dropdown = document.createElement('div');\n    dropdown.className = 'sidecar-menu-dropdown';\n    dropdown.style.display = 'none';\n    // Toggle dropdown\n    menuBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';\n    });\n    // Close on outside click\n    document.addEventListener('click', () => {\n        dropdown.style.display = 'none';\n    });\n    // Menu items\n    const items = [\n        {\n            label: 'Notifications',\n            icon: 'bell',\n            toggle: {\n                key: 'notifications',\n                getState: async () => ToastManager.isEnabled(),\n                onChange: async (enabled) => {\n                    await ToastManager.setEnabled(enabled);\n                    onNotificationsChange(enabled);\n                },\n            },\n        },\n        {\n            label: 'Privacy mode',\n            icon: 'lock',\n            toggle: {\n                key: 'privacy',\n                getState: () => PrivacyMode.isEnabled(),\n                onChange: async (enabled) => {\n                    await PrivacyMode.setEnabled(enabled);\n                    onPrivacyChange(enabled);\n                },\n            },\n        },\n        { label: 'divider', icon: '' },\n        {\n            label: 'Theme',\n            icon: 'palette',\n            submenu: true,\n        },\n        { label: 'divider', icon: '' },\n        {\n            label: 'History',\n            icon: 'history',\n            onClick: () => {\n                dropdown.style.display = 'none';\n                onHistoryClick();\n            },\n        },\n        {\n            label: 'Settings',\n            icon: 'settings',\n            onClick: () => {\n                dropdown.style.display = 'none';\n                onSettingsClick();\n            },\n        },\n        {\n            label: 'Help',\n            icon: 'help',\n            onClick: () => {\n                dropdown.style.display = 'none';\n                onHelpClick();\n            },\n        },\n    ];\n    for (const item of items) {\n        if (item.label === 'divider') {\n            const divider = document.createElement('div');\n            divider.className = 'sidecar-menu-divider';\n            dropdown.appendChild(divider);\n            continue;\n        }\n        const menuItem = document.createElement('div');\n        menuItem.className = 'sidecar-menu-item';\n        // Icon (SVG)\n        const icon = document.createElement('span');\n        icon.className = 'sidecar-menu-icon';\n        icon.innerHTML = getMenuIcon(item.icon);\n        menuItem.appendChild(icon);\n        // Label\n        const label = document.createElement('span');\n        label.className = 'sidecar-menu-label';\n        label.textContent = item.label;\n        menuItem.appendChild(label);\n        // Toggle switch (for notifications/privacy)\n        if (item.toggle) {\n            const toggle = createToggle(item.toggle.key, item.toggle.getState, item.toggle.onChange);\n            menuItem.appendChild(toggle);\n        }\n        else if (item.submenu && item.label === 'Theme') {\n            // Theme submenu arrow\n            const arrow = document.createElement('span');\n            arrow.className = 'sidecar-menu-arrow';\n            arrow.textContent = '';\n            menuItem.appendChild(arrow);\n            // Theme submenu\n            const submenu = createThemeSubmenu(onThemeChange);\n            menuItem.appendChild(submenu);\n            menuItem.addEventListener('mouseenter', () => {\n                submenu.style.display = 'block';\n            });\n            menuItem.addEventListener('mouseleave', () => {\n                submenu.style.display = 'none';\n            });\n        }\n        else if (item.onClick) {\n            menuItem.addEventListener('click', item.onClick);\n            menuItem.style.cursor = 'pointer';\n        }\n        dropdown.appendChild(menuItem);\n    }\n    container.appendChild(menuBtn);\n    container.appendChild(dropdown);\n    return container;\n}\n/**\n * Get SVG icon for menu item\n */\nfunction getMenuIcon(name) {\n    const icons = {\n        bell: '<svg viewBox=\"0 0 24 24\"><path d=\"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z\"/></svg>',\n        lock: '<svg viewBox=\"0 0 24 24\"><path d=\"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z\"/></svg>',\n        palette: '<svg viewBox=\"0 0 24 24\"><path d=\"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z\"/></svg>',\n        history: '<svg viewBox=\"0 0 24 24\"><path d=\"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z\"/></svg>',\n        settings: '<svg viewBox=\"0 0 24 24\"><path d=\"M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z\"/></svg>',\n        help: '<svg viewBox=\"0 0 24 24\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z\"/></svg>',\n    };\n    return icons[name] || '';\n}\n/**\n * Create theme submenu\n */\nfunction createThemeSubmenu(onThemeChange) {\n    const submenu = document.createElement('div');\n    submenu.className = 'sidecar-menu-submenu';\n    submenu.style.display = 'none';\n    for (const theme of THEMES) {\n        const option = document.createElement('div');\n        option.className = 'sidecar-menu-submenu-item';\n        option.innerHTML = `\n      <span class=\"sidecar-menu-theme-icon\">${theme.icon}</span>\n      <span class=\"sidecar-menu-theme-label\">${theme.label}</span>\n    `;\n        option.addEventListener('click', (e) => {\n            e.stopPropagation();\n            // Apply theme to sidecar\n            const sidebar = document.getElementById('mobius-os-sidebar');\n            if (sidebar) {\n                sidebar.classList.remove('theme-light', 'theme-dark', 'theme-blue', 'theme-glass');\n                sidebar.classList.add(`theme-${theme.id}`);\n            }\n            onThemeChange?.(theme.id);\n            submenu.style.display = 'none';\n        });\n        submenu.appendChild(option);\n    }\n    return submenu;\n}\n/**\n * Create a toggle switch\n */\nfunction createToggle(key, getState, onChange) {\n    const toggle = document.createElement('label');\n    toggle.className = 'sidecar-menu-toggle';\n    const input = document.createElement('input');\n    input.type = 'checkbox';\n    input.className = 'sidecar-menu-toggle-input';\n    input.dataset.key = key;\n    const slider = document.createElement('span');\n    slider.className = 'sidecar-menu-toggle-slider';\n    // Set initial state\n    void getState().then((enabled) => {\n        input.checked = enabled;\n    });\n    // Handle change\n    input.addEventListener('change', () => {\n        onChange(input.checked);\n    });\n    // Prevent menu item click from toggling\n    toggle.addEventListener('click', (e) => {\n        e.stopPropagation();\n    });\n    toggle.appendChild(input);\n    toggle.appendChild(slider);\n    return toggle;\n}\n/**\n * Create the collapse button (separate from menu for header)\n */\nexport function CollapseButton(onClick) {\n    const btn = document.createElement('button');\n    btn.className = 'sidecar-collapse-btn';\n    btn.innerHTML = '<svg viewBox=\"0 0 24 24\"><path d=\"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\"/></svg>';\n    btn.title = 'Collapse to mini';\n    btn.addEventListener('click', onClick);\n    return btn;\n}\n","/**\n * Pattern Matchers for Patient Context Detection\n *\n * Defines detection patterns for various EMR systems including:\n * - Epic\n * - Cerner\n * - Athena\n * - Allscripts\n * - Generic/Legacy patterns\n *\n * These patterns are used by PatientContextDetector to identify patient\n * identifiers on webpages through data attributes, URL parameters, and DOM text.\n */\n// =============================================================================\n// Default Pattern Definitions\n// =============================================================================\n/**\n * Data attribute patterns for different EMR systems\n * These are checked first as they provide the most reliable detection\n */\nexport const DEFAULT_DATA_ATTRIBUTE_PATTERNS = [\n    // Selected patient context (highest priority - set by EMR when patient is selected)\n    // Check the hidden context element first (always present, always updated)\n    { attr: 'data-patient-mrn', type: 'mrn', source: 'context', selector: '#mobius-patient-context' },\n    // Then check visible detail panels\n    { attr: 'data-selected-patient-mrn', type: 'mrn', source: 'selected', selector: '.detail-panel[style*=\"block\"]' },\n    { attr: 'data-selected-patient-mrn', type: 'mrn', source: 'selected' },\n    // Epic patterns\n    { attr: 'data-patient-mrn', type: 'mrn', source: 'epic' },\n    { attr: 'data-patient-name', type: 'patient_key', source: 'epic' },\n    { attr: 'data-epic-mrn', type: 'mrn', source: 'epic' },\n    { attr: 'data-epic-patient-id', type: 'patient_key', source: 'epic' },\n    // Cerner patterns\n    { attr: 'data-cerner-mrn', type: 'mrn', source: 'cerner' },\n    { attr: 'data-cerner-patient', type: 'patient_key', source: 'cerner' },\n    { attr: 'data-cerner-patient-id', type: 'patient_key', source: 'cerner' },\n    // Athena patterns\n    { attr: 'data-athena-record-number', type: 'mrn', source: 'athena' },\n    { attr: 'data-athena-full-name', type: 'patient_key', source: 'athena' },\n    { attr: 'data-athena-patient-id', type: 'patient_key', source: 'athena' },\n    // Allscripts patterns\n    { attr: 'data-allscripts-id', type: 'mrn', source: 'allscripts' },\n    { attr: 'data-allscripts-name', type: 'patient_key', source: 'allscripts' },\n    { attr: 'data-allscripts-mrn', type: 'mrn', source: 'allscripts' },\n    // Netsmart (myAvatar) patterns\n    { attr: 'data-netsmart-mrn', type: 'mrn', source: 'netsmart' },\n    { attr: 'data-netsmart-client', type: 'patient_key', source: 'netsmart' },\n    // Qualifacts (CareLogic) patterns\n    { attr: 'data-qualifacts-mrn', type: 'mrn', source: 'qualifacts' },\n    { attr: 'data-qualifacts-client', type: 'patient_key', source: 'qualifacts' },\n    // Generic/legacy patterns (lowest priority)\n    { attr: 'data-id', type: 'mrn', source: 'legacy' },\n    { attr: 'data-name', type: 'patient_key', source: 'legacy' },\n    { attr: 'data-mrn', type: 'mrn', source: 'unknown' },\n    { attr: 'data-patient-id', type: 'patient_key', source: 'unknown' },\n    { attr: 'data-record-id', type: 'mrn', source: 'unknown' },\n];\n/**\n * URL patterns for extracting patient identifiers\n * Supports query parameters and path segments\n */\nexport const DEFAULT_URL_PATTERNS = [\n    // Query parameter patterns\n    { regex: /[?&]mrn=([^&]+)/i, type: 'mrn' },\n    { regex: /[?&]MRN=([^&]+)/, type: 'mrn' },\n    { regex: /[?&]patient_id=([^&]+)/i, type: 'patient_key' },\n    { regex: /[?&]patientId=([^&]+)/i, type: 'patient_key' },\n    { regex: /[?&]patient=([^&]+)/i, type: 'patient_key' },\n    { regex: /[?&]record_id=([^&]+)/i, type: 'mrn' },\n    { regex: /[?&]chart_id=([^&]+)/i, type: 'mrn' },\n    // Path segment patterns\n    { regex: /\\/patient\\/([A-Za-z0-9-]+)/i, type: 'patient_key' },\n    { regex: /\\/patients\\/([A-Za-z0-9-]+)/i, type: 'patient_key' },\n    { regex: /\\/chart\\/([A-Za-z0-9-]+)/i, type: 'mrn' },\n    { regex: /\\/record\\/([A-Za-z0-9-]+)/i, type: 'mrn' },\n    { regex: /\\/mrn\\/([A-Za-z0-9-]+)/i, type: 'mrn' },\n    // EMR-specific URL patterns\n    { regex: /\\/Epic\\/Patient\\/([A-Za-z0-9-]+)/i, type: 'patient_key' },\n    { regex: /\\/powerchart\\/patient\\/([A-Za-z0-9-]+)/i, type: 'patient_key' },\n    { regex: /\\/athenaone\\/patient\\/([A-Za-z0-9-]+)/i, type: 'patient_key' },\n];\n/**\n * DOM text patterns for extracting patient identifiers from page content\n * These are checked last as they can be less reliable\n */\nexport const DEFAULT_TEXT_PATTERNS = [\n    // MRN patterns\n    { regex: /MRN[:\\s]+([A-Z0-9-]+)/i, type: 'mrn' },\n    { regex: /Medical\\s*Record\\s*(?:Number|#|No\\.?)[:\\s]+([A-Z0-9-]+)/i, type: 'mrn' },\n    { regex: /Record\\s*#[:\\s]*([A-Z0-9-]+)/i, type: 'mrn' },\n    { regex: /Chart\\s*#[:\\s]*([A-Z0-9-]+)/i, type: 'mrn' },\n    // Patient ID patterns\n    { regex: /Patient\\s*ID[:\\s]+([A-Z0-9-]+)/i, type: 'patient_key' },\n    { regex: /Patient\\s*#[:\\s]*([A-Z0-9-]+)/i, type: 'patient_key' },\n    { regex: /Patient\\s*Number[:\\s]+([A-Z0-9-]+)/i, type: 'patient_key' },\n    // Account/encounter patterns\n    { regex: /Account\\s*#[:\\s]*([A-Z0-9-]+)/i, type: 'patient_key' },\n    { regex: /Encounter\\s*#[:\\s]*([A-Z0-9-]+)/i, type: 'patient_key' },\n];\n/**\n * Complete default pattern configuration\n */\nexport const DEFAULT_PATTERNS = {\n    dataAttributes: DEFAULT_DATA_ATTRIBUTE_PATTERNS,\n    urlPatterns: DEFAULT_URL_PATTERNS,\n    textPatterns: DEFAULT_TEXT_PATTERNS,\n};\n// =============================================================================\n// Pattern Matcher Functions\n// =============================================================================\n/**\n * Scan DOM elements for data attributes matching patient identifier patterns\n */\nexport function matchDataAttributes(patterns = DEFAULT_DATA_ATTRIBUTE_PATTERNS, root = document) {\n    // Debug: Check if mobius-patient-context exists\n    const contextEl = document.getElementById('mobius-patient-context');\n    if (contextEl) {\n        const contextMrn = contextEl.getAttribute('data-patient-mrn');\n        console.log('[PatternMatcher] Context element found, MRN:', contextMrn);\n        if (contextMrn && contextMrn.trim()) {\n            return {\n                id_type: 'mrn',\n                id_value: contextMrn.trim(),\n                source_hint: 'context',\n                confidence: 'high',\n                detected_at: new Date().toISOString(),\n            };\n        }\n    }\n    for (const pattern of patterns) {\n        const selector = pattern.selector\n            ? `${pattern.selector}[${pattern.attr}]`\n            : `[${pattern.attr}]`;\n        const element = root.querySelector(selector);\n        if (element) {\n            const value = element.getAttribute(pattern.attr);\n            if (value && value.trim()) {\n                console.log('[PatternMatcher] Found:', pattern.attr, '=', value, 'on', element.id || element.className);\n                return {\n                    id_type: pattern.type,\n                    id_value: value.trim(),\n                    source_hint: pattern.source,\n                    confidence: 'high',\n                    detected_at: new Date().toISOString(),\n                };\n            }\n        }\n    }\n    return null;\n}\n/**\n * Extract patient identifier from URL using defined patterns\n */\nexport function matchUrlPatterns(patterns = DEFAULT_URL_PATTERNS, url = window.location.href) {\n    for (const pattern of patterns) {\n        const regex = typeof pattern.regex === 'string'\n            ? new RegExp(pattern.regex)\n            : pattern.regex;\n        const match = url.match(regex);\n        if (match) {\n            const captureGroup = pattern.captureGroup ?? 1;\n            const value = match[captureGroup];\n            if (value && value.trim()) {\n                return {\n                    id_type: pattern.type,\n                    id_value: decodeURIComponent(value.trim()),\n                    source_hint: 'url',\n                    confidence: 'high',\n                    detected_at: new Date().toISOString(),\n                };\n            }\n        }\n    }\n    return null;\n}\n/**\n * Scan DOM text content for patient identifier patterns\n */\nexport function matchTextPatterns(patterns = DEFAULT_TEXT_PATTERNS, root = document) {\n    for (const pattern of patterns) {\n        const regex = typeof pattern.regex === 'string'\n            ? new RegExp(pattern.regex)\n            : pattern.regex;\n        // Get text content to search\n        let textContent;\n        if (pattern.selector) {\n            const element = root.querySelector(pattern.selector);\n            textContent = element?.textContent || '';\n        }\n        else {\n            // Search in common areas that typically contain patient info\n            const searchAreas = [\n                'header',\n                '[class*=\"patient\"]',\n                '[class*=\"header\"]',\n                '[class*=\"banner\"]',\n                '[id*=\"patient\"]',\n                'main',\n            ];\n            textContent = '';\n            for (const selector of searchAreas) {\n                const elements = root.querySelectorAll(selector);\n                elements.forEach(el => {\n                    textContent += ' ' + (el.textContent || '');\n                });\n            }\n            // Fallback to body if nothing found\n            if (!textContent.trim()) {\n                textContent = root.body?.textContent || '';\n            }\n        }\n        const match = textContent.match(regex);\n        if (match) {\n            const captureGroup = pattern.captureGroup ?? 1;\n            const value = match[captureGroup];\n            if (value && value.trim()) {\n                return {\n                    id_type: pattern.type,\n                    id_value: value.trim(),\n                    source_hint: 'text',\n                    confidence: 'medium',\n                    detected_at: new Date().toISOString(),\n                };\n            }\n        }\n    }\n    return null;\n}\n/**\n * Run all detection strategies in priority order\n */\nexport function detectPatient(strategies = ['dataAttributes', 'url', 'domText'], patterns = DEFAULT_PATTERNS) {\n    for (const strategy of strategies) {\n        let result = null;\n        switch (strategy) {\n            case 'dataAttributes':\n                result = matchDataAttributes(patterns.dataAttributes);\n                break;\n            case 'url':\n                result = matchUrlPatterns(patterns.urlPatterns);\n                break;\n            case 'domText':\n                result = matchTextPatterns(patterns.textPatterns);\n                break;\n        }\n        if (result) {\n            return result;\n        }\n    }\n    return null;\n}\n/**\n * Merge custom patterns with defaults\n */\nexport function mergePatterns(defaults, custom) {\n    return {\n        dataAttributes: [\n            ...(custom.dataAttributes || []),\n            ...defaults.dataAttributes,\n        ],\n        urlPatterns: [\n            ...(custom.urlPatterns || []),\n            ...defaults.urlPatterns,\n        ],\n        textPatterns: [\n            ...(custom.textPatterns || []),\n            ...defaults.textPatterns,\n        ],\n    };\n}\n/**\n * Convert backend pattern config (with string regexes) to runtime config\n */\nexport function parsePatternConfig(config) {\n    if (!config || typeof config !== 'object') {\n        return {};\n    }\n    const parsed = {};\n    const c = config;\n    if (Array.isArray(c.dataAttributes)) {\n        parsed.dataAttributes = c.dataAttributes;\n    }\n    if (Array.isArray(c.urlPatterns)) {\n        parsed.urlPatterns = c.urlPatterns\n            .map(p => ({\n            regex: new RegExp(p.regex),\n            type: p.type,\n            captureGroup: p.captureGroup,\n        }));\n    }\n    if (Array.isArray(c.textPatterns)) {\n        parsed.textPatterns = c.textPatterns\n            .map(p => ({\n            regex: new RegExp(p.regex),\n            type: p.type,\n            captureGroup: p.captureGroup,\n            selector: p.selector,\n        }));\n    }\n    return parsed;\n}\n","/**\n * Patient Context Detector Service\n *\n * A reusable service that monitors webpages for patient identifiers\n * and emits events when patient context is detected or changes.\n *\n * Features:\n * - MutationObserver for DOM change detection\n * - Multi-strategy detection (data attributes, URL, DOM text)\n * - Debouncing to avoid excessive API calls\n * - Event-based notification system\n * - Configurable patterns with tenant overrides\n */\nimport { DEFAULT_PATTERNS, detectPatient, mergePatterns, parsePatternConfig, } from './patternMatchers';\n/**\n * Default detector options\n */\nconst DEFAULT_OPTIONS = {\n    debounceMs: 500,\n    strategies: ['dataAttributes', 'url', 'domText'],\n    customPatterns: {},\n    autoStart: false,\n    observeMutations: true,\n};\n/**\n * PatientContextDetector - Monitors webpages for patient identifiers\n *\n * Usage:\n * ```typescript\n * const detector = new PatientContextDetector({ debounceMs: 500 });\n *\n * detector.on('patientDetected', (patient) => {\n *   console.log('Patient detected:', patient);\n * });\n *\n * detector.start();\n * ```\n */\nexport class PatientContextDetector {\n    constructor(options = {}) {\n        this.observer = null;\n        this.debounceTimer = null;\n        this.isRunning = false;\n        this.currentPatient = null;\n        this.listeners = new Map();\n        this.lastUrl = '';\n        this.options = { ...DEFAULT_OPTIONS, ...options };\n        this.patterns = mergePatterns(DEFAULT_PATTERNS, this.options.customPatterns || {});\n        // Initialize listener maps\n        this.listeners.set('patientDetected', new Set());\n        this.listeners.set('patientChanged', new Set());\n        this.listeners.set('patientCleared', new Set());\n        this.listeners.set('detectionError', new Set());\n        if (this.options.autoStart) {\n            this.start();\n        }\n    }\n    /**\n     * Start monitoring for patient context\n     */\n    start() {\n        if (this.isRunning) {\n            console.log('[PatientContextDetector] Already running');\n            return;\n        }\n        console.log('[PatientContextDetector] Starting...');\n        this.isRunning = true;\n        this.lastUrl = window.location.href;\n        // Initial detection\n        this.scheduleDetection();\n        // Set up URL change detection (for SPAs)\n        this.setupUrlChangeDetection();\n        // Set up MutationObserver if enabled\n        if (this.options.observeMutations) {\n            this.setupMutationObserver();\n        }\n    }\n    /**\n     * Stop monitoring for patient context\n     */\n    stop() {\n        if (!this.isRunning) {\n            return;\n        }\n        console.log('[PatientContextDetector] Stopping...');\n        this.isRunning = false;\n        // Cancel pending detection\n        if (this.debounceTimer !== null) {\n            window.clearTimeout(this.debounceTimer);\n            this.debounceTimer = null;\n        }\n        // Disconnect observer\n        if (this.observer) {\n            this.observer.disconnect();\n            this.observer = null;\n        }\n    }\n    /**\n     * Force an immediate detection scan\n     */\n    detect() {\n        try {\n            const patient = detectPatient(this.options.strategies, this.patterns);\n            this.handleDetectionResult(patient);\n            return patient;\n        }\n        catch (error) {\n            console.error('[PatientContextDetector] Detection error:', error);\n            this.emit('detectionError', null);\n            return null;\n        }\n    }\n    /**\n     * Subscribe to detection events\n     */\n    on(event, callback) {\n        const listeners = this.listeners.get(event);\n        if (listeners) {\n            listeners.add(callback);\n        }\n        // Return unsubscribe function\n        return () => this.off(event, callback);\n    }\n    /**\n     * Unsubscribe from detection events\n     */\n    off(event, callback) {\n        const listeners = this.listeners.get(event);\n        if (listeners) {\n            listeners.delete(callback);\n        }\n    }\n    /**\n     * Get the currently detected patient (if any)\n     */\n    getCurrentPatient() {\n        return this.currentPatient;\n    }\n    /**\n     * Update patterns (e.g., from tenant configuration)\n     */\n    updatePatterns(customPatterns) {\n        this.patterns = mergePatterns(DEFAULT_PATTERNS, customPatterns);\n        // Re-detect with new patterns\n        if (this.isRunning) {\n            this.scheduleDetection();\n        }\n    }\n    /**\n     * Update patterns from backend response (handles string -> RegExp conversion)\n     */\n    updatePatternsFromConfig(config) {\n        const parsed = parsePatternConfig(config);\n        this.updatePatterns(parsed);\n    }\n    /**\n     * Check if the detector is currently running\n     */\n    isActive() {\n        return this.isRunning;\n    }\n    // ===========================================================================\n    // Private Methods\n    // ===========================================================================\n    setupMutationObserver() {\n        this.observer = new MutationObserver((mutations) => {\n            // Filter for relevant mutations (avoid triggering on trivial changes)\n            const hasRelevantMutation = mutations.some(mutation => {\n                // Check for added/removed nodes\n                if (mutation.addedNodes.length > 0 || mutation.removedNodes.length > 0) {\n                    return true;\n                }\n                // Check for attribute changes on relevant elements\n                if (mutation.type === 'attributes') {\n                    const target = mutation.target;\n                    const attrName = mutation.attributeName || '';\n                    // Debug: log attribute changes\n                    if (attrName.includes('patient') || attrName.includes('mrn') || attrName.includes('selected')) {\n                        console.log('[PatientContextDetector] Attribute mutation:', attrName, 'on', target.id || target.className);\n                    }\n                    // Check if the attribute matches any of our patterns\n                    return this.patterns.dataAttributes.some(p => p.attr === attrName) ||\n                        attrName.includes('patient') ||\n                        attrName.includes('mrn') ||\n                        attrName.includes('id');\n                }\n                return false;\n            });\n            if (hasRelevantMutation) {\n                console.log('[PatientContextDetector] Relevant mutation detected, scheduling detection');\n                this.scheduleDetection();\n            }\n        });\n        // Observe the entire document - watch ALL attributes (no filter)\n        // to ensure we catch patient context changes\n        this.observer.observe(document.body, {\n            childList: true,\n            subtree: true,\n            attributes: true,\n            // Removed attributeFilter to catch all attribute changes\n            // The callback filters for relevant ones\n        });\n    }\n    setupUrlChangeDetection() {\n        // Use popstate for browser navigation\n        window.addEventListener('popstate', () => {\n            if (window.location.href !== this.lastUrl) {\n                this.lastUrl = window.location.href;\n                this.scheduleDetection();\n            }\n        });\n        // Use MutationObserver on <head> or <title> as a proxy for SPA navigation\n        // Many SPAs update the title when navigating\n        const titleObserver = new MutationObserver(() => {\n            if (window.location.href !== this.lastUrl) {\n                this.lastUrl = window.location.href;\n                this.scheduleDetection();\n            }\n        });\n        const titleElement = document.querySelector('title');\n        if (titleElement) {\n            titleObserver.observe(titleElement, { childList: true, characterData: true });\n        }\n        // Also check periodically for URL changes (handles edge cases)\n        setInterval(() => {\n            if (this.isRunning && window.location.href !== this.lastUrl) {\n                this.lastUrl = window.location.href;\n                this.scheduleDetection();\n            }\n        }, 1000);\n    }\n    scheduleDetection() {\n        // Cancel any pending detection\n        if (this.debounceTimer !== null) {\n            window.clearTimeout(this.debounceTimer);\n        }\n        // Schedule new detection\n        this.debounceTimer = window.setTimeout(() => {\n            this.debounceTimer = null;\n            this.detect();\n        }, this.options.debounceMs);\n    }\n    handleDetectionResult(patient) {\n        const previousPatient = this.currentPatient;\n        if (patient === null && previousPatient !== null) {\n            // Patient was cleared\n            this.currentPatient = null;\n            this.emit('patientCleared', null);\n            console.log('[PatientContextDetector] Patient context cleared');\n        }\n        else if (patient !== null && previousPatient === null) {\n            // New patient detected\n            this.currentPatient = patient;\n            this.emit('patientDetected', patient);\n            console.log('[PatientContextDetector] Patient detected:', patient);\n        }\n        else if (patient !== null && previousPatient !== null) {\n            // Check if patient changed\n            if (!this.isSamePatient(patient, previousPatient)) {\n                this.currentPatient = patient;\n                this.emit('patientChanged', patient);\n                console.log('[PatientContextDetector] Patient changed:', patient);\n            }\n            // If same patient, no event needed\n        }\n        // If both null, no event needed\n    }\n    isSamePatient(a, b) {\n        return a.id_type === b.id_type && a.id_value === b.id_value;\n    }\n    emit(event, patient) {\n        const listeners = this.listeners.get(event);\n        if (listeners) {\n            listeners.forEach(callback => {\n                try {\n                    callback(patient, event);\n                }\n                catch (error) {\n                    console.error(`[PatientContextDetector] Error in ${event} listener:`, error);\n                }\n            });\n        }\n    }\n}\n/**\n * Create a singleton instance for easy use\n */\nlet defaultDetector = null;\nexport function getDefaultDetector() {\n    if (!defaultDetector) {\n        defaultDetector = new PatientContextDetector({\n            debounceMs: 500,\n            strategies: ['dataAttributes', 'url', 'domText'],\n            observeMutations: true,\n        });\n    }\n    return defaultDetector;\n}\n/**\n * Utility function to reset the default detector (mainly for testing)\n */\nexport function resetDefaultDetector() {\n    if (defaultDetector) {\n        defaultDetector.stop();\n        defaultDetector = null;\n    }\n}\n","/**\n * Preferences Modal Component for User Awareness Sprint\n *\n * Allows users to edit their preferences:\n * - Profile (name, timezone)\n * - Activities\n * - AI Comfort Level\n * - Display preferences\n */\nimport { getAuthService } from '../../services/auth';\nimport { API_V1_URL } from '../../config';\nconst API_BASE = API_V1_URL;\n/**\n * Create the preferences modal component\n */\nexport async function PreferencesModal(props) {\n    const { preferences: initialPrefs, onSave, onClose } = props;\n    // Fetch available activities if not provided\n    let activities = props.activities || [];\n    if (activities.length === 0) {\n        try {\n            const response = await fetch(`${API_BASE}/auth/activities`);\n            const data = await response.json();\n            if (data.ok) {\n                activities = data.activities;\n            }\n        }\n        catch (error) {\n            console.error('[PreferencesModal] Error fetching activities:', error);\n        }\n    }\n    // Clone initial preferences for editing\n    const prefs = { ...initialPrefs };\n    const selectedActivities = [...(prefs.activities || [])];\n    const modal = document.createElement('div');\n    modal.className = 'mobius-prefs-modal';\n    let activeTab = 'profile';\n    const render = () => {\n        modal.innerHTML = `\n      <div class=\"mobius-prefs-backdrop\"></div>\n      <div class=\"mobius-prefs-container\">\n        <div class=\"mobius-prefs-header\">\n          <h2>My Preferences</h2>\n          <button class=\"mobius-prefs-close\" type=\"button\">\n            <svg viewBox=\"0 0 24 24\" width=\"18\" height=\"18\">\n              <path fill=\"currentColor\" d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>\n            </svg>\n          </button>\n        </div>\n        \n        <div class=\"mobius-prefs-tabs\">\n          <button class=\"mobius-prefs-tab ${activeTab === 'profile' ? 'active' : ''}\" data-tab=\"profile\">Profile</button>\n          <button class=\"mobius-prefs-tab ${activeTab === 'activities' ? 'active' : ''}\" data-tab=\"activities\">Activities</button>\n          <button class=\"mobius-prefs-tab ${activeTab === 'ai' ? 'active' : ''}\" data-tab=\"ai\">AI Comfort</button>\n          <button class=\"mobius-prefs-tab ${activeTab === 'display' ? 'active' : ''}\" data-tab=\"display\">Display</button>\n        </div>\n        \n        <div class=\"mobius-prefs-content\">\n          ${renderTabContent()}\n        </div>\n        \n        <div class=\"mobius-prefs-footer\">\n          <button class=\"mobius-prefs-btn-cancel\" type=\"button\">Cancel</button>\n          <button class=\"mobius-prefs-btn-save\" type=\"button\">Save Changes</button>\n        </div>\n      </div>\n    `;\n        wireEvents();\n    };\n    const renderTabContent = () => {\n        switch (activeTab) {\n            case 'profile':\n                return `\n          <div class=\"mobius-prefs-section\">\n            <label class=\"mobius-prefs-label\">Preferred Name</label>\n            <input type=\"text\" class=\"mobius-prefs-input\" id=\"pref-name\" \n                   value=\"${escapeHtml(prefs.preferred_name || '')}\" \n                   placeholder=\"How should we greet you?\" />\n          </div>\n          <div class=\"mobius-prefs-section\">\n            <label class=\"mobius-prefs-label\">Timezone</label>\n            <select class=\"mobius-prefs-select\" id=\"pref-timezone\">\n              <option value=\"America/New_York\" ${prefs.timezone === 'America/New_York' ? 'selected' : ''}>Eastern Time (ET)</option>\n              <option value=\"America/Chicago\" ${prefs.timezone === 'America/Chicago' ? 'selected' : ''}>Central Time (CT)</option>\n              <option value=\"America/Denver\" ${prefs.timezone === 'America/Denver' ? 'selected' : ''}>Mountain Time (MT)</option>\n              <option value=\"America/Los_Angeles\" ${prefs.timezone === 'America/Los_Angeles' ? 'selected' : ''}>Pacific Time (PT)</option>\n            </select>\n          </div>\n        `;\n            case 'activities':\n                return `\n          <p class=\"mobius-prefs-desc\">Select the activities you work on. This helps Mobius show you relevant quick actions and tasks.</p>\n          <div class=\"mobius-prefs-activities\">\n            ${activities.map(a => `\n              <label class=\"mobius-prefs-activity ${selectedActivities.includes(a.activity_code) ? 'selected' : ''}\">\n                <input type=\"checkbox\" value=\"${a.activity_code}\" ${selectedActivities.includes(a.activity_code) ? 'checked' : ''} />\n                <span class=\"mobius-prefs-activity-check\">\n                  <svg viewBox=\"0 0 24 24\" width=\"14\" height=\"14\">\n                    <path fill=\"currentColor\" d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\"/>\n                  </svg>\n                </span>\n                <span>${escapeHtml(a.label)}</span>\n              </label>\n            `).join('')}\n          </div>\n        `;\n            case 'ai':\n                return `\n          <div class=\"mobius-prefs-section\">\n            <label class=\"mobius-prefs-label\">For routine tasks (eligibility checks, status updates):</label>\n            <div class=\"mobius-prefs-options\">\n              <label class=\"mobius-prefs-option ${prefs.autonomy_routine_tasks === 'automatic' ? 'selected' : ''}\">\n                <input type=\"radio\" name=\"routine\" value=\"automatic\" ${prefs.autonomy_routine_tasks === 'automatic' ? 'checked' : ''} />\n                <span>Do it automatically</span>\n              </label>\n              <label class=\"mobius-prefs-option ${prefs.autonomy_routine_tasks === 'confirm_first' ? 'selected' : ''}\">\n                <input type=\"radio\" name=\"routine\" value=\"confirm_first\" ${prefs.autonomy_routine_tasks === 'confirm_first' ? 'checked' : ''} />\n                <span>Show me first, then confirm</span>\n              </label>\n              <label class=\"mobius-prefs-option ${prefs.autonomy_routine_tasks === 'manual' ? 'selected' : ''}\">\n                <input type=\"radio\" name=\"routine\" value=\"manual\" ${prefs.autonomy_routine_tasks === 'manual' ? 'checked' : ''} />\n                <span>Just guide me, I'll do it</span>\n              </label>\n            </div>\n          </div>\n          <div class=\"mobius-prefs-section\">\n            <label class=\"mobius-prefs-label\">For sensitive tasks (billing, patient records):</label>\n            <div class=\"mobius-prefs-options\">\n              <label class=\"mobius-prefs-option ${prefs.autonomy_sensitive_tasks === 'automatic' ? 'selected' : ''}\">\n                <input type=\"radio\" name=\"sensitive\" value=\"automatic\" ${prefs.autonomy_sensitive_tasks === 'automatic' ? 'checked' : ''} />\n                <span>Do it automatically</span>\n              </label>\n              <label class=\"mobius-prefs-option ${prefs.autonomy_sensitive_tasks === 'confirm_first' ? 'selected' : ''}\">\n                <input type=\"radio\" name=\"sensitive\" value=\"confirm_first\" ${prefs.autonomy_sensitive_tasks === 'confirm_first' ? 'checked' : ''} />\n                <span>Always show me before acting</span>\n              </label>\n              <label class=\"mobius-prefs-option ${prefs.autonomy_sensitive_tasks === 'manual' ? 'selected' : ''}\">\n                <input type=\"radio\" name=\"sensitive\" value=\"manual\" ${prefs.autonomy_sensitive_tasks === 'manual' ? 'checked' : ''} />\n                <span>Never act without my approval</span>\n              </label>\n            </div>\n          </div>\n        `;\n            case 'display':\n                return `\n          <div class=\"mobius-prefs-section\">\n            <label class=\"mobius-prefs-label\">Communication Tone</label>\n            <div class=\"mobius-prefs-options\">\n              <label class=\"mobius-prefs-option ${prefs.tone === 'professional' ? 'selected' : ''}\">\n                <input type=\"radio\" name=\"tone\" value=\"professional\" ${prefs.tone === 'professional' ? 'checked' : ''} />\n                <span>Professional</span>\n              </label>\n              <label class=\"mobius-prefs-option ${prefs.tone === 'friendly' ? 'selected' : ''}\">\n                <input type=\"radio\" name=\"tone\" value=\"friendly\" ${prefs.tone === 'friendly' ? 'checked' : ''} />\n                <span>Friendly</span>\n              </label>\n              <label class=\"mobius-prefs-option ${prefs.tone === 'concise' ? 'selected' : ''}\">\n                <input type=\"radio\" name=\"tone\" value=\"concise\" ${prefs.tone === 'concise' ? 'checked' : ''} />\n                <span>Concise</span>\n              </label>\n            </div>\n          </div>\n          <div class=\"mobius-prefs-section\">\n            <label class=\"mobius-prefs-toggle\">\n              <input type=\"checkbox\" id=\"pref-greeting\" ${prefs.greeting_enabled ? 'checked' : ''} />\n              <span class=\"mobius-prefs-toggle-slider\"></span>\n              <span class=\"mobius-prefs-toggle-label\">Show personalized greeting</span>\n            </label>\n          </div>\n        `;\n            default:\n                return '';\n        }\n    };\n    const wireEvents = () => {\n        // Close button\n        modal.querySelector('.mobius-prefs-close')?.addEventListener('click', onClose);\n        modal.querySelector('.mobius-prefs-backdrop')?.addEventListener('click', onClose);\n        // Cancel button\n        modal.querySelector('.mobius-prefs-btn-cancel')?.addEventListener('click', onClose);\n        // Save button\n        modal.querySelector('.mobius-prefs-btn-save')?.addEventListener('click', async () => {\n            await savePreferences();\n        });\n        // Tabs\n        modal.querySelectorAll('.mobius-prefs-tab').forEach(tab => {\n            tab.addEventListener('click', () => {\n                activeTab = tab.dataset.tab || 'profile';\n                render();\n            });\n        });\n        // Profile inputs\n        modal.querySelector('#pref-name')?.addEventListener('input', (e) => {\n            prefs.preferred_name = e.target.value;\n        });\n        modal.querySelector('#pref-timezone')?.addEventListener('change', (e) => {\n            prefs.timezone = e.target.value;\n        });\n        // Activities checkboxes\n        modal.querySelectorAll('.mobius-prefs-activity input').forEach(cb => {\n            cb.addEventListener('change', (e) => {\n                const code = e.target.value;\n                const checked = e.target.checked;\n                const label = e.target.closest('.mobius-prefs-activity');\n                if (checked) {\n                    if (!selectedActivities.includes(code)) {\n                        selectedActivities.push(code);\n                    }\n                    label?.classList.add('selected');\n                }\n                else {\n                    const idx = selectedActivities.indexOf(code);\n                    if (idx > -1) {\n                        selectedActivities.splice(idx, 1);\n                    }\n                    label?.classList.remove('selected');\n                }\n                prefs.activities = [...selectedActivities];\n            });\n        });\n        // Radio buttons\n        ['routine', 'sensitive', 'tone'].forEach(name => {\n            modal.querySelectorAll(`input[name=\"${name}\"]`).forEach(r => {\n                r.addEventListener('change', (e) => {\n                    const value = e.target.value;\n                    if (name === 'routine')\n                        prefs.autonomy_routine_tasks = value;\n                    if (name === 'sensitive')\n                        prefs.autonomy_sensitive_tasks = value;\n                    if (name === 'tone')\n                        prefs.tone = value;\n                    updateRadioStyles(name);\n                });\n            });\n        });\n        // Greeting toggle\n        modal.querySelector('#pref-greeting')?.addEventListener('change', (e) => {\n            prefs.greeting_enabled = e.target.checked;\n        });\n    };\n    const updateRadioStyles = (name) => {\n        modal.querySelectorAll(`input[name=\"${name}\"]`).forEach(r => {\n            const label = r.closest('.mobius-prefs-option');\n            if (r.checked) {\n                label?.classList.add('selected');\n            }\n            else {\n                label?.classList.remove('selected');\n            }\n        });\n    };\n    const savePreferences = async () => {\n        const saveBtn = modal.querySelector('.mobius-prefs-btn-save');\n        if (saveBtn) {\n            saveBtn.textContent = 'Saving...';\n            saveBtn.disabled = true;\n        }\n        try {\n            const authService = getAuthService();\n            const token = await authService.getAccessToken();\n            if (token) {\n                const response = await fetch(`${API_BASE}/auth/preferences`, {\n                    method: 'PUT',\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        preferred_name: prefs.preferred_name,\n                        timezone: prefs.timezone,\n                        activities: selectedActivities,\n                        tone: prefs.tone,\n                        greeting_enabled: prefs.greeting_enabled,\n                        autonomy_routine_tasks: prefs.autonomy_routine_tasks,\n                        autonomy_sensitive_tasks: prefs.autonomy_sensitive_tasks,\n                    }),\n                });\n                if (response.ok) {\n                    console.log('[PreferencesModal] Preferences saved');\n                    // Refresh user profile from backend to get updated data\n                    const updatedUser = await authService.getCurrentUser();\n                    if (updatedUser) {\n                        console.log('[PreferencesModal] User profile refreshed:', updatedUser);\n                    }\n                    prefs.activities = [...selectedActivities];\n                    onSave(prefs);\n                }\n                else {\n                    const errData = await response.json().catch(() => ({}));\n                    console.error('[PreferencesModal] Error saving preferences:', errData);\n                    alert('Failed to save preferences. Please try again.');\n                }\n            }\n        }\n        catch (error) {\n            console.error('[PreferencesModal] Error saving preferences:', error);\n            alert('Failed to save preferences. Please try again.');\n        }\n        finally {\n            if (saveBtn) {\n                saveBtn.textContent = 'Save Changes';\n                saveBtn.disabled = false;\n            }\n        }\n    };\n    // Initial render\n    render();\n    return modal;\n}\n/**\n * Escape HTML to prevent XSS\n */\nfunction escapeHtml(text) {\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n/**\n * CSS styles for preferences modal\n */\nexport const PREFERENCES_MODAL_STYLES = `\n.mobius-prefs-modal {\n  position: fixed;\n  inset: 0;\n  z-index: 10000;\n}\n\n.mobius-prefs-backdrop {\n  position: absolute;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.5);\n}\n\n.mobius-prefs-container {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: white;\n  border-radius: 12px;\n  width: 90%;\n  max-width: 420px;\n  max-height: 85vh;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);\n}\n\n.mobius-prefs-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.mobius-prefs-header h2 {\n  margin: 0;\n  font-size: 14px;\n  font-weight: 600;\n  color: #0b1220;\n}\n\n.mobius-prefs-close {\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 4px;\n  color: #64748b;\n}\n\n.mobius-prefs-close:hover {\n  color: #374151;\n}\n\n.mobius-prefs-tabs {\n  display: flex;\n  border-bottom: 1px solid #e2e8f0;\n  padding: 0 12px;\n}\n\n.mobius-prefs-tab {\n  padding: 10px 12px;\n  background: none;\n  border: none;\n  border-bottom: 2px solid transparent;\n  font-size: 11px;\n  color: #64748b;\n  cursor: pointer;\n  transition: all 0.15s;\n}\n\n.mobius-prefs-tab:hover {\n  color: #374151;\n}\n\n.mobius-prefs-tab.active {\n  color: #3b82f6;\n  border-bottom-color: #3b82f6;\n}\n\n.mobius-prefs-content {\n  flex: 1;\n  overflow-y: auto;\n  padding: 16px 20px;\n}\n\n.mobius-prefs-section {\n  margin-bottom: 16px;\n}\n\n.mobius-prefs-section:last-child {\n  margin-bottom: 0;\n}\n\n.mobius-prefs-label {\n  display: block;\n  font-size: 11px;\n  font-weight: 500;\n  color: #374151;\n  margin-bottom: 8px;\n}\n\n.mobius-prefs-desc {\n  font-size: 10px;\n  color: #64748b;\n  margin: 0 0 12px;\n}\n\n.mobius-prefs-input,\n.mobius-prefs-select {\n  width: 100%;\n  padding: 8px 10px;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  font-size: 12px;\n  box-sizing: border-box;\n}\n\n.mobius-prefs-input:focus,\n.mobius-prefs-select:focus {\n  outline: none;\n  border-color: #3b82f6;\n}\n\n/* Activities */\n.mobius-prefs-activities {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n}\n\n.mobius-prefs-activity {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 10px;\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 10px;\n  color: #374151;\n  transition: all 0.15s;\n}\n\n.mobius-prefs-activity:hover {\n  background: #f1f5f9;\n}\n\n.mobius-prefs-activity.selected {\n  background: #eff6ff;\n  border-color: #3b82f6;\n}\n\n.mobius-prefs-activity input {\n  display: none;\n}\n\n.mobius-prefs-activity-check {\n  width: 14px;\n  height: 14px;\n  border: 1px solid #cbd5e1;\n  border-radius: 3px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n}\n\n.mobius-prefs-activity.selected .mobius-prefs-activity-check {\n  background: #3b82f6;\n  border-color: #3b82f6;\n}\n\n/* Options */\n.mobius-prefs-options {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.mobius-prefs-option {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 12px;\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 11px;\n  color: #374151;\n  transition: all 0.15s;\n}\n\n.mobius-prefs-option:hover {\n  background: #f1f5f9;\n}\n\n.mobius-prefs-option.selected {\n  background: #eff6ff;\n  border-color: #3b82f6;\n}\n\n.mobius-prefs-option input {\n  display: none;\n}\n\n/* Toggle */\n.mobius-prefs-toggle {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  cursor: pointer;\n}\n\n.mobius-prefs-toggle input {\n  display: none;\n}\n\n.mobius-prefs-toggle-slider {\n  width: 36px;\n  height: 20px;\n  background: #e2e8f0;\n  border-radius: 10px;\n  position: relative;\n  transition: background 0.2s;\n}\n\n.mobius-prefs-toggle-slider::after {\n  content: '';\n  position: absolute;\n  width: 16px;\n  height: 16px;\n  background: white;\n  border-radius: 50%;\n  top: 2px;\n  left: 2px;\n  transition: transform 0.2s;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n}\n\n.mobius-prefs-toggle input:checked + .mobius-prefs-toggle-slider {\n  background: #3b82f6;\n}\n\n.mobius-prefs-toggle input:checked + .mobius-prefs-toggle-slider::after {\n  transform: translateX(16px);\n}\n\n.mobius-prefs-toggle-label {\n  font-size: 11px;\n  color: #374151;\n}\n\n/* Footer */\n.mobius-prefs-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 10px;\n  padding: 16px 20px;\n  border-top: 1px solid #e2e8f0;\n}\n\n.mobius-prefs-btn-cancel {\n  padding: 8px 16px;\n  background: none;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  font-size: 11px;\n  color: #64748b;\n  cursor: pointer;\n}\n\n.mobius-prefs-btn-cancel:hover {\n  background: #f8fafc;\n}\n\n.mobius-prefs-btn-save {\n  padding: 8px 16px;\n  background: #3b82f6;\n  border: none;\n  border-radius: 6px;\n  font-size: 11px;\n  font-weight: 500;\n  color: white;\n  cursor: pointer;\n}\n\n.mobius-prefs-btn-save:hover {\n  background: #2563eb;\n}\n`;\n","/**\n * Content script for Mobius OS extension\n * Injects the Mobius OS sidebar into web pages\n */\nimport './styles/sidebar.css';\nimport { API_BASE_URL } from './config';\nimport { getOrCreateSessionId } from './utils/session';\nimport { fetchMiniStatus, searchMiniPatients, sendChatMessage, submitMiniNote, submitAttentionStatus, reportIssue, resolvePatientContext, fetchDetectionConfig } from './services/api';\nimport { getUiDefaultsForMode } from './utils/uiDefaults';\nimport { getLayoutForMode } from './utils/modeLayout';\nimport { renderSection } from './utils/uiLayout';\nimport { ClientLogo, MobiusLogo, ContextDisplay, AlertButton, SettingsButton, ContextSummary, QuickActionButton, TasksPanel, ChatArea, ChatInput, RecordIDInput, WorkflowButtons, UserDetails, PreferencesPanel, \n// Sidecar components\nStatusBar, BottleneckCard, ContextExpander, QuickChat, SidecarMenu, CollapseButton, AlertIndicator } from './components';\nimport * as ToastManager from './services/toastManager';\nimport { createPatientContext, buildPrivacyContext, PrivacyMode } from './services/personalization';\nimport { PatientContextDetector } from './services/patientContextDetector';\nimport { getAuthService } from './services/auth';\nimport { PreferencesModal, PREFERENCES_MODAL_STYLES } from './components/settings/PreferencesModal';\nconst componentRegistry = {\n    contextSummary: ContextSummary,\n    quickActionButton: QuickActionButton,\n    recordIdInput: RecordIDInput,\n    workflowButtons: WorkflowButtons,\n    tasksPanel: TasksPanel,\n    chatInput: ChatInput,\n};\n// App state\nlet sessionId;\nlet messages = [];\nlet mobiusStatus = 'idle';\nlet currentMode = 'Chat';\nlet currentStatus = 'proceed';\nlet recordType = 'Patient ID';\nlet recordId = '';\nlet llmChoice = 'Gemini';\nlet agentMode = 'Agentic';\nlet tasks = [];\nlet sidebarContainer = null;\n// Mode icon mapping for tasking display\nconst getModeIcon = (mode) => {\n    switch (mode) {\n        case 'agentic': return '';\n        case 'copilot': return '';\n        case 'user_driven': return '';\n        default: return '';\n    }\n};\nconst MINI_IDS = {\n    root: 'mobius-os-mini',\n    modal: 'mobius-os-mini-modal',\n    toast: 'mobius-os-mini-toast',\n    sidebar: 'mobius-os-sidebar',\n    pageAdjust: 'mobius-os-page-adjust',\n};\nconst STORAGE_KEYS = {\n    allowedDomains: 'mobius.allowedDomains',\n    miniPos: 'mobius.miniPos',\n    patientOverride: 'mobius.patientOverride',\n    miniTheme: 'mobius.miniTheme',\n};\n// Apply theme class to Mini widget\nfunction applyMiniTheme(root, theme) {\n    root.classList.remove('theme-light', 'theme-dark', 'theme-blue', 'theme-glass');\n    root.classList.add(`theme-${theme}`);\n}\n// Save theme to Chrome storage\nasync function saveMiniTheme(theme) {\n    try {\n        await chrome.storage.local.set({ [STORAGE_KEYS.miniTheme]: theme });\n    }\n    catch (e) {\n        console.warn('[Mobius] Failed to save theme:', e);\n    }\n}\n// Load theme from Chrome storage\nasync function loadMiniTheme() {\n    try {\n        const result = await chrome.storage.local.get(STORAGE_KEYS.miniTheme);\n        return result[STORAGE_KEYS.miniTheme] || 'light';\n    }\n    catch {\n        return 'light';\n    }\n}\nlet miniLastPos = null;\nlet miniProceed = { color: 'grey', text: 'Proceed: Not assessed' };\nlet miniTasking = { color: 'grey', text: 'Tasking: Not applicable' };\nlet patientOverride = null;\n// Patient Context Detection\nlet patientContextDetector = null;\nlet autoDetectedPatient = null;\nlet isAutoDetectionEnabled = true; // Re-enabled for patient context detection\n// Needs Attention state (new UI)\nlet needsAttention = { color: 'grey', problemStatement: null, userStatus: null };\nlet taskCount = 0;\n// Resolution Plan state (action-centric UI)\nlet resolutionPlan = null;\nlet actionsForUser = 0;\n// Sidecar state\nlet sidecarState = null;\nlet sidecarPrivacyMode = false;\n// Initialize toast manager on load\nlet toastManagerInitialized = false;\nasync function initToastManager() {\n    if (toastManagerInitialized)\n        return;\n    try {\n        await ToastManager.init({\n            onAction: (toastId, actionId) => {\n                console.log('[Mobius] Toast action:', toastId, actionId);\n                // Handle reminder actions\n                if (actionId === 'hand_to_mobius') {\n                    // TODO: Implement hand back to Mobius\n                }\n            },\n            onJumpToPatient: async (patientKey) => {\n                console.log('[Mobius] Jump to patient:', patientKey);\n                // Load patient context and open sidecar\n                patientOverride = { name: 'Patient', id: patientKey };\n                await storageSet({ [STORAGE_KEYS.patientOverride]: patientOverride });\n                await expandToSidebar();\n            },\n        });\n        // Start polling for alerts\n        ToastManager.startPolling();\n        toastManagerInitialized = true;\n        console.log('[Mobius] Toast manager initialized');\n    }\n    catch (error) {\n        console.error('[Mobius] Failed to initialize toast manager:', error);\n    }\n}\n/**\n * Update the unified status row with priority question.\n * The question text replaces the problem statement, and the dropdown shows answer options.\n *\n * Color comes from backend (payment probability):\n * - Green: >= 85% probability\n * - Yellow: 60-84% probability\n * - Red: < 60% probability\n * - Grey: No data / insufficient info\n * - Blue: System error\n * - Purple: Policy override\n */\nfunction updateStepPreviewGlobal() {\n    const mini = document.getElementById(MINI_IDS.root);\n    if (!mini)\n        return;\n    const questionEl = mini.querySelector('.mobius-mini-question-text');\n    const badgeText = mini.querySelector('.mobius-mini-badge-text');\n    const dot = mini.querySelector('.mobius-mini-attention-row .mobius-mini-dot');\n    if (!questionEl)\n        return;\n    // Get color from backend (based on payment probability)\n    const backendColor = needsAttention.color || 'grey';\n    // Check if we have a resolution plan\n    if (resolutionPlan) {\n        // Resolved plan - show \"No issues detected\"\n        if (resolutionPlan.status === 'resolved') {\n            questionEl.textContent = 'No issues detected';\n            questionEl.title = resolutionPlan.resolution_notes || 'All checks passed';\n            if (badgeText)\n                badgeText.textContent = 'Resolved ';\n            // Use green for resolved, regardless of probability\n            if (dot)\n                dot.className = 'mobius-mini-dot dot-green';\n            return;\n        }\n        // Active plan with current step that matches user's role - show question\n        if (resolutionPlan.current_step) {\n            const step = resolutionPlan.current_step;\n            const maxLen = 50;\n            const text = step.question_text || 'Action required';\n            questionEl.textContent = text.length > maxLen ? text.slice(0, maxLen) + '...' : text;\n            questionEl.title = step.question_text || '';\n            if (badgeText)\n                badgeText.textContent = 'Set status ';\n            // Use backend color (from payment probability)\n            if (dot)\n                dot.className = `mobius-mini-dot ${colorToCssClass(backendColor)}`;\n            return;\n        }\n        // Active plan but NO current step for this user's role\n        // Check if there are tasks for other roles\n        const otherRoleTasks = resolutionPlan.other_role_tasks || 0;\n        if (otherRoleTasks > 0) {\n            questionEl.textContent = 'Waiting on another team member';\n            questionEl.title = `${otherRoleTasks} task(s) assigned to other roles`;\n            if (badgeText)\n                badgeText.textContent = 'Pending';\n            // Use backend color\n            if (dot)\n                dot.className = `mobius-mini-dot ${colorToCssClass(backendColor)}`;\n            return;\n        }\n        // Active plan, all steps complete for everyone\n        questionEl.textContent = 'All steps completed';\n        if (badgeText)\n            badgeText.textContent = 'Complete ';\n        if (dot)\n            dot.className = 'mobius-mini-dot dot-green';\n        return;\n    }\n    // No resolution plan - fallback to legacy behavior\n    questionEl.textContent = needsAttention.problemStatement || 'No issues detected';\n    if (badgeText)\n        badgeText.textContent = 'Set status';\n    // Use backend color\n    if (dot)\n        dot.className = `mobius-mini-dot ${colorToCssClass(backendColor)}`;\n}\n/**\n * Update the task count badge in Mini (global function).\n */\nfunction updateTaskCountGlobal() {\n    const mini = document.getElementById(MINI_IDS.root);\n    if (!mini)\n        return;\n    const taskBadgeRow = mini.querySelector('.mobius-mini-task-badge-row');\n    if (!taskBadgeRow)\n        return;\n    const countEl = taskBadgeRow.querySelector('.mobius-mini-task-count');\n    const labelEl = taskBadgeRow.querySelector('.mobius-mini-task-label');\n    const count = actionsForUser > 0 ? actionsForUser : taskCount;\n    if (countEl)\n        countEl.textContent = String(count);\n    if (labelEl)\n        labelEl.textContent = count === 1 ? 'item remaining' : 'items remaining';\n    taskBadgeRow.style.display = count > 0 ? '' : 'none';\n}\n// User Awareness state\nlet isAuthenticated = false;\nlet currentUserProfile = null;\nlet currentPersonalization = null;\nlet greetingDismissed = false;\n// Polling for cross-tab sync\nlet statusPollInterval = null;\nconst STATUS_POLL_INTERVAL_MS = 10000; // Poll every 10 seconds\n/**\n * Start polling for status updates (for cross-tab sync).\n */\nfunction startStatusPolling() {\n    stopStatusPolling(); // Clear any existing interval\n    statusPollInterval = setInterval(async () => {\n        const patientKey = getCurrentPatientKey();\n        if (!patientKey)\n            return;\n        try {\n            const status = await fetchMiniStatus(sessionId, patientKey);\n            // Check if attention status changed\n            const newUserStatus = status.needs_attention?.user_status || null;\n            if (newUserStatus !== needsAttention.userStatus) {\n                console.log('[Mobius] Status changed via polling:', newUserStatus);\n                // Update state\n                if (status.needs_attention) {\n                    needsAttention = {\n                        color: status.needs_attention.color,\n                        problemStatement: status.needs_attention.problem_statement,\n                        userStatus: status.needs_attention.user_status,\n                    };\n                }\n                // Update UI\n                const mini = document.getElementById(MINI_IDS.root);\n                if (mini) {\n                    updateAttentionUI(mini);\n                }\n            }\n        }\n        catch (err) {\n            // Silently ignore polling errors\n            console.debug('[Mobius] Polling error:', err);\n        }\n    }, STATUS_POLL_INTERVAL_MS);\n    console.log('[Mobius] Status polling started');\n}\n/**\n * Stop polling for status updates.\n */\nfunction stopStatusPolling() {\n    if (statusPollInterval) {\n        clearInterval(statusPollInterval);\n        statusPollInterval = null;\n        console.log('[Mobius] Status polling stopped');\n    }\n}\n/**\n * Update the attention UI elements.\n */\nfunction updateAttentionUI(mini) {\n    let effectiveColor = needsAttention.color;\n    if (needsAttention.userStatus === 'resolved')\n        effectiveColor = 'green';\n    else if (needsAttention.userStatus === 'confirmed_unresolved')\n        effectiveColor = 'yellow';\n    else if (needsAttention.userStatus === 'unable_to_confirm')\n        effectiveColor = 'grey';\n    const attentionRow = mini.querySelector('.mobius-mini-attention-row');\n    if (attentionRow) {\n        const dot = attentionRow.querySelector('.mobius-mini-dot');\n        const text = attentionRow.querySelector('.mobius-mini-problem-text');\n        const statusBtn = attentionRow.querySelector('.mobius-mini-status-btn');\n        if (dot) {\n            dot.className = `mobius-mini-dot ${colorToCssClass(effectiveColor)}`;\n        }\n        if (text) {\n            if (needsAttention.userStatus === 'resolved') {\n                text.textContent = 'No issues detected';\n            }\n            else if (needsAttention.problemStatement) {\n                text.textContent = needsAttention.problemStatement;\n            }\n            else {\n                text.textContent = 'No issues detected';\n            }\n        }\n        if (statusBtn) {\n            if (needsAttention.userStatus === 'resolved') {\n                statusBtn.textContent = 'Resolved ';\n                statusBtn.className = 'mobius-mini-status-btn resolved';\n            }\n            else {\n                statusBtn.textContent = 'Set status ';\n                statusBtn.className = 'mobius-mini-status-btn';\n            }\n        }\n    }\n    // Update minimized info dot\n    const minimizedDot = mini.querySelector('.mobius-mini-minimized-info .mobius-mini-dot');\n    if (minimizedDot) {\n        minimizedDot.className = `mobius-mini-dot ${colorToCssClass(effectiveColor)}`;\n    }\n}\nfunction setVisible(el, visible) {\n    el.style.display = visible ? '' : 'none';\n}\nfunction getHostname() {\n    try {\n        return window.location.hostname.toLowerCase();\n    }\n    catch {\n        return '';\n    }\n}\nasync function storageGet(keys) {\n    return new Promise((resolve) => {\n        chrome.storage.local.get(keys, (items) => resolve(items));\n    });\n}\nasync function storageSet(items) {\n    return new Promise((resolve) => {\n        chrome.storage.local.set(items, () => resolve());\n    });\n}\nasync function getAllowedDomains() {\n    const res = await storageGet([STORAGE_KEYS.allowedDomains]);\n    const list = res[STORAGE_KEYS.allowedDomains];\n    return Array.isArray(list) ? list : [];\n}\nasync function setDomainAllowed(hostname, allowed) {\n    const host = (hostname || '').toLowerCase();\n    if (!host)\n        return;\n    const current = await getAllowedDomains();\n    const next = new Set(current.map((d) => String(d).toLowerCase()).filter(Boolean));\n    if (allowed)\n        next.add(host);\n    else\n        next.delete(host);\n    await storageSet({ [STORAGE_KEYS.allowedDomains]: Array.from(next).sort() });\n}\nasync function isDomainAllowed(hostname) {\n    const host = (hostname || '').toLowerCase();\n    if (!host)\n        return false;\n    const allowed = await getAllowedDomains();\n    return allowed.map((d) => d.toLowerCase()).includes(host);\n}\nfunction removeMini() {\n    const existing = document.getElementById(MINI_IDS.root);\n    if (existing)\n        existing.remove();\n    const modal = document.getElementById(MINI_IDS.modal);\n    if (modal)\n        modal.remove();\n    // Stop patient context detection when Mini is removed\n    stopPatientContextDetection();\n    // Stop status polling\n    stopStatusPolling();\n}\nfunction removeSidebar() {\n    const existingSidebar = document.getElementById(MINI_IDS.sidebar);\n    if (existingSidebar)\n        existingSidebar.remove();\n    const style = document.getElementById(MINI_IDS.pageAdjust);\n    if (style)\n        style.remove();\n    sidebarContainer = null;\n}\nfunction showToast(message) {\n    const existing = document.getElementById(MINI_IDS.toast);\n    if (existing)\n        existing.remove();\n    const toast = document.createElement('div');\n    toast.id = MINI_IDS.toast;\n    toast.className = 'mobius-mini-toast';\n    toast.textContent = message;\n    document.body.appendChild(toast);\n    window.setTimeout(() => toast.remove(), 1600);\n}\n/**\n * Smart positioning for dropdowns that adjusts based on viewport boundaries.\n * Returns CSS position properties for a dropdown anchored to an element.\n */\nfunction getSmartDropdownPosition(anchorRect, dropdownWidth, dropdownHeight, options = {}) {\n    const { preferAbove = true, gap = 8 } = options;\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n    const scrollX = window.scrollX;\n    const scrollY = window.scrollY;\n    let top;\n    let left;\n    let transformOrigin = 'top left';\n    // Vertical positioning\n    const spaceAbove = anchorRect.top;\n    const spaceBelow = viewportHeight - anchorRect.bottom;\n    if (preferAbove && spaceAbove >= dropdownHeight + gap) {\n        // Position above\n        top = anchorRect.top - dropdownHeight - gap;\n        transformOrigin = 'bottom';\n    }\n    else if (spaceBelow >= dropdownHeight + gap) {\n        // Position below\n        top = anchorRect.bottom + gap;\n        transformOrigin = 'top';\n    }\n    else if (spaceAbove > spaceBelow) {\n        // More space above, but not enough - position at top of viewport with some padding\n        top = Math.max(gap, anchorRect.top - dropdownHeight - gap);\n        transformOrigin = 'bottom';\n    }\n    else {\n        // More space below - position below with overflow\n        top = anchorRect.bottom + gap;\n        transformOrigin = 'top';\n    }\n    // Horizontal positioning\n    const spaceRight = viewportWidth - anchorRect.left;\n    const spaceLeft = anchorRect.right;\n    if (spaceRight >= dropdownWidth) {\n        // Align to left edge of anchor\n        left = anchorRect.left;\n        transformOrigin += ' left';\n    }\n    else if (spaceLeft >= dropdownWidth) {\n        // Align to right edge of anchor (dropdown extends left)\n        left = anchorRect.right - dropdownWidth;\n        transformOrigin += ' right';\n    }\n    else {\n        // Center as best we can, keeping within viewport\n        left = Math.max(gap, Math.min(anchorRect.left, viewportWidth - dropdownWidth - gap));\n        transformOrigin += ' center';\n    }\n    return { top, left, transformOrigin };\n}\nfunction colorToCssClass(color) {\n    switch (color) {\n        case 'green':\n            return 'dot-green';\n        case 'yellow':\n            return 'dot-yellow';\n        case 'blue':\n            return 'dot-blue';\n        case 'red':\n            return 'dot-red';\n        case 'purple':\n            return 'dot-purple';\n        case 'grey':\n        default:\n            return 'dot-grey';\n    }\n}\nasync function loadMiniPersistedState() {\n    const res = await storageGet([\n        STORAGE_KEYS.miniPos,\n        STORAGE_KEYS.patientOverride,\n    ]);\n    const pos = res[STORAGE_KEYS.miniPos];\n    if (pos && typeof pos.x === 'number' && typeof pos.y === 'number') {\n        miniLastPos = { x: pos.x, y: pos.y };\n    }\n    const p = res[STORAGE_KEYS.patientOverride];\n    if (p && typeof p.name === 'string' && typeof p.id === 'string') {\n        patientOverride = { name: p.name, id: p.id, dob: typeof p.dob === 'string' ? p.dob : undefined };\n    }\n}\nfunction clamp(n, min, max) {\n    return Math.max(min, Math.min(max, n));\n}\nfunction clampMiniPos(pos, rootEl) {\n    const rect = rootEl.getBoundingClientRect();\n    const margin = 8;\n    const maxX = window.innerWidth - rect.width - margin;\n    const maxY = window.innerHeight - rect.height - margin;\n    return {\n        x: clamp(pos.x, margin, Math.max(margin, maxX)),\n        y: clamp(pos.y, margin, Math.max(margin, maxY)),\n    };\n}\nasync function setMiniPos(rootEl, pos) {\n    const clamped = clampMiniPos(pos, rootEl);\n    rootEl.style.left = `${clamped.x}px`;\n    rootEl.style.top = `${clamped.y}px`;\n    miniLastPos = clamped;\n    await storageSet({ [STORAGE_KEYS.miniPos]: clamped });\n}\nfunction getPatientDisplay() {\n    // Priority: manual override > auto-detected > default\n    if (patientOverride) {\n        return patientOverride;\n    }\n    if (autoDetectedPatient?.found) {\n        return {\n            name: autoDetectedPatient.display_name || 'Unknown',\n            id: autoDetectedPatient.patient_key || '',\n            dob: '',\n        };\n    }\n    return { name: 'Unknown', id: '', dob: '' };\n}\n/**\n * Get the current patient key for API calls.\n * Prefers manual override, falls back to auto-detected.\n */\nfunction getCurrentPatientKey() {\n    if (patientOverride?.id) {\n        return patientOverride.id;\n    }\n    if (autoDetectedPatient?.found && autoDetectedPatient.patient_key) {\n        return autoDetectedPatient.patient_key;\n    }\n    return undefined;\n}\n/**\n * Handle auto-detected patient context from the detector.\n */\nasync function handleAutoDetectedPatient(detected) {\n    if (!detected) {\n        // Patient context cleared\n        if (autoDetectedPatient) {\n            autoDetectedPatient = null;\n            console.log('[Mobius] Auto-detected patient cleared');\n            // Re-render Mini with no patient\n            await renderMiniIfAllowed();\n        }\n        return;\n    }\n    // Resolve the detected patient via backend crosswalk\n    console.log('[Mobius] Resolving detected patient:', detected);\n    const resolved = await resolvePatientContext(detected);\n    if (resolved.found) {\n        autoDetectedPatient = resolved;\n        console.log('[Mobius] Patient resolved:', resolved);\n        // Auto-detection takes precedence - clear any stale manual override\n        // This ensures the sidebar always shows the patient currently visible in the EMR\n        if (patientOverride) {\n            console.log('[Mobius] Clearing patient override in favor of auto-detected patient');\n            patientOverride = null;\n            await storageSet({ [STORAGE_KEYS.patientOverride]: null });\n        }\n        // Update Mini widget with the detected patient\n        await updateMiniWithResolvedPatient(resolved);\n    }\n    else {\n        console.log('[Mobius] Patient not found in system:', detected);\n        // Keep the detection info even if not found (might be useful)\n        autoDetectedPatient = resolved;\n    }\n}\n/**\n * Update Mini widget with resolved patient data.\n */\nasync function updateMiniWithResolvedPatient(resolved) {\n    const mini = document.getElementById(MINI_IDS.root);\n    if (!mini)\n        return;\n    // Update patient display\n    const nameEl = mini.querySelector('.mobius-mini-patient-name');\n    const idEl = mini.querySelector('.mobius-mini-patient-id');\n    if (nameEl)\n        nameEl.textContent = resolved.display_name || 'Unknown';\n    if (idEl && resolved.id_masked)\n        idEl.textContent = `ID ${resolved.id_masked}`;\n    // Update minimized info patient name\n    const minimizedPatient = mini.querySelector('.mobius-mini-minimized-patient');\n    if (minimizedPatient)\n        minimizedPatient.textContent = resolved.display_name || 'Unknown';\n    // Fetch updated status for the detected patient\n    if (resolved.patient_key) {\n        try {\n            const status = await fetchMiniStatus(sessionId, resolved.patient_key);\n            // Update proceed/tasking state\n            miniProceed = status.proceed;\n            if (status.tasking) {\n                miniTasking = status.tasking;\n            }\n            // Update needs_attention\n            if (status.needs_attention) {\n                needsAttention = {\n                    color: status.needs_attention.color,\n                    problemStatement: status.needs_attention.problem_statement,\n                    userStatus: status.needs_attention.user_status,\n                };\n            }\n            taskCount = status.task_count || 0;\n            resolutionPlan = status.resolution_plan || null;\n            actionsForUser = status.actions_for_user || 0;\n            // Re-render Mini attention UI\n            const attentionRow = mini.querySelector('.mobius-mini-attention-row');\n            let effectiveColor = needsAttention.color;\n            if (needsAttention.userStatus === 'resolved')\n                effectiveColor = 'green';\n            else if (needsAttention.userStatus === 'confirmed_unresolved')\n                effectiveColor = 'yellow';\n            else if (needsAttention.userStatus === 'unable_to_confirm')\n                effectiveColor = 'grey';\n            if (attentionRow) {\n                const dot = attentionRow.querySelector('.mobius-mini-dot');\n                const text = attentionRow.querySelector('.mobius-mini-problem-text');\n                if (dot) {\n                    dot.className = `mobius-mini-dot ${colorToCssClass(effectiveColor)}`;\n                }\n                if (text) {\n                    if (needsAttention.userStatus === 'resolved') {\n                        text.textContent = 'Resolved';\n                    }\n                    else if (needsAttention.problemStatement) {\n                        text.textContent = needsAttention.problemStatement;\n                    }\n                    else {\n                        text.textContent = 'No issues detected';\n                    }\n                }\n            }\n            // Update minimized info dot\n            const minimizedDot = mini.querySelector('.mobius-mini-minimized-info .mobius-mini-dot');\n            if (minimizedDot) {\n                minimizedDot.className = `mobius-mini-dot ${colorToCssClass(effectiveColor)}`;\n            }\n            // Update task badge and step preview using global functions\n            updateTaskCountGlobal();\n            updateStepPreviewGlobal();\n            // Show toast for auto-detection\n            showToast(`Patient detected: ${resolved.display_name || 'Unknown'}`);\n            // Start polling for cross-tab sync\n            startStatusPolling();\n            // Also refresh Sidecar if it's open\n            if (document.getElementById('mobius-os-sidebar')) {\n                console.log('[Mobius] Refreshing Sidecar with new patient');\n                const miniState = {\n                    patient: { name: resolved.display_name || 'Unknown', id: resolved.patient_key || '' },\n                    resolutionPlan,\n                    userProfile: currentUserProfile,\n                    needsAttention,\n                };\n                await refreshSidecarState(miniState);\n            }\n        }\n        catch (err) {\n            console.error('[Mobius] Error fetching status for auto-detected patient:', err);\n        }\n    }\n}\n/**\n * Initialize the patient context detector.\n */\nfunction initPatientContextDetector() {\n    if (patientContextDetector) {\n        console.log('[Mobius] Patient context detector already initialized');\n        return;\n    }\n    patientContextDetector = new PatientContextDetector({\n        debounceMs: 500,\n        strategies: ['dataAttributes', 'url', 'domText'],\n        observeMutations: true,\n        autoStart: false,\n    });\n    // Subscribe to detection events\n    patientContextDetector.on('patientDetected', (detected) => {\n        if (isAutoDetectionEnabled && detected) {\n            void handleAutoDetectedPatient(detected);\n        }\n    });\n    patientContextDetector.on('patientChanged', (detected) => {\n        if (isAutoDetectionEnabled && detected) {\n            void handleAutoDetectedPatient(detected);\n        }\n    });\n    patientContextDetector.on('patientCleared', () => {\n        if (isAutoDetectionEnabled) {\n            void handleAutoDetectedPatient(null);\n        }\n    });\n    patientContextDetector.on('detectionError', () => {\n        console.warn('[Mobius] Patient detection error');\n    });\n    // Fetch tenant-specific detection config if available\n    void fetchDetectionConfig(window.location.hostname).then((config) => {\n        if (config && patientContextDetector) {\n            console.log('[Mobius] Applying tenant detection config:', config);\n            patientContextDetector.updatePatterns(config);\n        }\n    });\n    console.log('[Mobius] Patient context detector initialized');\n}\n/**\n * Start patient context detection (called after Mini is rendered).\n */\nfunction startPatientContextDetection() {\n    if (!patientContextDetector) {\n        initPatientContextDetector();\n    }\n    if (patientContextDetector && !patientContextDetector.isActive()) {\n        patientContextDetector.start();\n        console.log('[Mobius] Patient context detection started');\n    }\n}\n/**\n * Stop patient context detection.\n */\nfunction stopPatientContextDetection() {\n    if (patientContextDetector) {\n        patientContextDetector.stop();\n        console.log('[Mobius] Patient context detection stopped');\n    }\n}\nfunction openPatientModal(onSave) {\n    const existing = document.getElementById(MINI_IDS.modal);\n    if (existing)\n        existing.remove();\n    const modal = document.createElement('div');\n    modal.id = MINI_IDS.modal;\n    modal.className = 'mobius-mini-modal-overlay';\n    modal.innerHTML = `\n    <div class=\"mobius-mini-modal\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Edit patient\">\n      <div class=\"mobius-mini-modal-header\">\n        <div class=\"mobius-mini-modal-title\">Patient</div>\n        <button class=\"mobius-mini-modal-close\" type=\"button\" aria-label=\"Close\"></button>\n      </div>\n      <div class=\"mobius-mini-modal-body\">\n        <div class=\"mobius-mini-field\">\n          <div class=\"mobius-mini-field-label\">Name</div>\n          <div class=\"mobius-mini-search-input\">\n            <span class=\"mobius-mini-search-icon\" aria-hidden=\"true\">\n              <svg viewBox=\"0 0 24 24\"><path d=\"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.5 21.5 20 15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"/></svg>\n            </span>\n            <input class=\"mobius-mini-input mobius-mini-input-with-icon\" id=\"mobius-mini-patient-name\" autocomplete=\"off\" />\n          </div>\n          <div class=\"mobius-mini-suggestions\" data-for=\"name\" aria-label=\"Name suggestions\"></div>\n        </div>\n\n        <div class=\"mobius-mini-field\">\n          <div class=\"mobius-mini-field-label\">Patient ID</div>\n          <div class=\"mobius-mini-search-input\">\n            <span class=\"mobius-mini-search-icon\" aria-hidden=\"true\">\n              <svg viewBox=\"0 0 24 24\"><path d=\"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.5 21.5 20 15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"/></svg>\n            </span>\n            <input class=\"mobius-mini-input mobius-mini-input-with-icon\" id=\"mobius-mini-patient-id\" autocomplete=\"off\" />\n          </div>\n          <div class=\"mobius-mini-suggestions\" data-for=\"id\" aria-label=\"ID suggestions\"></div>\n        </div>\n\n        <div class=\"mobius-mini-field\">\n          <div class=\"mobius-mini-field-label\">Date of birth</div>\n          <input class=\"mobius-mini-input\" id=\"mobius-mini-patient-dob\" placeholder=\"YYYY-MM-DD\" inputmode=\"numeric\" autocomplete=\"bday\" />\n        </div>\n\n        <div class=\"mobius-mini-field-hint\">Start typing to search; select a suggestion to fill both fields.</div>\n      </div>\n      <div class=\"mobius-mini-modal-actions\">\n        <button class=\"mobius-mini-btn-secondary\" type=\"button\" data-action=\"cancel\">Cancel</button>\n        <button class=\"mobius-mini-btn-primary\" type=\"button\" data-action=\"save\">Save</button>\n      </div>\n    </div>\n  `;\n    document.body.appendChild(modal);\n    const close = () => modal.remove();\n    const closeBtn = modal.querySelector('.mobius-mini-modal-close');\n    closeBtn?.addEventListener('click', close);\n    modal.addEventListener('click', (e) => {\n        if (e.target === modal)\n            close();\n    });\n    const { name, id, dob } = getPatientDisplay();\n    const nameInput = modal.querySelector('#mobius-mini-patient-name');\n    const idInput = modal.querySelector('#mobius-mini-patient-id');\n    const dobInput = modal.querySelector('#mobius-mini-patient-dob');\n    if (nameInput)\n        nameInput.value = name;\n    if (idInput)\n        idInput.value = id;\n    if (dobInput)\n        dobInput.value = dob || '';\n    const nameSug = modal.querySelector('.mobius-mini-suggestions[data-for=\"name\"]');\n    const idSug = modal.querySelector('.mobius-mini-suggestions[data-for=\"id\"]');\n    let activeField = 'name';\n    let currentResults = [];\n    let activeIndex = -1;\n    let debounceTimer;\n    const clearSuggestions = () => {\n        currentResults = [];\n        activeIndex = -1;\n        if (nameSug)\n            nameSug.innerHTML = '';\n        if (idSug)\n            idSug.innerHTML = '';\n        if (nameSug)\n            nameSug.style.display = 'none';\n        if (idSug)\n            idSug.style.display = 'none';\n    };\n    const renderSuggestions = (target) => {\n        const el = target === 'name' ? nameSug : idSug;\n        if (!el)\n            return;\n        if (currentResults.length === 0) {\n            el.innerHTML = '';\n            el.style.display = 'none';\n            return;\n        }\n        el.style.display = 'block';\n        el.innerHTML = currentResults\n            .map((r, idx) => {\n            const cls = idx === activeIndex ? 'mobius-mini-suggestion active' : 'mobius-mini-suggestion';\n            const safeName = r.name.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n            const safeId = r.id.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n            return `<button type=\"button\" class=\"${cls}\" data-idx=\"${idx}\"><span class=\"name\">${safeName}</span><span class=\"id\">ID ${safeId}</span></button>`;\n        })\n            .join('');\n        // Click handler\n        el.querySelectorAll('.mobius-mini-suggestion').forEach((btn) => {\n            btn.addEventListener('click', () => {\n                const idx = Number(btn.getAttribute('data-idx') || '-1');\n                const chosen = currentResults[idx];\n                if (!chosen)\n                    return;\n                if (nameInput)\n                    nameInput.value = chosen.name;\n                if (idInput)\n                    idInput.value = chosen.id;\n                clearSuggestions();\n            });\n        });\n    };\n    const setResults = (target, results) => {\n        currentResults = results;\n        activeIndex = -1;\n        // Only show dropdown for the active field\n        if (target === 'name') {\n            if (idSug)\n                idSug.style.display = 'none';\n        }\n        else {\n            if (nameSug)\n                nameSug.style.display = 'none';\n        }\n        renderSuggestions(target);\n    };\n    const doSearch = (target, q) => {\n        const query = q.trim();\n        if (query.length < 2) {\n            clearSuggestions();\n            return;\n        }\n        if (debounceTimer)\n            window.clearTimeout(debounceTimer);\n        debounceTimer = window.setTimeout(async () => {\n            try {\n                const resp = await searchMiniPatients(query, 8);\n                setResults(target, Array.isArray(resp.results) ? resp.results : []);\n            }\n            catch {\n                // silently ignore; keep UI calm\n                clearSuggestions();\n            }\n        }, 180);\n    };\n    const onKeyDown = (e) => {\n        const isOpen = currentResults.length > 0;\n        if (!isOpen)\n            return;\n        if (e.key === 'ArrowDown') {\n            e.preventDefault();\n            activeIndex = Math.min(currentResults.length - 1, activeIndex + 1);\n            renderSuggestions(activeField);\n        }\n        else if (e.key === 'ArrowUp') {\n            e.preventDefault();\n            activeIndex = Math.max(0, activeIndex - 1);\n            renderSuggestions(activeField);\n        }\n        else if (e.key === 'Enter') {\n            if (activeIndex >= 0 && activeIndex < currentResults.length) {\n                e.preventDefault();\n                const chosen = currentResults[activeIndex];\n                if (nameInput)\n                    nameInput.value = chosen.name;\n                if (idInput)\n                    idInput.value = chosen.id;\n                clearSuggestions();\n            }\n        }\n        else if (e.key === 'Escape') {\n            clearSuggestions();\n        }\n    };\n    nameInput?.addEventListener('focus', () => {\n        activeField = 'name';\n    });\n    idInput?.addEventListener('focus', () => {\n        activeField = 'id';\n    });\n    nameInput?.addEventListener('input', () => doSearch('name', nameInput.value));\n    idInput?.addEventListener('input', () => doSearch('id', idInput.value));\n    nameInput?.addEventListener('keydown', onKeyDown);\n    idInput?.addEventListener('keydown', onKeyDown);\n    // Hide suggestions when clicking outside the modal card\n    modal.querySelector('.mobius-mini-modal')?.addEventListener('click', (e) => {\n        // allow clicks inside\n        e.stopPropagation();\n    });\n    modal.addEventListener('click', () => clearSuggestions());\n    modal.querySelector('[data-action=\"cancel\"]')?.addEventListener('click', close);\n    modal.querySelector('[data-action=\"save\"]')?.addEventListener('click', () => {\n        const dobValue = (dobInput?.value || '').trim();\n        const next = {\n            name: (nameInput?.value || '').trim() || 'Unknown',\n            id: (idInput?.value || '').trim(),\n            dob: dobValue,\n        };\n        onSave(next);\n        close();\n    });\n    nameInput?.focus();\n}\nfunction createMini() {\n    const root = document.createElement('div');\n    root.id = MINI_IDS.root;\n    root.className = 'mobius-mini';\n    // Header (drag handle + client logo + divider + Mobius logo + menu)\n    const header = document.createElement('div');\n    header.className = 'mobius-mini-header';\n    const dragHandle = document.createElement('div');\n    dragHandle.className = 'mobius-mini-drag-handle';\n    dragHandle.title = 'Drag';\n    dragHandle.innerHTML = '<div class=\"mobius-mini-drag-dots\"></div>';\n    // Client logo (Aspire Health FL for CMHC)\n    const clientLogoEl = ClientLogo({ clientName: 'CMHC', compact: true });\n    // Divider between client and Mobius branding\n    const brandDivider = document.createElement('div');\n    brandDivider.className = 'mobius-mini-brand-divider';\n    const brand = document.createElement('div');\n    brand.className = 'mobius-mini-brand';\n    brand.appendChild(clientLogoEl);\n    brand.appendChild(brandDivider);\n    brand.appendChild(MobiusLogo({ status: mobiusStatus }));\n    const brandText = document.createElement('div');\n    brandText.className = 'mobius-mini-brand-text';\n    brandText.textContent = 'Mobius';\n    brand.appendChild(brandText);\n    const minimizeBtn = document.createElement('button');\n    minimizeBtn.className = 'mobius-mini-minimize-btn';\n    minimizeBtn.type = 'button';\n    minimizeBtn.textContent = '';\n    minimizeBtn.setAttribute('aria-label', 'Minimize');\n    // Minimized state info (dot + patient name) - visible only when minimized\n    const minimizedInfo = document.createElement('div');\n    minimizedInfo.className = 'mobius-mini-minimized-info';\n    minimizedInfo.innerHTML = `\n    <span class=\"mobius-mini-dot\"></span>\n    <span class=\"mobius-mini-minimized-patient\"></span>\n  `;\n    const expandBtn = document.createElement('button');\n    expandBtn.className = 'mobius-mini-expand-btn';\n    expandBtn.type = 'button';\n    expandBtn.textContent = '';\n    expandBtn.setAttribute('aria-label', 'Expand');\n    const menuBtn = document.createElement('button');\n    menuBtn.className = 'mobius-mini-menu-btn';\n    menuBtn.type = 'button';\n    menuBtn.textContent = '';\n    menuBtn.setAttribute('aria-label', 'Menu');\n    const menu = document.createElement('div');\n    menu.className = 'mobius-mini-menu';\n    menu.style.cssText = `\n    display: none;\n    position: fixed;\n    background: #fff;\n    border: 1px solid rgba(11, 18, 32, 0.12);\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(2,6,23,0.15);\n    z-index: 2147483647;\n    min-width: 120px;\n    padding: 4px 0;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    font-size: 11px;\n    pointer-events: auto;\n  `;\n    // Store theme state\n    let themeSubmenuOpen = false;\n    // Helper to apply theme\n    const selectTheme = async (themeId) => {\n        console.log('[Mobius] Applying theme:', themeId);\n        applyMiniTheme(root, themeId);\n        await saveMiniTheme(themeId);\n        menu.style.display = 'none';\n        themeSubmenuOpen = false;\n    };\n    // Build menu HTML with consistent compact styling\n    const menuItemStyle = 'padding:6px 12px;cursor:pointer;display:flex;align-items:center;gap:6px;color:#374151;';\n    const menuItemHover = 'background:rgba(59,130,246,0.08);';\n    menu.innerHTML = `\n    <div class=\"mobius-mini-menu-item mobius-mini-theme-trigger\" style=\"${menuItemStyle}\">\n      Theme <span style=\"margin-left:auto;font-size:9px;opacity:0.5;\"></span>\n    </div>\n    <div class=\"mobius-mini-theme-submenu\" style=\"display:none;border-top:1px solid rgba(11,18,32,0.06);padding:2px 0;margin:0 4px;\">\n      <div class=\"mobius-mini-menu-item\" data-theme=\"light\" style=\"${menuItemStyle}font-size:10px;\">Light</div>\n      <div class=\"mobius-mini-menu-item\" data-theme=\"dark\" style=\"${menuItemStyle}font-size:10px;\">Dark</div>\n      <div class=\"mobius-mini-menu-item\" data-theme=\"blue\" style=\"${menuItemStyle}font-size:10px;\">Blue</div>\n      <div class=\"mobius-mini-menu-item\" data-theme=\"glass\" style=\"${menuItemStyle}font-size:10px;\">Glass</div>\n    </div>\n    <div style=\"height:1px;background:rgba(11,18,32,0.06);margin:2px 8px;\"></div>\n    <div class=\"mobius-mini-menu-item danger\" style=\"${menuItemStyle}color:#dc2626;font-size:10px;\">Disable on this site</div>\n  `;\n    const themeSubmenu = menu.querySelector('.mobius-mini-theme-submenu');\n    // Add click handlers directly to each element\n    const themeTriggerEl = menu.querySelector('.mobius-mini-theme-trigger');\n    console.log('[Mobius] Theme trigger found:', !!themeTriggerEl);\n    // Theme options count\n    const themeOptions = menu.querySelectorAll('[data-theme]');\n    console.log('[Mobius] Theme options found:', themeOptions.length);\n    // Use mousedown instead of click - fires before any other handlers\n    if (themeTriggerEl) {\n        themeTriggerEl.onmousedown = (e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            themeSubmenuOpen = !themeSubmenuOpen;\n            themeSubmenu.style.display = themeSubmenuOpen ? 'block' : 'none';\n            console.log('[Mobius] Theme submenu toggled:', themeSubmenuOpen);\n        };\n    }\n    // Add mousedown handlers to each theme option\n    themeOptions.forEach((el) => {\n        el.onmousedown = async (e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            const theme = el.dataset.theme || 'light';\n            console.log('[Mobius] Theme option clicked:', theme);\n            await selectTheme(theme);\n        };\n    });\n    // Add hover effects to all menu items\n    const allMenuItems = menu.querySelectorAll('.mobius-mini-menu-item');\n    allMenuItems.forEach((item) => {\n        const el = item;\n        el.onmouseenter = () => { el.style.background = 'rgba(59,130,246,0.08)'; };\n        el.onmouseleave = () => { el.style.background = 'transparent'; };\n    });\n    // Disable button\n    const disableEl = menu.querySelector('.danger');\n    if (disableEl) {\n        disableEl.onmousedown = async (e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            console.log('[Mobius] Disable clicked');\n            menu.style.display = 'none';\n            // Remove current hostname from allowed domains\n            const hostname = getHostname();\n            try {\n                await setDomainAllowed(hostname, false);\n                console.log('[Mobius] Disabled on:', hostname);\n                // Remove the Mini widget and menu from page\n                removeMini();\n                if (document.body.contains(menu)) {\n                    menu.remove();\n                }\n            }\n            catch (err) {\n                console.error('[Mobius] Failed to disable:', err);\n            }\n        };\n    }\n    // Catch-all for debugging\n    menu.onmousedown = (e) => {\n        console.log('[Mobius] Menu mousedown, target:', e.target.className);\n    };\n    // Menu button click handler - position menu relative to button\n    let menuJustOpened = false;\n    menuBtn.onmousedown = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        menuJustOpened = true;\n        setTimeout(() => { menuJustOpened = false; }, 150);\n        const isHidden = menu.style.display === 'none' || menu.style.display === '';\n        if (isHidden) {\n            // Position menu below the button\n            const btnRect = menuBtn.getBoundingClientRect();\n            menu.style.top = `${btnRect.bottom + 4}px`;\n            menu.style.right = `${window.innerWidth - btnRect.right}px`;\n            menu.style.left = 'auto';\n            menu.style.display = 'block';\n            themeSubmenu.style.display = 'none';\n            themeSubmenuOpen = false;\n            // Append to body if not already there\n            if (!document.body.contains(menu)) {\n                document.body.appendChild(menu);\n            }\n        }\n        else {\n            menu.style.display = 'none';\n        }\n        console.log('[Mobius] Menu toggled:', menu.style.display);\n    };\n    // Close menu when clicking outside\n    document.addEventListener('mousedown', (e) => {\n        // Skip if menu was just opened\n        if (menuJustOpened) {\n            return;\n        }\n        // Close if click is outside both the menu and the Mini widget\n        if (!menu.contains(e.target) && !root.contains(e.target)) {\n            if (menu.style.display !== 'none') {\n                console.log('[Mobius] Closing menu - clicked outside');\n                menu.style.display = 'none';\n                themeSubmenu.style.display = 'none';\n                themeSubmenuOpen = false;\n            }\n        }\n    });\n    // Note: dragHandle removed for cleaner look - Mini can still be dragged by header\n    header.appendChild(minimizedInfo);\n    header.appendChild(brand);\n    header.appendChild(minimizeBtn);\n    header.appendChild(expandBtn);\n    header.appendChild(menuBtn);\n    // Note: menu is appended to document.body when opened (to escape overflow:hidden)\n    root.appendChild(header);\n    // Greeting row (User Awareness Sprint)\n    const greetingRow = document.createElement('div');\n    greetingRow.className = 'mobius-mini-greeting-row';\n    greetingRow.style.display = 'none'; // Hidden by default, shown when authenticated\n    greetingRow.innerHTML = `\n    <button class=\"mobius-mini-greeting-main\" type=\"button\">\n      <span class=\"mobius-mini-greeting-text\">Hello</span>\n      <svg class=\"mobius-mini-greeting-chevron\" viewBox=\"0 0 24 24\" width=\"14\" height=\"14\">\n        <path fill=\"currentColor\" d=\"M7 10l5 5 5-5z\"/>\n      </svg>\n    </button>\n    <button class=\"mobius-mini-greeting-dismiss\" type=\"button\" title=\"Hide greeting\">\n      <svg viewBox=\"0 0 24 24\" width=\"12\" height=\"12\">\n        <path fill=\"currentColor\" d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>\n      </svg>\n    </button>\n  `;\n    root.appendChild(greetingRow);\n    // User dropdown (shown when clicking greeting)\n    let userDropdown = null;\n    const showUserDropdown = () => {\n        if (userDropdown) {\n            userDropdown.remove();\n            userDropdown = null;\n            return;\n        }\n        // Get position of greeting row for fixed dropdown\n        const greetingRect = greetingRow.getBoundingClientRect();\n        userDropdown = document.createElement('div');\n        userDropdown.className = 'mobius-mini-user-dropdown';\n        // Smart positioning for user dropdown\n        const dropdownWidth = Math.max(greetingRect.width, 200);\n        const dropdownHeight = 180; // approximate\n        const pos = getSmartDropdownPosition(greetingRect, dropdownWidth, dropdownHeight, { preferAbove: false, gap: 4 });\n        userDropdown.style.cssText = `\n      position: fixed;\n      top: ${pos.top}px;\n      left: ${pos.left}px;\n      width: ${dropdownWidth}px;\n      background: white;\n      border-radius: 8px;\n      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);\n      z-index: 2147483647;\n      overflow: hidden;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      transform-origin: ${pos.transformOrigin};\n    `;\n        const displayName = currentUserProfile?.display_name || currentUserProfile?.email || 'User';\n        const email = currentUserProfile?.email || '';\n        const initial = (displayName || '?')[0].toUpperCase();\n        userDropdown.innerHTML = `\n      <div style=\"display:flex;align-items:center;gap:10px;padding:12px;background:#f8fafc;\">\n        <div style=\"width:36px;height:36px;border-radius:50%;background:#3b82f6;color:white;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:14px;\">${initial}</div>\n        <div style=\"flex:1;min-width:0;\">\n          <div style=\"font-size:11px;font-weight:600;color:#0b1220;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;\">${displayName}</div>\n          ${email ? `<div style=\"font-size:9px;color:#64748b;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;\">${email}</div>` : ''}\n        </div>\n      </div>\n      <div style=\"height:1px;background:#e2e8f0;\"></div>\n      <button class=\"mobius-mini-dropdown-item\" data-action=\"preferences\" style=\"display:flex;align-items:center;gap:10px;width:100%;padding:10px 12px;background:none;border:none;cursor:pointer;font-size:10px;color:#374151;text-align:left;\">\n        <svg viewBox=\"0 0 24 24\" width=\"14\" height=\"14\" style=\"color:#64748b;flex-shrink:0;\">\n          <path fill=\"currentColor\" d=\"M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z\"/>\n        </svg>\n        <span>My Preferences</span>\n      </button>\n      <button class=\"mobius-mini-dropdown-item\" data-action=\"switch\" style=\"display:flex;align-items:center;gap:10px;width:100%;padding:10px 12px;background:none;border:none;cursor:pointer;font-size:10px;color:#374151;text-align:left;\">\n        <svg viewBox=\"0 0 24 24\" width=\"14\" height=\"14\" style=\"color:#64748b;flex-shrink:0;\">\n          <path fill=\"currentColor\" d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z\"/>\n        </svg>\n        <span>Not you? Sign in differently</span>\n      </button>\n      <div style=\"height:1px;background:#e2e8f0;\"></div>\n      <button class=\"mobius-mini-dropdown-item\" data-action=\"signout\" style=\"display:flex;align-items:center;gap:10px;width:100%;padding:10px 12px;background:none;border:none;cursor:pointer;font-size:10px;color:#dc2626;text-align:left;\">\n        <svg viewBox=\"0 0 24 24\" width=\"14\" height=\"14\" style=\"color:#dc2626;flex-shrink:0;\">\n          <path fill=\"currentColor\" d=\"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z\"/>\n        </svg>\n        <span>Sign out</span>\n      </button>\n    `;\n        // Append to document body (fixed position escapes Mini widget overflow)\n        document.body.appendChild(userDropdown);\n        // Wire up dropdown actions\n        userDropdown.querySelectorAll('.mobius-mini-dropdown-item').forEach(item => {\n            item.addEventListener('mouseenter', () => {\n                item.style.background = '#f8fafc';\n            });\n            item.addEventListener('mouseleave', () => {\n                item.style.background = 'transparent';\n            });\n            item.addEventListener('click', async () => {\n                const action = item.dataset.action;\n                if (action === 'signout') {\n                    const authService = getAuthService();\n                    await authService.logout();\n                    isAuthenticated = false;\n                    currentUserProfile = null;\n                    currentPersonalization = null;\n                    await renderMiniIfAllowed();\n                    showToast('Signed out');\n                }\n                else if (action === 'preferences') {\n                    // Show preferences modal\n                    openPreferencesModal();\n                }\n                else if (action === 'switch') {\n                    const authService = getAuthService();\n                    await authService.logout();\n                    isAuthenticated = false;\n                    currentUserProfile = null;\n                    await renderMiniIfAllowed();\n                }\n                if (userDropdown) {\n                    userDropdown.remove();\n                    userDropdown = null;\n                }\n            });\n        });\n        // Close on outside click\n        const closeDropdown = (e) => {\n            if (userDropdown && !userDropdown.contains(e.target) && !greetingRow.contains(e.target)) {\n                userDropdown.remove();\n                userDropdown = null;\n                document.removeEventListener('click', closeDropdown);\n            }\n        };\n        setTimeout(() => document.addEventListener('click', closeDropdown), 0);\n    };\n    // Wire up greeting click\n    greetingRow.querySelector('.mobius-mini-greeting-main')?.addEventListener('click', (e) => {\n        e.stopPropagation();\n        showUserDropdown();\n    });\n    // Wire up dismiss button\n    greetingRow.querySelector('.mobius-mini-greeting-dismiss')?.addEventListener('click', (e) => {\n        e.stopPropagation();\n        greetingDismissed = true;\n        greetingRow.style.display = 'none';\n    });\n    // Open preferences modal\n    const openPreferencesModal = async () => {\n        // Inject modal styles if not already present\n        if (!document.getElementById('mobius-prefs-styles')) {\n            const style = document.createElement('style');\n            style.id = 'mobius-prefs-styles';\n            style.textContent = PREFERENCES_MODAL_STYLES;\n            document.head.appendChild(style);\n        }\n        // Build preferences from current user profile and personalization\n        // Extract activity codes from user profile or personalization\n        const activityCodes = currentUserProfile?.activities ||\n            currentPersonalization?.activities?.map(a => a.code) || [];\n        const currentPrefs = {\n            preferred_name: currentUserProfile?.preferred_name || currentUserProfile?.first_name || '',\n            timezone: currentUserProfile?.timezone || 'America/New_York',\n            activities: activityCodes,\n            tone: currentUserProfile?.tone || 'professional',\n            greeting_enabled: currentUserProfile?.greeting_enabled !== false,\n            autonomy_routine_tasks: currentUserProfile?.autonomy_routine_tasks || 'confirm_first',\n            autonomy_sensitive_tasks: currentUserProfile?.autonomy_sensitive_tasks || 'manual',\n        };\n        // Create and show modal\n        const modal = await PreferencesModal({\n            preferences: currentPrefs,\n            onSave: async (newPrefs) => {\n                showToast('Preferences saved!');\n                // Clear cached user profile to force refresh\n                currentUserProfile = null;\n                currentPersonalization = null;\n                // Refresh user profile from backend\n                const authService = getAuthService();\n                currentUserProfile = await authService.getCurrentUser();\n                // Refresh Mini to reflect new preferences\n                await renderMiniIfAllowed();\n                modal.remove();\n            },\n            onClose: () => {\n                modal.remove();\n            },\n        });\n        document.body.appendChild(modal);\n    };\n    // Minimize/restore state\n    let isMinimized = false;\n    const contentElements = []; // Will store refs to hide/show\n    minimizeBtn.onclick = (e) => {\n        e.stopPropagation();\n        isMinimized = !isMinimized;\n        if (isMinimized) {\n            // Minimize: hide all content except header, shrink widget\n            root.classList.add('mobius-mini-minimized');\n            minimizeBtn.textContent = '+';\n            minimizeBtn.setAttribute('aria-label', 'Restore');\n        }\n        else {\n            // Restore: show all content\n            root.classList.remove('mobius-mini-minimized');\n            minimizeBtn.textContent = '';\n            minimizeBtn.setAttribute('aria-label', 'Minimize');\n        }\n    };\n    // Patient\n    const patientRow = document.createElement('div');\n    patientRow.className = 'mobius-mini-row';\n    patientRow.innerHTML = `\n    <div class=\"mobius-mini-row-label\">PATIENT</div>\n    <div class=\"mobius-mini-row-body\">\n      <div class=\"mobius-mini-patient-name\"></div>\n      <div class=\"mobius-mini-patient-id\"></div>\n      <div class=\"mobius-mini-patient-dob\"></div>\n    </div>\n    <button class=\"mobius-mini-icon-btn\" type=\"button\" aria-label=\"Edit patient\" title=\"Edit patient\">\n      <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n        <path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zm2.92 2.83H5v-.92l9.06-9.06.92.92L5.92 20.08zM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z\"/>\n      </svg>\n    </button>\n  `;\n    root.appendChild(patientRow);\n    // Unified Status Row - color dot + priority question + answer dropdown\n    const attentionRow = document.createElement('div');\n    attentionRow.className = 'mobius-mini-row mobius-mini-attention-row';\n    attentionRow.innerHTML = `\n    <div class=\"mobius-mini-row-label\">STATUS</div>\n    <div class=\"mobius-mini-attention-content\">\n      <span class=\"mobius-mini-dot\"></span>\n      <span class=\"mobius-mini-question-text\">No issues detected</span>\n      <button class=\"mobius-mini-status-badge\" type=\"button\" aria-label=\"Answer\">\n        <span class=\"mobius-mini-badge-text\">Set status</span>\n        <span class=\"mobius-mini-dropdown-icon\"></span>\n      </button>\n    </div>\n  `;\n    root.appendChild(attentionRow);\n    // Plan badge row - shows count and links to full checklist\n    const taskBadgeRow = document.createElement('div');\n    taskBadgeRow.className = 'mobius-mini-row mobius-mini-task-badge-row';\n    taskBadgeRow.style.display = 'none'; // Hidden when no actions\n    taskBadgeRow.innerHTML = `\n    <div class=\"mobius-mini-row-label\">PLAN</div>\n    <button class=\"mobius-mini-task-badge\" type=\"button\" aria-label=\"Open plan in Sidecar\">\n      <span class=\"mobius-mini-task-count\">0</span>\n      <span class=\"mobius-mini-task-label\">items remaining</span>\n      <span style=\"margin-left: 4px;\"></span>\n    </button>\n  `;\n    root.appendChild(taskBadgeRow);\n    // Legacy rows for backwards compatibility (hidden)\n    const proceedRow = document.createElement('div');\n    proceedRow.className = 'mobius-mini-row';\n    proceedRow.style.display = 'none';\n    const taskingRow = document.createElement('div');\n    taskingRow.className = 'mobius-mini-row';\n    taskingRow.style.display = 'none';\n    // Note + send icon\n    const noteRow = document.createElement('div');\n    noteRow.className = 'mobius-mini-row';\n    noteRow.innerHTML = `\n    <div class=\"mobius-mini-row-label\">NOTE</div>\n    <div class=\"mobius-mini-note-wrap\">\n      <input class=\"mobius-mini-note-input\" type=\"text\" placeholder=\"Quick note\" />\n      <button class=\"mobius-mini-send-btn\" type=\"button\" aria-label=\"Send note\">\n        <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"></path></svg>\n      </button>\n    </div>\n  `;\n    root.appendChild(noteRow);\n    // Wire up patient row content and actions\n    const renderPatient = () => {\n        const p = getPatientDisplay();\n        const nameEl = root.querySelector('.mobius-mini-patient-name');\n        const idEl = root.querySelector('.mobius-mini-patient-id');\n        const dobEl = root.querySelector('.mobius-mini-patient-dob');\n        if (nameEl)\n            nameEl.textContent = p.name || 'Unknown';\n        if (idEl)\n            idEl.textContent = p.id ? `ID ${p.id}` : '';\n        if (dobEl)\n            dobEl.textContent = p.dob ? `DOB ${p.dob}` : '';\n        // Also update minimized info patient name\n        const minimizedName = minimizedInfo.querySelector('.mobius-mini-minimized-patient');\n        if (minimizedName)\n            minimizedName.textContent = p.name || 'Unknown';\n    };\n    renderPatient();\n    // Wire up statuses\n    const applyStatus = (rowEl, line, showMode = false) => {\n        const dot = rowEl.querySelector('.mobius-mini-dot');\n        const text = rowEl.querySelector('.mobius-mini-status-text');\n        if (dot) {\n            dot.className = `mobius-mini-dot ${colorToCssClass(line.color)}`;\n        }\n        if (text) {\n            if (showMode && line.mode) {\n                const icon = getModeIcon(line.mode);\n                const modeText = line.mode_text || '';\n                text.textContent = `${icon} ${modeText}`;\n            }\n            else {\n                text.textContent = line.text;\n            }\n        }\n    };\n    // Apply attention status (new UI)\n    const applyAttention = () => {\n        const dot = attentionRow.querySelector('.mobius-mini-dot');\n        const problemText = attentionRow.querySelector('.mobius-mini-problem-text');\n        const badgeText = attentionRow.querySelector('.mobius-mini-badge-text');\n        const badge = attentionRow.querySelector('.mobius-mini-status-badge');\n        // Calculate effective color based on status\n        let effectiveColor = needsAttention.color;\n        if (needsAttention.userStatus === 'resolved')\n            effectiveColor = 'green';\n        else if (needsAttention.userStatus === 'confirmed_unresolved')\n            effectiveColor = 'yellow';\n        else if (needsAttention.userStatus === 'unable_to_confirm')\n            effectiveColor = 'grey';\n        // Dot color reflects status\n        if (dot) {\n            dot.className = `mobius-mini-dot ${colorToCssClass(effectiveColor)}`;\n        }\n        // Also update minimized info dot\n        const minimizedDot = minimizedInfo.querySelector('.mobius-mini-dot');\n        if (minimizedDot) {\n            minimizedDot.className = `mobius-mini-dot ${colorToCssClass(effectiveColor)}`;\n        }\n        // Problem statement always visible\n        if (problemText) {\n            problemText.textContent = needsAttention.problemStatement || 'No issues detected';\n        }\n        // Status badge shows current status\n        if (badgeText && badge) {\n            if (needsAttention.userStatus === 'resolved') {\n                badgeText.textContent = 'Resolved';\n                badge.className = 'mobius-mini-status-badge status-resolved';\n            }\n            else if (needsAttention.userStatus === 'confirmed_unresolved') {\n                badgeText.textContent = 'Unresolved';\n                badge.className = 'mobius-mini-status-badge status-unresolved';\n            }\n            else if (needsAttention.userStatus === 'unable_to_confirm') {\n                badgeText.textContent = 'Unconfirmed';\n                badge.className = 'mobius-mini-status-badge status-unconfirmed';\n            }\n            else {\n                badgeText.textContent = 'Set status';\n                badge.className = 'mobius-mini-status-badge';\n            }\n        }\n    };\n    // Apply task count (action-centric: uses actionsForUser)\n    const applyTaskCount = () => {\n        const countEl = taskBadgeRow.querySelector('.mobius-mini-task-count');\n        const labelEl = taskBadgeRow.querySelector('.mobius-mini-task-label');\n        // Prefer actionsForUser from resolution plan, fall back to taskCount\n        const count = actionsForUser > 0 ? actionsForUser : taskCount;\n        if (countEl)\n            countEl.textContent = String(count);\n        if (labelEl)\n            labelEl.textContent = count === 1 ? 'item remaining' : 'items remaining';\n        taskBadgeRow.style.display = count > 0 ? '' : 'none';\n    };\n    // Apply step preview - now uses global function\n    const applyStepPreview = () => {\n        updateStepPreviewGlobal();\n    };\n    // Update minimized state info (dot + patient name)\n    const updateMinimizedInfo = () => {\n        const dot = minimizedInfo.querySelector('.mobius-mini-dot');\n        const name = minimizedInfo.querySelector('.mobius-mini-minimized-patient');\n        // Patient name\n        const p = getPatientDisplay();\n        if (name)\n            name.textContent = p.name || 'Unknown';\n        // Attention dot color\n        if (dot) {\n            let color = needsAttention.color;\n            if (needsAttention.userStatus === 'resolved')\n                color = 'green';\n            else if (needsAttention.userStatus === 'confirmed_unresolved')\n                color = 'yellow';\n            else if (needsAttention.userStatus === 'unable_to_confirm')\n                color = 'grey';\n            dot.className = `mobius-mini-dot ${colorToCssClass(color)}`;\n        }\n    };\n    applyAttention();\n    applyTaskCount();\n    applyStepPreview();\n    updateMinimizedInfo();\n    // Legacy (hidden)\n    applyStatus(proceedRow, miniProceed);\n    applyStatus(taskingRow, miniTasking, true);\n    // Attention workflow dropdown options\n    const ATTENTION_OPTIONS = [\n        { status: 'resolved', label: 'Resolved', icon: '', description: 'Problem fixed, no further action' },\n        { status: 'confirmed_unresolved', label: 'Confirmed, unresolved', icon: '', description: 'Issue verified, tasks remain' },\n        { status: 'unable_to_confirm', label: 'Unable to confirm', icon: '?', description: 'Needs investigation' },\n    ];\n    // Create issue report modal\n    const createIssueModal = (onSubmit) => {\n        const overlay = document.createElement('div');\n        overlay.className = 'mobius-mini-modal-overlay';\n        overlay.style.cssText = `\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.3);\n      z-index: 2147483647;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    `;\n        const modal = document.createElement('div');\n        modal.className = 'mobius-mini-issue-modal';\n        modal.style.cssText = `\n      background: white;\n      border-radius: 8px;\n      box-shadow: 0 8px 32px rgba(0,0,0,0.2);\n      width: 280px;\n      overflow: hidden;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    `;\n        modal.innerHTML = `\n      <div style=\"display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid #e2e8f0;\">\n        <span style=\"font-size:11px;font-weight:600;color:#0b1220;\">Report Issue</span>\n        <button type=\"button\" class=\"modal-close\" style=\"background:none;border:none;cursor:pointer;font-size:16px;color:#64748b;padding:0;line-height:1;\">&times;</button>\n      </div>\n      <div style=\"padding:12px;\">\n        <input type=\"text\" class=\"issue-input\" placeholder=\"Describe the issue...\" style=\"\n          width:100%;\n          box-sizing:border-box;\n          padding:8px 10px;\n          border:1px solid #e2e8f0;\n          border-radius:6px;\n          font-size:10px;\n          outline:none;\n        \" />\n      </div>\n      <div style=\"display:flex;gap:8px;justify-content:flex-end;padding:0 12px 12px;\">\n        <button type=\"button\" class=\"modal-cancel\" style=\"\n          padding:6px 12px;\n          border:1px solid #e2e8f0;\n          border-radius:6px;\n          background:white;\n          font-size:10px;\n          cursor:pointer;\n        \">Cancel</button>\n        <button type=\"button\" class=\"modal-submit\" style=\"\n          padding:6px 12px;\n          border:none;\n          border-radius:6px;\n          background:#2563eb;\n          color:white;\n          font-size:10px;\n          font-weight:500;\n          cursor:pointer;\n        \">Submit</button>\n      </div>\n    `;\n        overlay.appendChild(modal);\n        const input = modal.querySelector('.issue-input');\n        const closeBtn = modal.querySelector('.modal-close');\n        const cancelBtn = modal.querySelector('.modal-cancel');\n        const submitBtn = modal.querySelector('.modal-submit');\n        const close = () => overlay.remove();\n        closeBtn.addEventListener('click', close);\n        cancelBtn.addEventListener('click', close);\n        overlay.addEventListener('click', (e) => {\n            if (e.target === overlay)\n                close();\n        });\n        submitBtn.addEventListener('click', () => {\n            const text = input.value.trim();\n            if (text) {\n                onSubmit(text);\n                close();\n            }\n        });\n        input.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter') {\n                const text = input.value.trim();\n                if (text) {\n                    onSubmit(text);\n                    close();\n                }\n            }\n            if (e.key === 'Escape')\n                close();\n        });\n        // Focus input after append\n        setTimeout(() => input.focus(), 50);\n        return overlay;\n    };\n    const createAttentionDropdown = (currentStatus, onSelect, onReportIssue, anchorRect) => {\n        const dropdown = document.createElement('div');\n        dropdown.className = 'mobius-mini-status-dropdown mobius-mini-attention-dropdown';\n        const dropdownWidth = 220;\n        const dropdownHeight = 150; // approximate height for 3 options + separator + new issue\n        // Smart positioning based on viewport boundaries\n        const pos = getSmartDropdownPosition(anchorRect, dropdownWidth, dropdownHeight, { preferAbove: true, gap: 4 });\n        dropdown.style.cssText = `\n      position: fixed;\n      top: ${pos.top}px;\n      left: ${pos.left}px;\n      background: white;\n      border: 1px solid #e2e8f0;\n      border-radius: 6px;\n      box-shadow: 0 4px 16px rgba(0,0,0,0.18);\n      z-index: 2147483647;\n      min-width: ${dropdownWidth}px;\n      padding: 4px 0;\n      transform-origin: ${pos.transformOrigin};\n    `;\n        // Add status options\n        ATTENTION_OPTIONS.forEach((opt) => {\n            const isSelected = opt.status === currentStatus;\n            const item = document.createElement('button');\n            item.type = 'button';\n            item.style.cssText = `\n        display: flex;\n        flex-direction: column;\n        align-items: flex-start;\n        gap: 1px;\n        width: 100%;\n        padding: 6px 8px;\n        border: none;\n        background: ${isSelected ? '#f1f5f9' : 'transparent'};\n        cursor: pointer;\n        text-align: left;\n      `;\n            item.innerHTML = `\n        <div style=\"display:flex;align-items:center;gap:6px;font-size:10px;font-weight:500;\">\n          <span>${opt.icon}</span>\n          <span>${opt.label}</span>\n        </div>\n        <div style=\"font-size:8px;color:#64748b;padding-left:16px;\">${opt.description}</div>\n      `;\n            item.addEventListener('click', (e) => {\n                e.stopPropagation();\n                onSelect(opt.status);\n                dropdown.remove();\n            });\n            item.addEventListener('mouseenter', () => {\n                item.style.background = '#f1f5f9';\n            });\n            item.addEventListener('mouseleave', () => {\n                item.style.background = isSelected ? '#f1f5f9' : 'transparent';\n            });\n            dropdown.appendChild(item);\n        });\n        // Add separator\n        const separator = document.createElement('div');\n        separator.style.cssText = `\n      height: 1px;\n      background: #e2e8f0;\n      margin: 4px 8px;\n    `;\n        dropdown.appendChild(separator);\n        // Add \"Report new issue\" option\n        const reportItem = document.createElement('button');\n        reportItem.type = 'button';\n        reportItem.style.cssText = `\n      display: flex;\n      flex-direction: column;\n      align-items: flex-start;\n      gap: 1px;\n      width: 100%;\n      padding: 6px 8px;\n      border: none;\n      background: transparent;\n      cursor: pointer;\n      text-align: left;\n    `;\n        reportItem.innerHTML = `\n      <div style=\"display:flex;align-items:center;gap:6px;font-size:10px;font-weight:500;color:#2563eb;\">\n        <span>+</span>\n        <span>Report new issue</span>\n      </div>\n      <div style=\"font-size:8px;color:#64748b;padding-left:16px;\">Add a new problem</div>\n    `;\n        reportItem.addEventListener('click', (e) => {\n            e.stopPropagation();\n            dropdown.remove();\n            onReportIssue();\n        });\n        reportItem.addEventListener('mouseenter', () => {\n            reportItem.style.background = '#eff6ff';\n        });\n        reportItem.addEventListener('mouseleave', () => {\n            reportItem.style.background = 'transparent';\n        });\n        dropdown.appendChild(reportItem);\n        return dropdown;\n    };\n    // Create answer dropdown for resolution plan steps\n    const createAnswerDropdown = (step, anchorRect) => {\n        const dropdown = document.createElement('div');\n        dropdown.className = 'mobius-mini-status-dropdown mobius-mini-answer-dropdown';\n        const dropdownWidth = Math.max(anchorRect.width, 200);\n        const dropdownHeight = 160;\n        // Smart positioning based on viewport boundaries\n        const pos = getSmartDropdownPosition(anchorRect, dropdownWidth, dropdownHeight, { preferAbove: true, gap: 8 });\n        dropdown.style.cssText = `\n      position: fixed;\n      top: ${pos.top}px;\n      left: ${pos.left}px;\n      min-width: ${dropdownWidth}px;\n      z-index: 2147483647;\n      transform-origin: ${pos.transformOrigin};\n    `;\n        const options = step?.answer_options || [];\n        const suggestion = step?.system_suggestion;\n        options.forEach((opt) => {\n            const item = document.createElement('button');\n            item.type = 'button';\n            item.className = 'mobius-mini-dropdown-item';\n            // Highlight suggested answer\n            if (suggestion?.answer === opt.code) {\n                item.innerHTML = `<span style=\"color: #16a34a;\"></span> ${opt.label} <span style=\"font-size: 9px; color: #64748b;\">(suggested)</span>`;\n            }\n            else {\n                item.textContent = opt.label;\n            }\n            item.addEventListener('click', async () => {\n                dropdown.remove();\n                try {\n                    const response = await fetch(`${API_BASE_URL}/api/v1/resolution/answer`, {\n                        method: 'POST',\n                        headers: { 'Content-Type': 'application/json' },\n                        body: JSON.stringify({\n                            step_id: step?.step_id,\n                            answer_code: opt.code,\n                        }),\n                    });\n                    if (response.ok) {\n                        const data = await response.json();\n                        showToast('Answer recorded');\n                        if (data.plan) {\n                            resolutionPlan = data.plan;\n                            actionsForUser = data.plan.actions_for_user || 0;\n                            updateStepPreviewGlobal();\n                            updateTaskCountGlobal();\n                        }\n                    }\n                    else {\n                        showToast('Failed to submit');\n                    }\n                }\n                catch (err) {\n                    console.error('[Mobius] Error submitting answer:', err);\n                    showToast('Connection error');\n                }\n            });\n            dropdown.appendChild(item);\n        });\n        // Add separator and \"More options\" link\n        const separator = document.createElement('div');\n        separator.style.cssText = 'border-top: 1px solid rgba(0,0,0,0.1); margin: 6px 0;';\n        dropdown.appendChild(separator);\n        const moreItem = document.createElement('button');\n        moreItem.type = 'button';\n        moreItem.className = 'mobius-mini-dropdown-item';\n        moreItem.innerHTML = '<span style=\"color: #64748b;\">Open full checklist </span>';\n        moreItem.addEventListener('click', async () => {\n            dropdown.remove();\n            await expandToSidebar();\n        });\n        dropdown.appendChild(moreItem);\n        return dropdown;\n    };\n    // Click handler for status badge - shows answer options or status options\n    const statusBadge = attentionRow.querySelector('.mobius-mini-status-badge');\n    statusBadge?.addEventListener('click', async (e) => {\n        e.stopPropagation();\n        // Remove any existing dropdown\n        document.querySelectorAll('.mobius-mini-status-dropdown').forEach(d => d.remove());\n        // Get button position to anchor dropdown\n        const btnRect = statusBadge.getBoundingClientRect();\n        // If resolution plan is resolved, just show a toast (nothing to do)\n        if (resolutionPlan?.status === 'resolved') {\n            showToast('All checks passed - no action needed');\n            return;\n        }\n        // If we have a resolution plan with current step, show answer dropdown\n        if (resolutionPlan?.current_step) {\n            const dropdown = createAnswerDropdown(resolutionPlan.current_step, btnRect);\n            document.body.appendChild(dropdown);\n            return;\n        }\n        // Active plan but no tasks for this user's role\n        if (resolutionPlan?.status === 'active') {\n            const otherRoleTasks = resolutionPlan.other_role_tasks || 0;\n            if (otherRoleTasks > 0) {\n                showToast(`${otherRoleTasks} task(s) waiting on other team members`);\n                return;\n            }\n        }\n        // Otherwise show the status dropdown (fallback for when no resolution plan)\n        const dropdown = createAttentionDropdown(needsAttention.userStatus, \n        // onSelect callback for status changes\n        async (status) => {\n            // Update local state\n            needsAttention.userStatus = status;\n            applyAttention();\n            // Submit to backend\n            const patientId = getPatientDisplay().id;\n            if (patientId) {\n                try {\n                    const response = await submitAttentionStatus(sessionId, patientId, status);\n                    showToast(status === 'resolved' ? 'Marked as resolved' : 'Status updated');\n                    // Open sidecar if indicated\n                    if (response.open_sidecar) {\n                        await expandToSidebar();\n                    }\n                }\n                catch (err) {\n                    console.error('[Mobius] Failed to update attention status:', err);\n                    showToast('Failed to update status');\n                }\n            }\n        }, \n        // onReportIssue callback\n        () => {\n            const modal = createIssueModal(async (issueText) => {\n                const patientId = getPatientDisplay().id;\n                if (patientId) {\n                    try {\n                        await reportIssue(sessionId, patientId, issueText);\n                        showToast('Issue reported');\n                    }\n                    catch (err) {\n                        console.error('[Mobius] Failed to report issue:', err);\n                        showToast('Failed to report issue');\n                    }\n                }\n            });\n            document.body.appendChild(modal);\n        }, btnRect);\n        // Append to body to escape overflow:hidden on Mini widget\n        document.body.appendChild(dropdown);\n    });\n    // Click handler for task badge (opens sidecar)\n    const taskBadge = taskBadgeRow.querySelector('.mobius-mini-task-badge');\n    taskBadge?.addEventListener('click', async () => {\n        // Open sidecar - expand to full sidebar\n        await expandToSidebar();\n    });\n    // Close dropdown when clicking outside\n    document.addEventListener('click', () => {\n        document.querySelectorAll('.mobius-mini-status-dropdown').forEach(d => d.remove());\n    });\n    // Legacy: Track overrides (kept for backwards compatibility)\n    let proceedOverride = null;\n    let taskingOverride = null;\n    const savePatient = async (p) => {\n        patientOverride = p;\n        await storageSet({ [STORAGE_KEYS.patientOverride]: p });\n        renderPatient();\n        // Fetch new status for the selected patient\n        if (p.id) {\n            try {\n                const status = await fetchMiniStatus(sessionId, p.id);\n                // Update legacy proceed/tasking (hidden)\n                miniProceed = status.proceed;\n                if (status.tasking) {\n                    miniTasking = status.tasking;\n                }\n                applyStatus(proceedRow, miniProceed);\n                applyStatus(taskingRow, miniTasking, true);\n                // Update needs_attention (new UI)\n                if (status.needs_attention) {\n                    needsAttention = {\n                        color: status.needs_attention.color,\n                        problemStatement: status.needs_attention.problem_statement,\n                        userStatus: status.needs_attention.user_status,\n                    };\n                }\n                else {\n                    // Fallback to proceed data\n                    needsAttention = {\n                        color: status.proceed.color,\n                        problemStatement: status.proceed.text,\n                        userStatus: null,\n                    };\n                }\n                applyAttention();\n                // Update task count and resolution plan\n                taskCount = status.task_count || 0;\n                resolutionPlan = status.resolution_plan || null;\n                actionsForUser = status.actions_for_user || 0;\n                applyTaskCount();\n                applyStepPreview();\n                // Start polling for cross-tab sync\n                startStatusPolling();\n            }\n            catch (err) {\n                console.error('[Mobius] Failed to fetch status for patient:', err);\n            }\n        }\n    };\n    patientRow.querySelector('.mobius-mini-icon-btn')?.addEventListener('click', () => {\n        openPatientModal((p) => void savePatient(p));\n    });\n    // Note send\n    const noteInput = root.querySelector('.mobius-mini-note-input');\n    const sendBtn = root.querySelector('.mobius-mini-send-btn');\n    const doSend = async () => {\n        const note = (noteInput?.value || '').trim();\n        if (!note)\n            return;\n        try {\n            // Include plan context so notes are linked to the resolution workflow\n            const planContext = resolutionPlan ? {\n                resolution_plan_id: resolutionPlan.plan_id,\n                plan_step_id: resolutionPlan.current_step?.step_id,\n            } : undefined;\n            await submitMiniNote(sessionId, note, getPatientDisplay(), planContext);\n            if (noteInput)\n                noteInput.value = '';\n            showToast('Note sent');\n        }\n        catch (e) {\n            const msg = e instanceof Error ? e.message : 'Failed to send';\n            showToast(msg);\n        }\n    };\n    sendBtn?.addEventListener('click', () => void doSend());\n    noteInput?.addEventListener('keydown', (e) => {\n        if (e.key === 'Enter') {\n            e.preventDefault();\n            void doSend();\n        }\n    });\n    // Expand + disable site\n    const doExpand = async () => {\n        menu.style.display = 'none';\n        await expandToSidebar();\n    };\n    expandBtn.addEventListener('click', () => void doExpand());\n    menu.querySelector('[data-action=\"disable-site\"]')?.addEventListener('click', () => {\n        menu.style.display = 'none';\n        const host = getHostname();\n        void (async () => {\n            await setDomainAllowed(host, false);\n            removeMini();\n            removeSidebar();\n            showToast('Disabled on this site');\n        })();\n    });\n    // Draggable positioning (only via dragHandle)\n    let dragging = false;\n    let start = { x: 0, y: 0, left: 0, top: 0 };\n    const startDrag = (e) => {\n        dragging = true;\n        e.currentTarget.setPointerCapture(e.pointerId);\n        const rect = root.getBoundingClientRect();\n        start = { x: e.clientX, y: e.clientY, left: rect.left, top: rect.top };\n        e.preventDefault();\n    };\n    const moveDrag = (e) => {\n        if (!dragging)\n            return;\n        const dx = e.clientX - start.x;\n        const dy = e.clientY - start.y;\n        root.style.left = `${start.left + dx}px`;\n        root.style.top = `${start.top + dy}px`;\n    };\n    const endDrag = () => {\n        if (!dragging)\n            return;\n        dragging = false;\n        const rect = root.getBoundingClientRect();\n        void setMiniPos(root, { x: rect.left, y: rect.top });\n    };\n    // Make dragging easy: allow dragging from the whole header,\n    // but ignore interactions on buttons/inputs.\n    const canStartDrag = (target) => {\n        const el = target;\n        if (!el)\n            return false;\n        return !el.closest('button') && !el.closest('input') && !el.closest('select') && !el.closest('textarea');\n    };\n    header.addEventListener('pointerdown', (e) => {\n        if (!canStartDrag(e.target))\n            return;\n        startDrag(e);\n    });\n    header.addEventListener('pointermove', moveDrag);\n    header.addEventListener('pointerup', endDrag);\n    // Also allow dragging via the grip specifically.\n    dragHandle.addEventListener('pointerdown', startDrag);\n    dragHandle.addEventListener('pointermove', moveDrag);\n    dragHandle.addEventListener('pointerup', endDrag);\n    window.addEventListener('resize', () => {\n        const rect = root.getBoundingClientRect();\n        void setMiniPos(root, { x: rect.left, y: rect.top });\n    });\n    return root;\n}\nasync function expandToSidebar() {\n    console.log('[Mobius OS] Expanding to sidebar...');\n    const mini = document.getElementById(MINI_IDS.root);\n    if (mini) {\n        const rect = mini.getBoundingClientRect();\n        miniLastPos = { x: rect.left, y: rect.top };\n        await storageSet({ [STORAGE_KEYS.miniPos]: miniLastPos });\n        mini.style.display = 'none';\n    }\n    // Pass current state to sidecar\n    const miniState = {\n        patient: patientOverride || (autoDetectedPatient?.found ? {\n            name: autoDetectedPatient.display_name || 'Patient',\n            id: autoDetectedPatient.patient_key || '',\n        } : null),\n        resolutionPlan,\n        userProfile: currentUserProfile,\n        needsAttention,\n    };\n    await initSidecarUI(miniState);\n}\nasync function initSidecarUI(miniState) {\n    console.log('[Mobius OS] Initializing Sidecar UI...');\n    // Check if sidebar already exists\n    if (document.getElementById('mobius-os-sidebar')) {\n        console.log('[Mobius OS] Sidebar already exists, skipping initialization');\n        return;\n    }\n    // Get session\n    sessionId = await getOrCreateSessionId();\n    // Load privacy mode\n    sidecarPrivacyMode = await PrivacyMode.isEnabled();\n    // Build record context\n    const patient = miniState.patient;\n    const recordContext = patient\n        ? createPatientContext(patient.id, patient.name)\n        : { type: 'patient', id: '', displayName: 'Unknown Patient', shortName: 'Patient', possessive: \"Patient's\" };\n    const staffName = miniState.userProfile?.greeting_name || miniState.userProfile?.display_name;\n    const privacyContext = buildPrivacyContext(recordContext, staffName, sidecarPrivacyMode);\n    // Fetch sidecar state from backend\n    try {\n        const patientKey = patient?.id || '';\n        const queryParams = new URLSearchParams({\n            session_id: sessionId,\n            ...(patientKey && { patient_key: patientKey }),\n        });\n        const response = await fetch(`${API_BASE_URL}/api/v1/sidecar/state?${queryParams}`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                ...(await getAuthHeader()),\n            },\n        });\n        if (response.ok) {\n            sidecarState = await response.json();\n        }\n        else {\n            console.warn('[Mobius] Failed to fetch sidecar state, using fallback');\n            // Create fallback state from mini state\n            sidecarState = createFallbackSidecarState(miniState, recordContext);\n        }\n    }\n    catch (error) {\n        console.error('[Mobius] Error fetching sidecar state:', error);\n        sidecarState = createFallbackSidecarState(miniState, recordContext);\n    }\n    // Create sidebar container\n    sidebarContainer = document.createElement('div');\n    sidebarContainer.id = 'mobius-os-sidebar';\n    sidebarContainer.setAttribute('style', `\n    position: fixed !important;\n    top: 0 !important;\n    right: 0 !important;\n    width: 400px !important;\n    height: 100vh !important;\n    min-height: 100vh !important;\n    max-height: 100vh !important;\n    background: white !important;\n    z-index: 2147483646 !important;\n    box-shadow: -2px 0 8px rgba(0,0,0,0.1) !important;\n    overflow: hidden !important;\n    display: flex !important;\n    flex-direction: column !important;\n    margin: 0 !important;\n    padding: 0 !important;\n  `);\n    // Adjust page content\n    const style = document.createElement('style');\n    style.id = 'mobius-os-page-adjust';\n    style.textContent = `\n    body {\n      margin-right: 400px !important;\n      transition: margin-right 0.3s ease !important;\n    }\n    html {\n      overflow-x: hidden !important;\n    }\n  `;\n    document.head.appendChild(style);\n    // Build the UI\n    // === HEADER ===\n    const header = document.createElement('div');\n    header.className = 'top-row';\n    header.setAttribute('style', 'display: flex; align-items: center; justify-content: space-between; padding: 6px 12px; border-bottom: 1px solid rgba(11, 18, 32, 0.08); background: rgba(11, 18, 32, 0.02);');\n    // Left: Logos\n    const headerLeft = document.createElement('div');\n    headerLeft.className = 'header-left';\n    headerLeft.setAttribute('style', 'display: flex; align-items: center; gap: 8px;');\n    headerLeft.appendChild(ClientLogo({ clientName: 'CMHC' }));\n    const logoSection = document.createElement('div');\n    logoSection.className = 'logo-section';\n    logoSection.setAttribute('style', 'display: flex; align-items: center; gap: 4px;');\n    logoSection.appendChild(MobiusLogo({ status: 'idle' }));\n    const logoLabel = document.createElement('span');\n    logoLabel.className = 'logo-label';\n    logoLabel.setAttribute('style', 'font-size: 11px; font-weight: 600; color: #0b1220;');\n    logoLabel.textContent = 'Mobius OS';\n    logoSection.appendChild(logoLabel);\n    headerLeft.appendChild(logoSection);\n    header.appendChild(headerLeft);\n    // Right: Actions\n    const headerRight = document.createElement('div');\n    headerRight.setAttribute('style', 'display: flex; align-items: center; gap: 4px;');\n    // Alert indicator\n    const alertIndicator = AlertIndicator({\n        alerts: sidecarState?.alerts || [],\n        onClick: () => {\n            showToast('Inbox coming soon');\n        },\n    });\n    headerRight.appendChild(alertIndicator);\n    // Privacy indicator (if enabled)\n    if (sidecarPrivacyMode) {\n        const privacyIndicator = document.createElement('span');\n        privacyIndicator.className = 'sidecar-privacy-indicator';\n        privacyIndicator.textContent = '';\n        privacyIndicator.title = 'Privacy mode enabled';\n        headerRight.appendChild(privacyIndicator);\n    }\n    // Menu\n    const menu = SidecarMenu({\n        onCollapse: () => void collapseToMini(),\n        onHistoryClick: () => showToast('History coming soon'),\n        onSettingsClick: () => showToast('Settings coming soon'),\n        onHelpClick: () => showToast('Help coming soon'),\n        onPrivacyChange: async (enabled) => {\n            sidecarPrivacyMode = enabled;\n            // Refresh UI to apply privacy mode\n            removeSidebar();\n            await initSidecarUI(miniState);\n        },\n        onNotificationsChange: (enabled) => {\n            console.log('[Mobius] Notifications:', enabled);\n        },\n    });\n    headerRight.appendChild(menu);\n    // Collapse button\n    const collapseBtn = CollapseButton(() => void collapseToMini());\n    headerRight.appendChild(collapseBtn);\n    header.appendChild(headerRight);\n    sidebarContainer.appendChild(header);\n    // === STATUS BAR ===\n    if (sidecarState?.care_readiness) {\n        const statusBar = StatusBar({ careReadiness: sidecarState.care_readiness });\n        sidebarContainer.appendChild(statusBar);\n    }\n    // === MAIN CONTENT (scrollable) ===\n    const mainContent = document.createElement('div');\n    mainContent.className = 'sidecar-main-content';\n    mainContent.setAttribute('style', 'flex: 1; overflow-y: auto; display: flex; flex-direction: column;');\n    // === CARDS CONTAINER (bottlenecks, patient context) ===\n    const cardsContainer = document.createElement('div');\n    cardsContainer.className = 'sidecar-cards-container';\n    cardsContainer.setAttribute('style', 'padding: 8px 10px; flex-shrink: 0;');\n    // === MOBIUS GREETING ===\n    const greeting = document.createElement('div');\n    greeting.className = 'sidecar-greeting';\n    const userName = currentUserProfile?.display_name?.split(' ')[0] || 'there';\n    const hour = new Date().getHours();\n    const timeGreeting = hour < 12 ? 'Good morning' : hour < 17 ? 'Good afternoon' : 'Good evening';\n    greeting.innerHTML = `\n    <span class=\"sidecar-greeting-text\">${timeGreeting}, ${userName}.</span>\n    <span class=\"sidecar-greeting-subtext\">I'm here to help.</span>\n  `;\n    cardsContainer.appendChild(greeting);\n    // === PATIENT CONTEXT (compact single line) ===\n    if (patient) {\n        const patientSection = document.createElement('div');\n        patientSection.className = 'sidecar-patient-row';\n        patientSection.setAttribute('style', `\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      padding: 4px 0;\n      border-bottom: 1px solid rgba(11, 18, 32, 0.08);\n      margin-bottom: 6px;\n    `);\n        // Label (smaller)\n        const rowLabel = document.createElement('div');\n        rowLabel.setAttribute('style', `\n      width: 40px;\n      flex: 0 0 auto;\n      font-size: 7px;\n      letter-spacing: 0.04em;\n      text-transform: uppercase;\n      color: rgba(91, 102, 122, 0.95);\n      font-weight: 600;\n    `);\n        rowLabel.textContent = 'PATIENT';\n        patientSection.appendChild(rowLabel);\n        // Patient info - single line with name + ID\n        const patientInfo = document.createElement('div');\n        patientInfo.setAttribute('style', 'flex: 1; min-width: 0; display: flex; flex-direction: row; align-items: baseline; gap: 6px;');\n        const patientName = document.createElement('span');\n        patientName.setAttribute('style', 'font-size: 10px; font-weight: 500; color: #0b1220; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;');\n        patientName.textContent = sidecarPrivacyMode ? 'Patient' : patient.name;\n        const patientId = document.createElement('span');\n        patientId.setAttribute('style', 'font-size: 9px; font-weight: 400; color: rgba(91, 102, 122, 0.7); white-space: nowrap;');\n        patientId.textContent = sidecarPrivacyMode ? '****' : ` ${patient.id.slice(-4).padStart(8, '*')}`;\n        patientInfo.appendChild(patientName);\n        patientInfo.appendChild(patientId);\n        patientSection.appendChild(patientInfo);\n        // Edit button (pencil icon like Mini)\n        const editBtn = document.createElement('button');\n        editBtn.className = 'sidecar-icon-btn';\n        editBtn.innerHTML = '<svg viewBox=\"0 0 24 24\"><path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"/></svg>';\n        editBtn.title = 'Change patient';\n        editBtn.addEventListener('click', () => {\n            showToast('Patient search coming soon');\n        });\n        patientSection.appendChild(editBtn);\n        cardsContainer.appendChild(patientSection);\n    }\n    // === BOTTLENECK CARD ===\n    const bottlenecks = sidecarState?.bottlenecks || [];\n    const bottleneckCard = BottleneckCard({\n        bottlenecks,\n        privacyContext,\n        onAnswer: async (bottleneckId, answerId) => {\n            console.log('[Mobius] Answer:', bottleneckId, answerId);\n            try {\n                await fetch(`${API_BASE_URL}/api/v1/sidecar/answer`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        ...(await getAuthHeader()),\n                    },\n                    body: JSON.stringify({\n                        session_id: sessionId,\n                        patient_key: patient?.id,\n                        bottleneck_id: bottleneckId,\n                        answer_id: answerId,\n                    }),\n                });\n                showToast('Answer recorded');\n                // Don't refresh UI immediately - let selection persist\n                // State will refresh on next poll cycle\n            }\n            catch (error) {\n                console.error('[Mobius] Failed to submit answer:', error);\n                showToast('Failed to submit answer');\n            }\n        },\n        onAssign: async (bottleneckId, mode) => {\n            console.log('[Mobius] Assign to Mobius:', bottleneckId, mode);\n            try {\n                await fetch(`${API_BASE_URL}/api/v1/sidecar/assign`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        ...(await getAuthHeader()),\n                    },\n                    body: JSON.stringify({\n                        session_id: sessionId,\n                        patient_key: patient?.id,\n                        bottleneck_id: bottleneckId,\n                        mode,\n                    }),\n                });\n                showToast('Mobius is working on it...');\n            }\n            catch (error) {\n                console.error('[Mobius] Failed to assign:', error);\n                showToast('Failed to assign');\n            }\n        },\n        onOwn: async (bottleneckId) => {\n            console.log('[Mobius] User taking ownership:', bottleneckId);\n            try {\n                await fetch(`${API_BASE_URL}/api/v1/sidecar/own`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        ...(await getAuthHeader()),\n                    },\n                    body: JSON.stringify({\n                        session_id: sessionId,\n                        patient_key: patient?.id,\n                        bottleneck_id: bottleneckId,\n                    }),\n                });\n                showToast(\"Got it - you're on it\");\n            }\n            catch (error) {\n                console.error('[Mobius] Failed to take ownership:', error);\n            }\n        },\n        onAddNote: async (bottleneckId, noteText) => {\n            try {\n                await fetch(`${API_BASE_URL}/api/v1/sidecar/note`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        ...(await getAuthHeader()),\n                    },\n                    body: JSON.stringify({\n                        session_id: sessionId,\n                        patient_key: patient?.id,\n                        bottleneck_id: bottleneckId,\n                        note_text: noteText,\n                    }),\n                });\n                showToast('Note added');\n            }\n            catch (error) {\n                console.error('[Mobius] Failed to add note:', error);\n            }\n        },\n        onBulkAssign: async (bottleneckIds) => {\n            console.log('[Mobius] Bulk assign:', bottleneckIds);\n            try {\n                await fetch(`${API_BASE_URL}/api/v1/sidecar/assign-bulk`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        ...(await getAuthHeader()),\n                    },\n                    body: JSON.stringify({\n                        session_id: sessionId,\n                        patient_key: patient?.id,\n                        bottleneck_ids: bottleneckIds,\n                    }),\n                });\n                showToast(`Assigned ${bottleneckIds.length} items to Mobius`);\n            }\n            catch (error) {\n                console.error('[Mobius] Failed to bulk assign:', error);\n            }\n        },\n    });\n    cardsContainer.appendChild(bottleneckCard);\n    // === CONTEXT EXPANDER ===\n    if (sidecarState?.milestones && sidecarState?.knowledge_context) {\n        const contextExpander = ContextExpander({\n            milestones: sidecarState.milestones,\n            knowledgeContext: sidecarState.knowledge_context,\n            privacyContext,\n            resolutionPlan: miniState.resolutionPlan,\n        });\n        cardsContainer.appendChild(contextExpander);\n    }\n    mainContent.appendChild(cardsContainer);\n    // === CHAT CONTAINER (separate from cards) ===\n    const chatContainer = document.createElement('div');\n    chatContainer.className = 'sidecar-chat-container';\n    chatContainer.setAttribute('style', 'flex: 1; min-height: 0; display: flex; flex-direction: column; border-top: 1px solid rgba(11, 18, 32, 0.08);');\n    mainContent.appendChild(chatContainer);\n    sidebarContainer.appendChild(mainContent);\n    // === QUICK CHAT ===\n    const quickChat = QuickChat({\n        record: recordContext,\n        knowledgeContext: sidecarState?.knowledge_context || { payer: { name: '' }, policy_excerpts: [], relevant_history: [] },\n        onSend: async (message) => {\n            console.log('[Mobius] Chat:', message);\n            // TODO: Implement chat with knowledge context\n            showToast('Chat coming soon');\n        },\n    });\n    sidebarContainer.appendChild(quickChat);\n    // Add to DOM\n    document.body.appendChild(sidebarContainer);\n    console.log('[Mobius OS] Sidecar UI initialized');\n}\n/**\n * Create fallback sidecar state from mini state\n */\nfunction createFallbackSidecarState(miniState, recordContext) {\n    // Convert resolution plan to bottlenecks\n    const bottlenecks = [];\n    if (miniState.resolutionPlan?.current_step) {\n        const step = miniState.resolutionPlan.current_step;\n        bottlenecks.push({\n            id: step.step_id,\n            milestone_id: step.factor_type || 'unknown',\n            question_text: step.question_text,\n            answer_options: (step.answer_options || []).map(opt => ({\n                id: opt.code,\n                label: opt.label,\n                description: opt.description,\n            })),\n            // Always allow Mobius assignment - user should have the choice\n            mobius_can_handle: true,\n            mobius_mode: step.system_suggestion ? 'agentic' : 'copilot',\n            mobius_action: step.system_suggestion?.source || 'Mobius will verify this for you',\n            sources: {},\n        });\n    }\n    return {\n        ok: true,\n        session_id: sessionId,\n        surface: 'sidecar',\n        record: recordContext,\n        care_readiness: {\n            position: 50,\n            direction: 'stable',\n            factors: {\n                visit_confirmed: { status: 'pending' },\n                eligibility_verified: { status: 'pending' },\n                authorization_secured: { status: 'pending' },\n                documentation_ready: { status: 'pending' },\n            },\n        },\n        bottlenecks,\n        milestones: [],\n        knowledge_context: {\n            payer: { name: '' },\n            policy_excerpts: [],\n            relevant_history: [],\n        },\n        alerts: [],\n        user_owned_tasks: [],\n        computed_at: new Date().toISOString(),\n    };\n}\n/**\n * Refresh sidecar state and re-render\n */\nasync function refreshSidecarState(miniState) {\n    removeSidebar();\n    await initSidecarUI(miniState);\n}\n/**\n * Get auth header for API calls\n */\nasync function getAuthHeader() {\n    const authService = getAuthService();\n    const token = await authService.getAccessToken();\n    if (token) {\n        return { 'Authorization': `Bearer ${token}` };\n    }\n    return {};\n}\nasync function collapseToMini() {\n    removeSidebar();\n    await renderMiniIfAllowed();\n}\nasync function renderMiniIfAllowed() {\n    await loadMiniPersistedState();\n    const host = getHostname();\n    const allowed = await isDomainAllowed(host);\n    if (!allowed) {\n        removeMini();\n        return;\n    }\n    if (!sessionId)\n        sessionId = await getOrCreateSessionId();\n    // Check authentication state\n    const authService = getAuthService();\n    isAuthenticated = await authService.isAuthenticated();\n    if (isAuthenticated) {\n        currentUserProfile = await authService.getUserProfile();\n    }\n    // Create mini if needed\n    let mini = document.getElementById(MINI_IDS.root);\n    if (!mini) {\n        mini = createMini();\n        document.body.appendChild(mini);\n        const initial = miniLastPos || { x: 14, y: 14 };\n        await setMiniPos(mini, initial);\n        // Apply saved theme\n        const savedTheme = await loadMiniTheme();\n        applyMiniTheme(mini, savedTheme);\n    }\n    else {\n        // Ensure it's visible after collapsing from the full sidebar.\n        mini.style.display = '';\n    }\n    // Handle locked state for unauthenticated users\n    const greetingRow = mini.querySelector('.mobius-mini-greeting-row');\n    const patientRow = mini.querySelector('.mobius-mini-row');\n    const attentionRow = mini.querySelector('.mobius-mini-attention-row');\n    const taskBadgeRow = mini.querySelector('.mobius-mini-task-badge-row');\n    const noteRow = mini.querySelectorAll('.mobius-mini-row')[3]; // note row\n    // Get or create locked overlay\n    let lockedOverlay = mini.querySelector('.mobius-mini-locked-overlay');\n    // =========================================================================\n    // Account Creation & Onboarding Flow (scoped to have access to lockedOverlay)\n    // =========================================================================\n    const API_BASE_AUTH = API_BASE_URL;\n    // Fetch available activities from backend\n    const fetchActivities = async () => {\n        try {\n            const response = await fetch(`${API_BASE_AUTH}/api/v1/auth/activities`);\n            const data = await response.json();\n            if (data.ok && data.activities) {\n                return data.activities;\n            }\n        }\n        catch (err) {\n            console.error('[Mobius] Failed to fetch activities:', err);\n        }\n        // Fallback activities if backend fails\n        return [\n            { activity_code: 'verify_eligibility', label: 'Verify Insurance Eligibility' },\n            { activity_code: 'check_in_patients', label: 'Check In Patients' },\n            { activity_code: 'schedule_appointments', label: 'Schedule Appointments' },\n            { activity_code: 'submit_claims', label: 'Submit Claims' },\n            { activity_code: 'rework_claims', label: 'Rework Denied Claims' },\n            { activity_code: 'prior_auth', label: 'Prior Authorizations' },\n            { activity_code: 'patient_collections', label: 'Patient Collections' },\n            { activity_code: 'post_payments', label: 'Post Payments' },\n        ];\n    };\n    // Show onboarding form (Step 2 of account creation)\n    const showOnboardingForm = async (firstName, accessToken) => {\n        if (!lockedOverlay)\n            return;\n        // Fetch available activities\n        const activities = await fetchActivities();\n        // Update locked overlay to be a flex container for proper scrolling\n        lockedOverlay.style.cssText = `\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n      max-height: 500px;\n      padding: 12px;\n      background: linear-gradient(180deg, rgba(248, 250, 252, 0.98), rgba(241, 245, 249, 0.98));\n      overflow: hidden;\n    `;\n        lockedOverlay.innerHTML = `\n      <div style=\"text-align: center; margin-bottom: 10px; flex-shrink: 0;\">\n        <div style=\"font-size: 16px; margin-bottom: 4px;\"></div>\n        <div style=\"font-size: 11px; font-weight: 600; color: #0b1220;\">Welcome, ${firstName}!</div>\n        <div style=\"font-size: 9px; color: #64748b; margin-top: 2px;\">Step 2 of 2 - Your preferences</div>\n      </div>\n      \n      <div class=\"mobius-mini-onboarding-form\" style=\"flex: 1; overflow-y: auto; padding-right: 4px; min-height: 0;\">\n        <!-- Preferred Name -->\n        <div style=\"margin-bottom: 10px;\">\n          <label style=\"font-size: 9px; font-weight: 500; color: #374151; display: block; margin-bottom: 4px;\">What should we call you?</label>\n          <input type=\"text\" class=\"mobius-mini-onb-name\" placeholder=\"${firstName}\" value=\"${firstName}\" style=\"\n            width: 100%;\n            box-sizing: border-box;\n            padding: 6px 8px;\n            border: 1px solid rgba(11, 18, 32, 0.15);\n            border-radius: 6px;\n            font-size: 10px;\n            outline: none;\n          \" />\n        </div>\n        \n        <!-- Activities -->\n        <div style=\"margin-bottom: 10px;\">\n          <label style=\"font-size: 9px; font-weight: 500; color: #374151; display: block; margin-bottom: 4px;\">What do you do? (select all that apply)</label>\n          <div class=\"mobius-mini-onb-activities\" style=\"display: flex; flex-wrap: wrap; gap: 4px;\">\n            ${activities.map((a) => `\n              <label style=\"display: flex; align-items: center; gap: 4px; padding: 4px 8px; background: #f8fafc; border-radius: 12px; cursor: pointer; font-size: 9px; color: #374151; border: 1px solid transparent; transition: all 0.15s;\">\n                <input type=\"checkbox\" value=\"${a.activity_code}\" style=\"width: 12px; height: 12px; margin: 0;\" />\n                <span>${a.label}</span>\n              </label>\n            `).join('')}\n          </div>\n        </div>\n        \n        <!-- AI Experience -->\n        <div style=\"margin-bottom: 10px;\">\n          <label style=\"font-size: 9px; font-weight: 500; color: #374151; display: block; margin-bottom: 4px;\">How familiar are you with AI tools?</label>\n          <div class=\"mobius-mini-onb-experience\" style=\"display: flex; flex-direction: column; gap: 4px;\">\n            <label style=\"display: flex; align-items: center; gap: 6px; padding: 6px 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px;\">\n              <input type=\"radio\" name=\"ai_exp\" value=\"beginner\" style=\"margin: 0;\" />\n              <span><strong>New to AI</strong> - I haven't used ChatGPT or similar tools</span>\n            </label>\n            <label style=\"display: flex; align-items: center; gap: 6px; padding: 6px 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px;\">\n              <input type=\"radio\" name=\"ai_exp\" value=\"regular\" checked style=\"margin: 0;\" />\n              <span><strong>Regular user</strong> - I've used AI tools for work or personal use</span>\n            </label>\n            <label style=\"display: flex; align-items: center; gap: 6px; padding: 6px 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px;\">\n              <input type=\"radio\" name=\"ai_exp\" value=\"power_user\" style=\"margin: 0;\" />\n              <span><strong>Power user</strong> - I use AI daily and understand its capabilities</span>\n            </label>\n          </div>\n        </div>\n        \n        <!-- Autonomy - Routine Tasks -->\n        <div style=\"margin-bottom: 10px;\">\n          <label style=\"font-size: 9px; font-weight: 500; color: #374151; display: block; margin-bottom: 4px;\">For routine tasks (like sending reminders), should Mobius:</label>\n          <div class=\"mobius-mini-onb-routine\" style=\"display: flex; flex-direction: column; gap: 4px;\">\n            <label style=\"display: flex; align-items: center; gap: 6px; padding: 6px 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px;\">\n              <input type=\"radio\" name=\"routine\" value=\"automatic\" style=\"margin: 0;\" />\n              <span><strong>Act automatically</strong> - Just do it and let me know</span>\n            </label>\n            <label style=\"display: flex; align-items: center; gap: 6px; padding: 6px 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px;\">\n              <input type=\"radio\" name=\"routine\" value=\"confirm_first\" checked style=\"margin: 0;\" />\n              <span><strong>Ask first</strong> - Show me what you'll do before doing it</span>\n            </label>\n            <label style=\"display: flex; align-items: center; gap: 6px; padding: 6px 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px;\">\n              <input type=\"radio\" name=\"routine\" value=\"manual\" style=\"margin: 0;\" />\n              <span><strong>I'll do it</strong> - Just guide me, I'll take action myself</span>\n            </label>\n          </div>\n        </div>\n        \n        <!-- Autonomy - Sensitive Tasks -->\n        <div style=\"margin-bottom: 10px;\">\n          <label style=\"font-size: 9px; font-weight: 500; color: #374151; display: block; margin-bottom: 4px;\">For sensitive tasks (like submitting claims), should Mobius:</label>\n          <div class=\"mobius-mini-onb-sensitive\" style=\"display: flex; flex-direction: column; gap: 4px;\">\n            <label style=\"display: flex; align-items: center; gap: 6px; padding: 6px 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px;\">\n              <input type=\"radio\" name=\"sensitive\" value=\"confirm_first\" style=\"margin: 0;\" />\n              <span><strong>Ask first</strong> - Always confirm before taking action</span>\n            </label>\n            <label style=\"display: flex; align-items: center; gap: 6px; padding: 6px 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px;\">\n              <input type=\"radio\" name=\"sensitive\" value=\"manual\" checked style=\"margin: 0;\" />\n              <span><strong>I'll do it</strong> - Just prepare it, I'll submit myself</span>\n            </label>\n          </div>\n        </div>\n        \n        <!-- Communication Style -->\n        <div style=\"margin-bottom: 12px;\">\n          <label style=\"font-size: 9px; font-weight: 500; color: #374151; display: block; margin-bottom: 4px;\">How should Mobius communicate with you?</label>\n          <div class=\"mobius-mini-onb-tone\" style=\"display: flex; gap: 6px;\">\n            <label style=\"flex: 1; display: flex; flex-direction: column; align-items: center; padding: 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px; border: 2px solid transparent;\" class=\"tone-option\" data-tone=\"professional\">\n              <input type=\"radio\" name=\"tone\" value=\"professional\" checked style=\"margin: 0 0 4px 0;\" />\n              <span style=\"font-weight: 500;\">Professional</span>\n              <span style=\"color: #64748b; font-size: 8px;\">Clear & formal</span>\n            </label>\n            <label style=\"flex: 1; display: flex; flex-direction: column; align-items: center; padding: 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px; border: 2px solid transparent;\" class=\"tone-option\" data-tone=\"friendly\">\n              <input type=\"radio\" name=\"tone\" value=\"friendly\" style=\"margin: 0 0 4px 0;\" />\n              <span style=\"font-weight: 500;\">Friendly</span>\n              <span style=\"color: #64748b; font-size: 8px;\">Warm & helpful</span>\n            </label>\n            <label style=\"flex: 1; display: flex; flex-direction: column; align-items: center; padding: 8px; background: #f8fafc; border-radius: 6px; cursor: pointer; font-size: 9px; border: 2px solid transparent;\" class=\"tone-option\" data-tone=\"concise\">\n              <input type=\"radio\" name=\"tone\" value=\"concise\" style=\"margin: 0 0 4px 0;\" />\n              <span style=\"font-weight: 500;\">Concise</span>\n              <span style=\"color: #64748b; font-size: 8px;\">Brief & direct</span>\n            </label>\n          </div>\n        </div>\n      </div>\n      \n      <div style=\"flex-shrink: 0; padding-top: 8px;\">\n        <button class=\"mobius-mini-onb-submit\" style=\"\n          width: 100%;\n          padding: 10px 12px;\n          background: #2563eb;\n          color: white;\n          border: none;\n          border-radius: 6px;\n          font-size: 10px;\n          font-weight: 500;\n          cursor: pointer;\n        \">Get Started</button>\n        <div class=\"mobius-mini-onb-error\" style=\"\n          font-size: 9px;\n          color: #dc2626;\n          margin-top: 6px;\n          display: none;\n        \"></div>\n        <div style=\"text-align: center; font-size: 8px; color: #94a3b8; margin-top: 6px;\">\n          You can change these anytime in preferences\n        </div>\n      </div>\n    `;\n        // Wire up form interactions\n        const nameInput = lockedOverlay.querySelector('.mobius-mini-onb-name');\n        const submitBtn = lockedOverlay.querySelector('.mobius-mini-onb-submit');\n        const errorDiv = lockedOverlay.querySelector('.mobius-mini-onb-error');\n        // Highlight selected tone\n        lockedOverlay.querySelectorAll('.tone-option').forEach((opt) => {\n            const radio = opt.querySelector('input[type=\"radio\"]');\n            if (radio?.checked) {\n                opt.style.borderColor = '#2563eb';\n                opt.style.background = '#eff6ff';\n            }\n            opt.addEventListener('click', () => {\n                lockedOverlay.querySelectorAll('.tone-option').forEach((o) => {\n                    o.style.borderColor = 'transparent';\n                    o.style.background = '#f8fafc';\n                });\n                opt.style.borderColor = '#2563eb';\n                opt.style.background = '#eff6ff';\n            });\n        });\n        // Highlight checked activity checkboxes\n        lockedOverlay.querySelectorAll('.mobius-mini-onb-activities input[type=\"checkbox\"]').forEach((cb) => {\n            cb.addEventListener('change', () => {\n                const label = cb.closest('label');\n                if (cb.checked) {\n                    label.style.borderColor = '#2563eb';\n                    label.style.background = '#eff6ff';\n                }\n                else {\n                    label.style.borderColor = 'transparent';\n                    label.style.background = '#f8fafc';\n                }\n            });\n        });\n        const doOnboarding = async () => {\n            const preferredName = nameInput?.value.trim() || firstName;\n            // Gather selected activities\n            const selectedActivities = [];\n            lockedOverlay.querySelectorAll('.mobius-mini-onb-activities input[type=\"checkbox\"]:checked').forEach((cb) => {\n                selectedActivities.push(cb.value);\n            });\n            // Get AI experience level\n            const aiExp = lockedOverlay.querySelector('input[name=\"ai_exp\"]:checked')?.value || 'regular';\n            // Get autonomy preferences\n            const routineAutonomy = lockedOverlay.querySelector('input[name=\"routine\"]:checked')?.value || 'confirm_first';\n            const sensitiveAutonomy = lockedOverlay.querySelector('input[name=\"sensitive\"]:checked')?.value || 'manual';\n            // Get tone preference\n            const tone = lockedOverlay.querySelector('input[name=\"tone\"]:checked')?.value || 'professional';\n            if (submitBtn) {\n                submitBtn.textContent = 'Setting up...';\n                submitBtn.disabled = true;\n            }\n            try {\n                const response = await fetch(`${API_BASE_AUTH}/api/v1/auth/onboarding`, {\n                    method: 'PUT',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${accessToken}`,\n                    },\n                    body: JSON.stringify({\n                        preferred_name: preferredName,\n                        activities: selectedActivities,\n                        ai_experience_level: aiExp,\n                        autonomy_routine_tasks: routineAutonomy,\n                        autonomy_sensitive_tasks: sensitiveAutonomy,\n                        tone,\n                        greeting_enabled: true,\n                    }),\n                });\n                const data = await response.json();\n                if (data.ok) {\n                    showToast(`Welcome to Mobius, ${preferredName}!`);\n                    // Refresh user profile and re-render Mini\n                    const authService = getAuthService();\n                    currentUserProfile = await authService.getCurrentUser();\n                    isAuthenticated = true;\n                    await renderMiniIfAllowed();\n                }\n                else {\n                    if (errorDiv) {\n                        errorDiv.textContent = data.error || 'Failed to save preferences';\n                        errorDiv.style.display = 'block';\n                    }\n                    if (submitBtn) {\n                        submitBtn.textContent = 'Get Started';\n                        submitBtn.disabled = false;\n                    }\n                }\n            }\n            catch (err) {\n                if (errorDiv) {\n                    errorDiv.textContent = 'Connection error. Please try again.';\n                    errorDiv.style.display = 'block';\n                }\n                if (submitBtn) {\n                    submitBtn.textContent = 'Get Started';\n                    submitBtn.disabled = false;\n                }\n            }\n        };\n        submitBtn?.addEventListener('click', () => void doOnboarding());\n    };\n    // Show registration form (Step 1 of account creation)\n    const showRegistrationForm = () => {\n        if (!lockedOverlay) {\n            // Create lockedOverlay if it doesn't exist\n            lockedOverlay = document.createElement('div');\n            lockedOverlay.className = 'mobius-mini-locked-overlay';\n            lockedOverlay.style.cssText = `\n        padding: 12px;\n        background: linear-gradient(180deg, rgba(248, 250, 252, 0.98), rgba(241, 245, 249, 0.98));\n      `;\n            mini.appendChild(lockedOverlay);\n        }\n        lockedOverlay.innerHTML = `\n      <div style=\"text-align: center; margin-bottom: 12px;\">\n        <div style=\"font-size: 18px; margin-bottom: 4px;\"></div>\n        <div style=\"font-size: 11px; font-weight: 600; color: #0b1220;\">Create Your Account</div>\n        <div style=\"font-size: 9px; color: #64748b; margin-top: 2px;\">Step 1 of 2</div>\n      </div>\n      <div class=\"mobius-mini-register-form\">\n        <input type=\"text\" class=\"mobius-mini-reg-firstname\" placeholder=\"First name *\" style=\"\n          width: 100%;\n          box-sizing: border-box;\n          padding: 8px 10px;\n          border: 1px solid rgba(11, 18, 32, 0.15);\n          border-radius: 6px;\n          font-size: 10px;\n          margin-bottom: 6px;\n          outline: none;\n        \" />\n        <input type=\"text\" class=\"mobius-mini-reg-lastname\" placeholder=\"Last name (optional)\" style=\"\n          width: 100%;\n          box-sizing: border-box;\n          padding: 8px 10px;\n          border: 1px solid rgba(11, 18, 32, 0.15);\n          border-radius: 6px;\n          font-size: 10px;\n          margin-bottom: 6px;\n          outline: none;\n        \" />\n        <input type=\"email\" class=\"mobius-mini-reg-email\" placeholder=\"Email address *\" style=\"\n          width: 100%;\n          box-sizing: border-box;\n          padding: 8px 10px;\n          border: 1px solid rgba(11, 18, 32, 0.15);\n          border-radius: 6px;\n          font-size: 10px;\n          margin-bottom: 6px;\n          outline: none;\n        \" />\n        <input type=\"password\" class=\"mobius-mini-reg-password\" placeholder=\"Password (8+ characters) *\" style=\"\n          width: 100%;\n          box-sizing: border-box;\n          padding: 8px 10px;\n          border: 1px solid rgba(11, 18, 32, 0.15);\n          border-radius: 6px;\n          font-size: 10px;\n          margin-bottom: 6px;\n          outline: none;\n        \" />\n        <input type=\"password\" class=\"mobius-mini-reg-confirm\" placeholder=\"Confirm password *\" style=\"\n          width: 100%;\n          box-sizing: border-box;\n          padding: 8px 10px;\n          border: 1px solid rgba(11, 18, 32, 0.15);\n          border-radius: 6px;\n          font-size: 10px;\n          margin-bottom: 8px;\n          outline: none;\n        \" />\n        <button class=\"mobius-mini-reg-submit\" style=\"\n          width: 100%;\n          padding: 8px 12px;\n          background: #2563eb;\n          color: white;\n          border: none;\n          border-radius: 6px;\n          font-size: 10px;\n          font-weight: 500;\n          cursor: pointer;\n        \">Continue</button>\n        <div class=\"mobius-mini-reg-error\" style=\"\n          font-size: 9px;\n          color: #dc2626;\n          margin-top: 6px;\n          display: none;\n        \"></div>\n        <div style=\"text-align: center; font-size: 9px; color: #64748b; margin-top: 10px;\">\n          Already have an account? \n          <a href=\"#\" class=\"mobius-mini-back-to-login\" style=\"color: #2563eb; text-decoration: none; font-weight: 500;\">Sign in</a>\n        </div>\n      </div>\n    `;\n        // Wire up form\n        const firstNameInput = lockedOverlay.querySelector('.mobius-mini-reg-firstname');\n        const lastNameInput = lockedOverlay.querySelector('.mobius-mini-reg-lastname');\n        const emailInput = lockedOverlay.querySelector('.mobius-mini-reg-email');\n        const passwordInput = lockedOverlay.querySelector('.mobius-mini-reg-password');\n        const confirmInput = lockedOverlay.querySelector('.mobius-mini-reg-confirm');\n        const submitBtn = lockedOverlay.querySelector('.mobius-mini-reg-submit');\n        const errorDiv = lockedOverlay.querySelector('.mobius-mini-reg-error');\n        const backToLoginLink = lockedOverlay.querySelector('.mobius-mini-back-to-login');\n        const showError = (msg) => {\n            if (errorDiv) {\n                errorDiv.textContent = msg;\n                errorDiv.style.display = 'block';\n            }\n        };\n        const doRegister = async () => {\n            const firstName = firstNameInput?.value.trim() || '';\n            const lastName = lastNameInput?.value.trim() || '';\n            const email = emailInput?.value.trim() || '';\n            const password = passwordInput?.value || '';\n            const confirm = confirmInput?.value || '';\n            // Validation\n            if (!firstName) {\n                showError('First name is required');\n                return;\n            }\n            if (!email) {\n                showError('Email is required');\n                return;\n            }\n            if (!password) {\n                showError('Password is required');\n                return;\n            }\n            if (password.length < 8) {\n                showError('Password must be at least 8 characters');\n                return;\n            }\n            if (password !== confirm) {\n                showError('Passwords do not match');\n                return;\n            }\n            if (submitBtn) {\n                submitBtn.textContent = 'Creating account...';\n                submitBtn.disabled = true;\n            }\n            if (errorDiv)\n                errorDiv.style.display = 'none';\n            try {\n                const response = await fetch(`${API_BASE_AUTH}/api/v1/auth/register`, {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        email,\n                        password,\n                        first_name: firstName,\n                        display_name: lastName ? `${firstName} ${lastName}` : firstName,\n                    }),\n                });\n                const data = await response.json();\n                if (data.ok && data.access_token) {\n                    // Store auth tokens\n                    const authService = getAuthService();\n                    await authService.storeTokens({\n                        access_token: data.access_token,\n                        refresh_token: data.refresh_token,\n                        expires_in: data.expires_in || 3600,\n                    });\n                    // Show onboarding step\n                    showOnboardingForm(firstName, data.access_token);\n                }\n                else {\n                    showError(data.error || 'Registration failed');\n                    if (submitBtn) {\n                        submitBtn.textContent = 'Continue';\n                        submitBtn.disabled = false;\n                    }\n                }\n            }\n            catch (err) {\n                showError('Connection error. Please try again.');\n                if (submitBtn) {\n                    submitBtn.textContent = 'Continue';\n                    submitBtn.disabled = false;\n                }\n            }\n        };\n        submitBtn?.addEventListener('click', () => void doRegister());\n        confirmInput?.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter')\n                void doRegister();\n        });\n        // Back to login\n        backToLoginLink?.addEventListener('click', (e) => {\n            e.preventDefault();\n            void renderMiniIfAllowed(); // Re-render shows login form\n        });\n    };\n    if (!isAuthenticated) {\n        // Show locked state with login form\n        if (!lockedOverlay) {\n            lockedOverlay = document.createElement('div');\n            lockedOverlay.className = 'mobius-mini-locked-overlay';\n            lockedOverlay.style.cssText = `\n        padding: 12px;\n        background: linear-gradient(180deg, rgba(248, 250, 252, 0.98), rgba(241, 245, 249, 0.98));\n      `;\n            lockedOverlay.innerHTML = `\n        <div style=\"text-align: center; margin-bottom: 10px;\">\n          <div style=\"font-size: 20px; margin-bottom: 4px;\"></div>\n          <div style=\"font-size: 10px; font-weight: 600; color: #0b1220;\">Sign in to Mobius</div>\n        </div>\n        <div class=\"mobius-mini-login-form\">\n          <input type=\"email\" class=\"mobius-mini-login-email\" placeholder=\"Email\" style=\"\n            width: 100%;\n            box-sizing: border-box;\n            padding: 8px 10px;\n            border: 1px solid rgba(11, 18, 32, 0.15);\n            border-radius: 6px;\n            font-size: 10px;\n            margin-bottom: 6px;\n            outline: none;\n          \" value=\"sarah.chen@demo.clinic\" />\n          <input type=\"password\" class=\"mobius-mini-login-password\" placeholder=\"Password\" style=\"\n            width: 100%;\n            box-sizing: border-box;\n            padding: 8px 10px;\n            border: 1px solid rgba(11, 18, 32, 0.15);\n            border-radius: 6px;\n            font-size: 10px;\n            margin-bottom: 8px;\n            outline: none;\n          \" value=\"demo1234\" />\n          <button class=\"mobius-mini-signin-btn\" style=\"\n            width: 100%;\n            padding: 8px 12px;\n            background: #2563eb;\n            color: white;\n            border: none;\n            border-radius: 6px;\n            font-size: 10px;\n            font-weight: 500;\n            cursor: pointer;\n          \">Sign in</button>\n          <div class=\"mobius-mini-login-error\" style=\"\n            font-size: 9px;\n            color: #dc2626;\n            margin-top: 6px;\n            display: none;\n          \"></div>\n          \n          <!-- Divider -->\n          <div style=\"display: flex; align-items: center; margin: 12px 0 10px;\">\n            <div style=\"flex: 1; height: 1px; background: rgba(11, 18, 32, 0.1);\"></div>\n            <span style=\"padding: 0 8px; font-size: 8px; color: #94a3b8;\">or continue with</span>\n            <div style=\"flex: 1; height: 1px; background: rgba(11, 18, 32, 0.1);\"></div>\n          </div>\n          \n          <!-- OAuth options -->\n          <div style=\"display: flex; gap: 8px; margin-bottom: 10px;\">\n            <button class=\"mobius-mini-oauth-btn\" data-provider=\"google\" style=\"\n              flex: 1;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              gap: 6px;\n              padding: 8px;\n              background: white;\n              border: 1px solid rgba(11, 18, 32, 0.15);\n              border-radius: 6px;\n              font-size: 9px;\n              color: #374151;\n              cursor: pointer;\n            \">\n              <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\">\n                <path fill=\"#4285F4\" d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"/>\n                <path fill=\"#34A853\" d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"/>\n                <path fill=\"#FBBC05\" d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"/>\n                <path fill=\"#EA4335\" d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"/>\n              </svg>\n              Google\n            </button>\n            <button class=\"mobius-mini-oauth-btn\" data-provider=\"microsoft\" style=\"\n              flex: 1;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              gap: 6px;\n              padding: 8px;\n              background: white;\n              border: 1px solid rgba(11, 18, 32, 0.15);\n              border-radius: 6px;\n              font-size: 9px;\n              color: #374151;\n              cursor: pointer;\n            \">\n              <svg width=\"12\" height=\"12\" viewBox=\"0 0 23 23\">\n                <path fill=\"#f35325\" d=\"M1 1h10v10H1z\"/>\n                <path fill=\"#81bc06\" d=\"M12 1h10v10H12z\"/>\n                <path fill=\"#05a6f0\" d=\"M1 12h10v10H1z\"/>\n                <path fill=\"#ffba08\" d=\"M12 12h10v10H12z\"/>\n              </svg>\n              Microsoft\n            </button>\n          </div>\n          \n          <!-- Enterprise SSO -->\n          <button class=\"mobius-mini-sso-btn\" style=\"\n            width: 100%;\n            padding: 8px 12px;\n            background: #f8fafc;\n            border: 1px solid rgba(11, 18, 32, 0.15);\n            border-radius: 6px;\n            font-size: 9px;\n            color: #374151;\n            cursor: pointer;\n            margin-bottom: 10px;\n          \">\n            <span style=\"display: flex; align-items: center; justify-content: center; gap: 6px;\">\n              <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                <path d=\"M12 2L2 7l10 5 10-5-10-5z\"/>\n                <path d=\"M2 17l10 5 10-5\"/>\n                <path d=\"M2 12l10 5 10-5\"/>\n              </svg>\n              Enterprise SSO\n            </span>\n          </button>\n          \n          <!-- Create account link -->\n          <div style=\"text-align: center; font-size: 9px; color: #64748b;\">\n            Don't have an account? \n            <a href=\"#\" class=\"mobius-mini-create-account\" style=\"color: #2563eb; text-decoration: none; font-weight: 500;\">Create one</a>\n          </div>\n          \n          <div style=\"font-size: 8px; color: #94a3b8; margin-top: 8px; text-align: center;\">\n            Demo: sarah.chen@demo.clinic\n          </div>\n        </div>\n      `;\n            mini.appendChild(lockedOverlay);\n            // Wire up login form\n            const emailInput = lockedOverlay.querySelector('.mobius-mini-login-email');\n            const passwordInput = lockedOverlay.querySelector('.mobius-mini-login-password');\n            const signInBtn = lockedOverlay.querySelector('.mobius-mini-signin-btn');\n            const errorDiv = lockedOverlay.querySelector('.mobius-mini-login-error');\n            const doLogin = async () => {\n                const email = emailInput?.value.trim() || '';\n                const password = passwordInput?.value || '';\n                if (!email || !password) {\n                    if (errorDiv) {\n                        errorDiv.textContent = 'Please enter email and password';\n                        errorDiv.style.display = 'block';\n                    }\n                    return;\n                }\n                if (signInBtn) {\n                    signInBtn.textContent = 'Signing in...';\n                    signInBtn.disabled = true;\n                }\n                try {\n                    const authService = getAuthService();\n                    const result = await authService.login(email, password);\n                    if (result.success) {\n                        showToast('Signed in successfully!');\n                        // Refresh Mini to show authenticated state\n                        await renderMiniIfAllowed();\n                    }\n                    else {\n                        if (errorDiv) {\n                            errorDiv.textContent = result.error || 'Login failed';\n                            errorDiv.style.display = 'block';\n                        }\n                    }\n                }\n                catch (err) {\n                    if (errorDiv) {\n                        errorDiv.textContent = 'Connection error';\n                        errorDiv.style.display = 'block';\n                    }\n                }\n                finally {\n                    if (signInBtn) {\n                        signInBtn.textContent = 'Sign in';\n                        signInBtn.disabled = false;\n                    }\n                }\n            };\n            signInBtn?.addEventListener('click', () => void doLogin());\n            passwordInput?.addEventListener('keydown', (e) => {\n                if (e.key === 'Enter')\n                    void doLogin();\n            });\n            // OAuth button handlers\n            lockedOverlay.querySelectorAll('.mobius-mini-oauth-btn').forEach(btn => {\n                btn.addEventListener('click', () => {\n                    const provider = btn.dataset.provider;\n                    // TODO: Implement OAuth flow\n                    showToast(`${provider === 'google' ? 'Google' : 'Microsoft'} sign-in coming soon`);\n                    console.log(`[Mobius] OAuth login with ${provider}`);\n                });\n                // Hover effect\n                btn.addEventListener('mouseenter', () => {\n                    btn.style.background = '#f1f5f9';\n                });\n                btn.addEventListener('mouseleave', () => {\n                    btn.style.background = 'white';\n                });\n            });\n            // SSO button handler\n            const ssoBtn = lockedOverlay.querySelector('.mobius-mini-sso-btn');\n            ssoBtn?.addEventListener('click', () => {\n                // TODO: Implement Enterprise SSO flow\n                showToast('Enterprise SSO coming soon');\n                console.log('[Mobius] Enterprise SSO login');\n            });\n            ssoBtn?.addEventListener('mouseenter', () => {\n                ssoBtn.style.background = '#f1f5f9';\n            });\n            ssoBtn?.addEventListener('mouseleave', () => {\n                ssoBtn.style.background = '#f8fafc';\n            });\n            // Create account link handler\n            const createAccountLink = lockedOverlay.querySelector('.mobius-mini-create-account');\n            createAccountLink?.addEventListener('click', (e) => {\n                e.preventDefault();\n                showRegistrationForm();\n            });\n        }\n        lockedOverlay.style.display = '';\n        // Hide content rows when locked\n        if (greetingRow)\n            greetingRow.style.display = 'none';\n        if (patientRow)\n            patientRow.style.display = 'none';\n        if (attentionRow)\n            attentionRow.style.display = 'none';\n        if (taskBadgeRow)\n            taskBadgeRow.style.display = 'none';\n        if (noteRow)\n            noteRow.style.display = 'none';\n        return;\n    }\n    // Hide locked overlay when authenticated\n    if (lockedOverlay)\n        lockedOverlay.style.display = 'none';\n    // Show content rows\n    if (patientRow)\n        patientRow.style.display = '';\n    if (attentionRow)\n        attentionRow.style.display = '';\n    if (noteRow)\n        noteRow.style.display = '';\n    // Fetch status from backend\n    try {\n        const patientKey = patientOverride?.id || undefined;\n        const status = await fetchMiniStatus(sessionId, patientKey);\n        miniProceed = {\n            color: (status.proceed.color || 'grey'),\n            text: status.proceed.text || '',\n        };\n        if (status.tasking) {\n            miniTasking = {\n                color: (status.tasking.color || 'grey'),\n                text: status.tasking.text || '',\n                mode: status.tasking.mode,\n                mode_text: status.tasking.mode_text,\n            };\n        }\n        // Extract user/personalization data from response\n        if (status.user) {\n            // Merge response user data with existing profile (response has simplified structure)\n            currentUserProfile = {\n                ...currentUserProfile,\n                user_id: status.user.user_id,\n                display_name: status.user.display_name,\n                greeting_name: status.user.greeting_name,\n                is_onboarded: status.user.is_onboarded,\n            };\n        }\n        if (status.personalization) {\n            currentPersonalization = status.personalization;\n            // Update greeting row\n            if (greetingRow && currentPersonalization.greeting && !greetingDismissed) {\n                const greetingText = greetingRow.querySelector('.mobius-mini-greeting-text');\n                if (greetingText) {\n                    greetingText.textContent = currentPersonalization.greeting;\n                }\n                greetingRow.style.display = '';\n            }\n        }\n        else if (currentUserProfile && !greetingDismissed) {\n            // Fallback greeting if no personalization from server\n            const displayName = currentUserProfile.display_name || currentUserProfile.email?.split('@')[0] || 'there';\n            const greetingText = greetingRow?.querySelector('.mobius-mini-greeting-text');\n            if (greetingText) {\n                greetingText.textContent = `Hello, ${displayName}`;\n            }\n            if (greetingRow)\n                greetingRow.style.display = '';\n        }\n        // Update needs_attention state\n        if (status.needs_attention) {\n            needsAttention = {\n                color: (status.needs_attention.color || 'grey'),\n                problemStatement: status.needs_attention.problem_statement || null,\n                userStatus: (status.needs_attention.user_status || null),\n            };\n        }\n        else {\n            needsAttention = {\n                color: (status.proceed.color || 'grey'),\n                problemStatement: status.proceed.text || null,\n                userStatus: null,\n            };\n        }\n        taskCount = status.task_count || 0;\n        resolutionPlan = status.resolution_plan || null;\n        actionsForUser = status.actions_for_user || 0;\n        // Update patient info from response if available\n        if (status.patient?.found && status.patient.display_name) {\n            const nameEl = mini.querySelector('.mobius-mini-patient-name');\n            const idEl = mini.querySelector('.mobius-mini-patient-id');\n            if (nameEl)\n                nameEl.textContent = status.patient.display_name;\n            if (idEl && status.patient.id_masked)\n                idEl.textContent = `ID ${status.patient.id_masked}`;\n            // Update minimized info patient name\n            const minimizedPatient = mini.querySelector('.mobius-mini-minimized-patient');\n            if (minimizedPatient)\n                minimizedPatient.textContent = status.patient.display_name;\n        }\n    }\n    catch {\n        // keep defaults\n    }\n    // Calculate effective attention color\n    let effectiveAttentionColor = needsAttention.color;\n    if (needsAttention.userStatus === 'resolved')\n        effectiveAttentionColor = 'green';\n    else if (needsAttention.userStatus === 'confirmed_unresolved')\n        effectiveAttentionColor = 'yellow';\n    else if (needsAttention.userStatus === 'unable_to_confirm')\n        effectiveAttentionColor = 'grey';\n    // Update Needs Attention UI (new layout: problem text + status badge)\n    if (attentionRow) {\n        const dot = attentionRow.querySelector('.mobius-mini-dot');\n        const problemText = attentionRow.querySelector('.mobius-mini-problem-text');\n        const badgeText = attentionRow.querySelector('.mobius-mini-badge-text');\n        const badge = attentionRow.querySelector('.mobius-mini-status-badge');\n        // Dot color reflects status\n        if (dot) {\n            dot.className = `mobius-mini-dot ${colorToCssClass(effectiveAttentionColor)}`;\n        }\n        // Problem statement always visible\n        if (problemText) {\n            problemText.textContent = needsAttention.problemStatement || 'No issues detected';\n        }\n        // Status badge shows current status\n        if (badgeText && badge) {\n            if (needsAttention.userStatus === 'resolved') {\n                badgeText.textContent = 'Resolved';\n                badge.className = 'mobius-mini-status-badge status-resolved';\n            }\n            else if (needsAttention.userStatus === 'confirmed_unresolved') {\n                badgeText.textContent = 'Unresolved';\n                badge.className = 'mobius-mini-status-badge status-unresolved';\n            }\n            else if (needsAttention.userStatus === 'unable_to_confirm') {\n                badgeText.textContent = 'Unconfirmed';\n                badge.className = 'mobius-mini-status-badge status-unconfirmed';\n            }\n            else {\n                badgeText.textContent = 'Set status';\n                badge.className = 'mobius-mini-status-badge';\n            }\n        }\n    }\n    // Update minimized info dot\n    const minimizedInfoEl = mini.querySelector('.mobius-mini-minimized-info');\n    if (minimizedInfoEl) {\n        const minimizedDot = minimizedInfoEl.querySelector('.mobius-mini-dot');\n        if (minimizedDot) {\n            minimizedDot.className = `mobius-mini-dot ${colorToCssClass(effectiveAttentionColor)}`;\n        }\n    }\n    // Update task badge\n    if (taskBadgeRow) {\n        const countEl = taskBadgeRow.querySelector('.mobius-mini-task-count');\n        if (countEl)\n            countEl.textContent = String(taskCount);\n        taskBadgeRow.style.display = taskCount > 0 ? '' : 'none';\n    }\n    // Legacy UI update (hidden rows)\n    const rows = mini.querySelectorAll('.mobius-mini-row');\n    // Legacy proceed/tasking rows are now hidden\n    // Start patient context detection if enabled\n    if (isAutoDetectionEnabled) {\n        startPatientContextDetection();\n    }\n}\n// Initialize sidebar\nasync function initSidebar() {\n    console.log('[Mobius OS] Initializing sidebar...');\n    // Check if sidebar already exists\n    if (document.getElementById('mobius-os-sidebar')) {\n        console.log('[Mobius OS] Sidebar already exists, skipping initialization');\n        return Promise.resolve();\n    }\n    // Create sidebar container\n    sidebarContainer = document.createElement('div');\n    sidebarContainer.id = 'mobius-os-sidebar';\n    sidebarContainer.setAttribute('style', `\n    position: fixed !important;\n    top: 0 !important;\n    right: 0 !important;\n    width: 450px !important;\n    height: 100vh !important;\n    min-height: 100vh !important;\n    max-height: 100vh !important;\n    background: white !important;\n    z-index: 2147483647 !important;\n    box-shadow: -2px 0 8px rgba(0,0,0,0.1) !important;\n    overflow: hidden !important;\n    display: flex !important;\n    flex-direction: column !important;\n    margin: 0 !important;\n    padding: 0 !important;\n  `);\n    // Adjust page content to make room for sidebar\n    const style = document.createElement('style');\n    style.id = 'mobius-os-page-adjust';\n    style.textContent = `\n    body {\n      margin-right: 450px !important;\n      transition: margin-right 0.3s ease !important;\n    }\n    html {\n      overflow-x: hidden !important;\n    }\n  `;\n    document.head.appendChild(style);\n    // Get or create session ID\n    sessionId = await getOrCreateSessionId();\n    // Create top row / header\n    const topRow = document.createElement('div');\n    topRow.className = 'top-row';\n    const headerLeft = document.createElement('div');\n    headerLeft.className = 'header-left';\n    headerLeft.appendChild(ClientLogo({ clientName: 'CMHC' }));\n    const logoSection = document.createElement('div');\n    logoSection.className = 'logo-section';\n    // Track the currently-mounted Mobius logo element; replaceChild must target a node that is\n    // actually attached, otherwise it throws and aborts the send handler.\n    let currentMobiusLogoEl = MobiusLogo({ status: mobiusStatus });\n    logoSection.appendChild(currentMobiusLogoEl);\n    const logoLabel = document.createElement('span');\n    logoLabel.className = 'logo-label';\n    logoLabel.textContent = 'Mobius OS';\n    logoSection.appendChild(logoLabel);\n    headerLeft.appendChild(logoSection);\n    topRow.appendChild(headerLeft);\n    let contextDisplayEl = ContextDisplay({ status: currentStatus, mode: currentMode });\n    topRow.appendChild(contextDisplayEl);\n    const headerActions = document.createElement('div');\n    headerActions.className = 'header-actions';\n    headerActions.appendChild(AlertButton({\n        hasAlerts: false,\n        onClick: () => alert('Live Alerts:\\n- No active alerts')\n    }));\n    headerActions.appendChild(SettingsButton({ onClick: () => alert('Settings') }));\n    // Collapse control (minimally invasive)\n    const collapseBtn = document.createElement('button');\n    collapseBtn.className = 'collapse-btn';\n    collapseBtn.type = 'button';\n    collapseBtn.title = 'Collapse';\n    collapseBtn.textContent = '';\n    collapseBtn.addEventListener('click', () => {\n        void collapseToMini();\n    });\n    headerActions.appendChild(collapseBtn);\n    topRow.appendChild(headerActions);\n    sidebarContainer.appendChild(topRow);\n    // Second row - context summary\n    const secondRow = document.createElement('div');\n    secondRow.className = 'second-row';\n    const contextMount = document.createElement('div');\n    contextMount.className = 'context-mount';\n    secondRow.appendChild(contextMount);\n    sidebarContainer.appendChild(secondRow);\n    // Tasks panel\n    const tasksPanel = TasksPanel({\n        tasks: tasks,\n        status: 'active',\n        isCollapsed: false,\n        onTaskToggle: (taskId, checked) => {\n            const task = tasks.find(t => t.id === taskId);\n            if (task)\n                task.checked = checked;\n        }\n    });\n    sidebarContainer.appendChild(tasksPanel);\n    // Chat area container\n    const chatAreaContainer = document.createElement('div');\n    chatAreaContainer.className = 'chat-area';\n    chatAreaContainer.id = 'chatArea';\n    sidebarContainer.appendChild(chatAreaContainer);\n    // Function to render messages\n    function renderMessages() {\n        chatAreaContainer.innerHTML = '';\n        const chatArea = ChatArea({\n            messages,\n            onFeedbackSubmit: (messageId, rating, feedback) => {\n                console.log('Feedback submitted:', { messageId, rating, feedback });\n            }\n        });\n        chatAreaContainer.appendChild(chatArea);\n    }\n    // Chat input\n    const chatInput = ChatInput({\n        onSend: async (messageText) => {\n            // Add user message\n            const userMessage = {\n                id: `msg_${Date.now()}`,\n                content: messageText,\n                timestamp: new Date().toISOString(),\n                sessionId,\n                type: 'user'\n            };\n            messages.push(userMessage);\n            renderMessages();\n            // Update Mobius logo to processing\n            mobiusStatus = 'processing';\n            const processingEl = MobiusLogo({ status: mobiusStatus });\n            logoSection.replaceChild(processingEl, currentMobiusLogoEl);\n            currentMobiusLogoEl = processingEl;\n            try {\n                // Send to backend\n                const response = await sendChatMessage(messageText, sessionId);\n                // Client is the source of truth for mode UI defaults. Backend is per-message overrides only.\n                const uiDefaults = getUiDefaultsForMode(currentMode);\n                const serverMessages = Array.isArray(response.messages) ? response.messages : [];\n                if (serverMessages.length > 0) {\n                    for (const m of serverMessages) {\n                        const ui = { ...uiDefaults, ...(m.ui_overrides || {}) };\n                        const systemMsg = {\n                            id: `msg_${Date.now()}_${m.kind}`,\n                            content: m.content,\n                            timestamp: new Date().toISOString(),\n                            sessionId,\n                            type: 'system',\n                            // Backend-driven visibility\n                            feedbackComponent: ui.feedbackComponent === true,\n                        };\n                        // Optional local thinking / guidance scaffolding (only if visible)\n                        if (ui.thinkingBox) {\n                            systemMsg.thinkingBox = {\n                                content: ['Processing message...', 'Generating response...'],\n                                isCollapsed: false,\n                            };\n                        }\n                        if (ui.guidanceActions) {\n                            systemMsg.guidanceActions = [\n                                { label: 'View Details', onClick: () => console.log('View details') },\n                                { label: 'Follow Up', onClick: () => console.log('Follow up') },\n                            ];\n                        }\n                        messages.push(systemMsg);\n                    }\n                }\n                else {\n                    // Fallback (older backend)\n                    messages.push({\n                        id: `msg_${Date.now()}_replayed`,\n                        content: response.replayed,\n                        timestamp: new Date().toISOString(),\n                        sessionId,\n                        type: 'system',\n                        thinkingBox: {\n                            content: ['Processing message...', 'Generating response...'],\n                            isCollapsed: false,\n                        },\n                        feedbackComponent: false,\n                    });\n                    messages.push({\n                        id: `msg_${Date.now()}_ack`,\n                        content: response.acknowledgement,\n                        timestamp: new Date().toISOString(),\n                        sessionId,\n                        type: 'system',\n                        feedbackComponent: false,\n                    });\n                }\n                renderMessages();\n            }\n            catch (error) {\n                console.error('Error sending message:', error);\n                const errorMessage = {\n                    id: `msg_${Date.now()}_error`,\n                    content: `Error: ${error instanceof Error ? error.message : 'Failed to send message'}`,\n                    timestamp: new Date().toISOString(),\n                    sessionId,\n                    type: 'system'\n                };\n                messages.push(errorMessage);\n                renderMessages();\n            }\n            finally {\n                // Update Mobius logo back to idle\n                mobiusStatus = 'idle';\n                const idleEl = MobiusLogo({ status: mobiusStatus });\n                logoSection.replaceChild(idleEl, currentMobiusLogoEl);\n                currentMobiusLogoEl = idleEl;\n            }\n        }\n    });\n    sidebarContainer.appendChild(chatInput);\n    // Footer\n    const footer = document.createElement('div');\n    footer.className = 'footer';\n    const userDetailsEl = UserDetails({ userName: 'Dr. Smith', userRole: 'Provider' });\n    const preferencesEl = PreferencesPanel({\n        llmChoice,\n        agentMode,\n        onLLMChange: (llm) => {\n            llmChoice = llm;\n            console.log('LLM changed:', llm);\n        },\n        onAgentModeChange: (mode) => {\n            agentMode = mode;\n            console.log('Agent mode changed:', mode);\n        },\n        isExpanded: false\n    });\n    // One-line footer row: User | Role | LLM | Agent (with expandable preferences below)\n    const footerRow = document.createElement('div');\n    footerRow.className = 'user-details';\n    footerRow.appendChild(userDetailsEl);\n    footerRow.appendChild(preferencesEl);\n    footer.appendChild(footerRow);\n    sidebarContainer.appendChild(footer);\n    function renderMode(mode) {\n        const ui = getUiDefaultsForMode(mode);\n        const layout = getLayoutForMode(mode, {\n            recordType,\n            recordId,\n            onRecordChange: (type, value) => {\n                recordType = type;\n                recordId = value;\n                console.log('Record ID changed:', type, value);\n            },\n            workflowButtons: [\n                { label: 'Generate Report', onClick: () => console.log('Generate report') },\n                { label: 'Schedule Follow-up', onClick: () => console.log('Schedule follow-up') },\n            ],\n        });\n        renderSection(contextMount, layout.context, ui, componentRegistry);\n        setVisible(topRow, ui.header);\n        setVisible(tasksPanel, ui.tasksPanel);\n        setVisible(chatAreaContainer, ui.chatArea);\n        setVisible(chatInput, ui.chatInput);\n        setVisible(userDetailsEl, ui.userDetails);\n        setVisible(preferencesEl, ui.preferencesPanel);\n        setVisible(footer, ui.userDetails || ui.preferencesPanel);\n        setVisible(secondRow, contextMount.childElementCount > 0);\n    }\n    function setMode(nextMode) {\n        currentMode = nextMode;\n        const nextContext = ContextDisplay({ status: currentStatus, mode: currentMode });\n        topRow.replaceChild(nextContext, contextDisplayEl);\n        contextDisplayEl = nextContext;\n        renderMode(currentMode);\n    }\n    // Example hook for future mode changes:\n    // quickActionEl.addEventListener('click', () => setMode('Chat'));\n    // Apply initial mode defaults.\n    renderMode(currentMode);\n    // Append to body (or html if body doesn't exist yet)\n    const target = document.body || document.documentElement;\n    if (!target) {\n        console.error('[Mobius OS] No body or documentElement found!');\n        return;\n    }\n    target.appendChild(sidebarContainer);\n    console.log('[Mobius OS] Sidebar appended to DOM');\n    // Initial render\n    renderMessages();\n    // Force a reflow to ensure styles are applied\n    sidebarContainer.offsetHeight;\n    console.log('[Mobius OS] Sidebar initialization complete. Position:', {\n        top: sidebarContainer.offsetTop,\n        right: window.innerWidth - sidebarContainer.offsetLeft - sidebarContainer.offsetWidth,\n        width: sidebarContainer.offsetWidth,\n        height: sidebarContainer.offsetHeight,\n        computedStyle: window.getComputedStyle(sidebarContainer).position\n    });\n    return Promise.resolve();\n}\n// Content script boot: always loaded via content_scripts, but mini rendering is gated by allowlist.\nconsole.log('[Mobius OS] Content script loaded. URL:', window.location.href);\nchrome.runtime.onMessage.addListener((msg, _sender, sendResponse) => {\n    const type = (msg && msg.type);\n    if (!type)\n        return;\n    void (async () => {\n        try {\n            if (type === 'mobius:setDomainAllowed') {\n                await setDomainAllowed(String(msg.hostname || ''), Boolean(msg.allowed));\n                const allowed = Boolean(msg.allowed);\n                if (!allowed)\n                    removeSidebar();\n                await renderMiniIfAllowed();\n                sendResponse({ ok: true });\n                return;\n            }\n            if (type === 'mobius:expand') {\n                await expandToSidebar();\n                sendResponse({ ok: true });\n                return;\n            }\n            if (type === 'mobius:collapse') {\n                await collapseToMini();\n                sendResponse({ ok: true });\n                return;\n            }\n            if (type === 'mobius:refreshMini') {\n                await renderMiniIfAllowed();\n                sendResponse({ ok: true });\n                return;\n            }\n            sendResponse({ ok: false, error: 'unknown_message' });\n        }\n        catch (e) {\n            const err = e instanceof Error ? e.message : String(e);\n            sendResponse({ ok: false, error: err });\n        }\n    })();\n    // Keep channel open for async sendResponse\n    return true;\n});\n(async () => {\n    sessionId = await getOrCreateSessionId();\n    // Initialize toast manager for global notifications\n    await initToastManager();\n    await renderMiniIfAllowed();\n})();\n","/**\n * AlertIndicator Component\n *\n * Shows count of unread alerts in header.\n * Red dot for high priority items.\n */\n/**\n * Create the AlertIndicator element\n */\nexport function AlertIndicator(props) {\n    const { alerts, onClick } = props;\n    const container = document.createElement('button');\n    container.className = 'sidecar-alert-indicator';\n    container.title = 'View alerts';\n    container.addEventListener('click', onClick);\n    // Bell icon (SVG to match Mini styling)\n    const icon = document.createElement('span');\n    icon.className = 'sidecar-alert-icon';\n    icon.innerHTML = `\n    <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n      <path d=\"M12 3c-3.314 0-6 2.686-6 6v3.5l-1.5 2h15L18 12.5V9c0-3.314-2.686-6-6-6z\" />\n      <path d=\"M9.5 17a2.5 2.5 0 0 0 5 0\" />\n    </svg>\n  `;\n    container.appendChild(icon);\n    // Count badge\n    const unreadCount = alerts.filter(a => !a.read).length;\n    if (unreadCount > 0) {\n        const badge = document.createElement('span');\n        badge.className = 'sidecar-alert-badge';\n        badge.textContent = unreadCount > 9 ? '9+' : String(unreadCount);\n        container.appendChild(badge);\n        // High priority dot\n        const hasHighPriority = alerts.some(a => !a.read && a.priority === 'high');\n        if (hasHighPriority) {\n            badge.classList.add('sidecar-alert-badge--high');\n        }\n    }\n    return container;\n}\n/**\n * Update the alert indicator with new counts\n */\nexport function updateAlertIndicator(element, alerts) {\n    // Find or create badge\n    let badge = element.querySelector('.sidecar-alert-badge');\n    const unreadCount = alerts.filter(a => !a.read).length;\n    if (unreadCount === 0) {\n        // Remove badge if no unread\n        if (badge)\n            badge.remove();\n        return;\n    }\n    if (!badge) {\n        badge = document.createElement('span');\n        badge.className = 'sidecar-alert-badge';\n        element.appendChild(badge);\n    }\n    badge.textContent = unreadCount > 9 ? '9+' : String(unreadCount);\n    // Update high priority status\n    const hasHighPriority = alerts.some(a => !a.read && a.priority === 'high');\n    badge.classList.toggle('sidecar-alert-badge--high', hasHighPriority);\n}\n/**\n * Create a simple notification dot (for minimal display)\n */\nexport function NotificationDot(hasUnread, hasHighPriority) {\n    const dot = document.createElement('span');\n    dot.className = 'sidecar-notification-dot';\n    if (!hasUnread) {\n        dot.style.display = 'none';\n    }\n    else if (hasHighPriority) {\n        dot.classList.add('sidecar-notification-dot--high');\n    }\n    return dot;\n}\n","/**\n * StatusBar Component\n *\n * Modern, minimal status indicator showing current care readiness.\n * Simple mono-grey gradient with position marker.\n */\n/**\n * Create the StatusBar element\n */\nexport function StatusBar({ careReadiness }) {\n    const container = document.createElement('div');\n    container.className = 'sidecar-status-bar';\n    const currentPosition = careReadiness.position;\n    // Title row\n    const titleRow = document.createElement('div');\n    titleRow.className = 'sidecar-status-bar-title-row';\n    const title = document.createElement('div');\n    title.className = 'sidecar-status-bar-title';\n    title.textContent = 'Care Readiness';\n    titleRow.appendChild(title);\n    // Status text - patient-focused\n    const context = document.createElement('div');\n    context.className = 'sidecar-status-bar-context';\n    context.textContent = getStatusText(currentPosition, careReadiness.direction);\n    titleRow.appendChild(context);\n    container.appendChild(titleRow);\n    // Progress row with track and percentage\n    const progressRow = document.createElement('div');\n    progressRow.className = 'sidecar-status-bar-progress-row';\n    // Track wrapper for positioning\n    const trackWrapper = document.createElement('div');\n    trackWrapper.className = 'sidecar-status-bar-track-wrapper';\n    // Gradient track\n    const track = document.createElement('div');\n    track.className = 'sidecar-status-bar-track';\n    // Progress fill (from left to current position)\n    const progressFill = document.createElement('div');\n    progressFill.className = 'sidecar-status-bar-progress';\n    progressFill.style.width = `${currentPosition}%`;\n    track.appendChild(progressFill);\n    // Current position marker\n    const marker = document.createElement('div');\n    marker.className = 'sidecar-status-bar-marker';\n    marker.style.left = `${currentPosition}%`;\n    track.appendChild(marker);\n    trackWrapper.appendChild(track);\n    progressRow.appendChild(trackWrapper);\n    // Percentage label\n    const percentLabel = document.createElement('div');\n    percentLabel.className = 'sidecar-status-bar-percent';\n    percentLabel.textContent = `${Math.round(currentPosition)}%`;\n    progressRow.appendChild(percentLabel);\n    container.appendChild(progressRow);\n    // Tooltip with details\n    container.title = buildTooltip(careReadiness);\n    return container;\n}\n/**\n * Get patient-focused status text based on position\n */\nfunction getStatusText(position, direction) {\n    if (position >= 90) {\n        return 'Ready for affordable care';\n    }\n    if (position >= 70) {\n        return 'Enabling affordable care';\n    }\n    if (position >= 50) {\n        return 'Securing care access';\n    }\n    if (position >= 30) {\n        return 'Preparing care pathway';\n    }\n    return 'Starting care journey';\n}\n/**\n * Build tooltip text\n */\nfunction buildTooltip(careReadiness) {\n    const lines = [];\n    lines.push(`Care Readiness: ${Math.round(careReadiness.position)}%`);\n    // Add factor summary if available\n    const factors = careReadiness.factors;\n    const completed = Object.values(factors).filter(f => f.status === 'complete').length;\n    const total = Object.values(factors).length;\n    if (total > 0) {\n        lines.push(`${completed}/${total} milestones complete`);\n    }\n    if (careReadiness.direction === 'improving') {\n        lines.push(' Improving');\n    }\n    else if (careReadiness.direction === 'declining') {\n        lines.push(' Needs attention');\n    }\n    return lines.join('\\n');\n}\n/**\n * Update the StatusBar with new data\n */\nexport function updateStatusBar(element, careReadiness) {\n    // Update marker position\n    const marker = element.querySelector('.sidecar-status-bar-marker');\n    if (marker) {\n        marker.style.left = `${careReadiness.position}%`;\n    }\n    // Update progress fill\n    const progressFill = element.querySelector('.sidecar-status-bar-progress');\n    if (progressFill) {\n        progressFill.style.width = `${careReadiness.position}%`;\n    }\n    // Update context text\n    const context = element.querySelector('.sidecar-status-bar-context');\n    if (context) {\n        context.textContent = getStatusText(careReadiness.position, careReadiness.direction);\n    }\n    // Update percentage\n    const percentLabel = element.querySelector('.sidecar-status-bar-percent');\n    if (percentLabel) {\n        percentLabel.textContent = `${Math.round(careReadiness.position)}%`;\n    }\n    element.title = buildTooltip(careReadiness);\n}\n","/**\n * QuickChat Component\n *\n * Single-line chat input at bottom of sidecar.\n * Uses knowledge context for intelligent responses.\n */\n/**\n * Create the QuickChat element\n */\nexport function QuickChat(props) {\n    const { record, onSend, placeholder } = props;\n    const container = document.createElement('div');\n    container.className = 'sidecar-quick-chat';\n    // Input wrapper\n    const inputWrapper = document.createElement('div');\n    inputWrapper.className = 'sidecar-quick-chat-wrapper';\n    // Input field\n    const input = document.createElement('input');\n    input.type = 'text';\n    input.className = 'sidecar-quick-chat-input';\n    input.placeholder = placeholder || `Ask about ${record.shortName}...`;\n    // Send button\n    const sendBtn = document.createElement('button');\n    sendBtn.className = 'sidecar-quick-chat-send';\n    sendBtn.innerHTML = `\n    <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n      <path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"></path>\n    </svg>\n  `;\n    sendBtn.disabled = true;\n    sendBtn.title = 'Send';\n    // Enable/disable send button based on input\n    input.addEventListener('input', () => {\n        sendBtn.disabled = input.value.trim().length === 0;\n    });\n    // Send on button click\n    sendBtn.addEventListener('click', () => {\n        const message = input.value.trim();\n        if (message) {\n            onSend(message);\n            input.value = '';\n            sendBtn.disabled = true;\n        }\n    });\n    // Send on Enter key\n    input.addEventListener('keydown', (e) => {\n        if (e.key === 'Enter' && !e.shiftKey) {\n            e.preventDefault();\n            const message = input.value.trim();\n            if (message) {\n                onSend(message);\n                input.value = '';\n                sendBtn.disabled = true;\n            }\n        }\n    });\n    inputWrapper.appendChild(input);\n    inputWrapper.appendChild(sendBtn);\n    container.appendChild(inputWrapper);\n    // Hint text\n    const hint = document.createElement('div');\n    hint.className = 'sidecar-quick-chat-hint';\n    hint.textContent = 'Ask questions about coverage, auth requirements, history...';\n    container.appendChild(hint);\n    return container;\n}\n/**\n * Show loading state in chat\n */\nexport function setQuickChatLoading(element, loading) {\n    const input = element.querySelector('.sidecar-quick-chat-input');\n    const sendBtn = element.querySelector('.sidecar-quick-chat-send');\n    if (input && sendBtn) {\n        input.disabled = loading;\n        sendBtn.disabled = loading || input.value.trim().length === 0;\n        if (loading) {\n            sendBtn.textContent = '';\n        }\n        else {\n            sendBtn.innerHTML = `\n        <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n          <path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"></path>\n        </svg>\n      `;\n        }\n    }\n}\n/**\n * Show a response in the chat area\n */\nexport function showQuickChatResponse(element, response, source) {\n    // Find or create response area\n    let responseArea = element.querySelector('.sidecar-quick-chat-response');\n    if (!responseArea) {\n        responseArea = document.createElement('div');\n        responseArea.className = 'sidecar-quick-chat-response';\n        element.insertBefore(responseArea, element.querySelector('.sidecar-quick-chat-wrapper'));\n    }\n    // Clear previous response\n    responseArea.innerHTML = '';\n    // Response text\n    const text = document.createElement('div');\n    text.className = 'sidecar-quick-chat-response-text';\n    text.textContent = response;\n    responseArea.appendChild(text);\n    // Source citation (if provided)\n    if (source) {\n        const citation = document.createElement('div');\n        citation.className = 'sidecar-quick-chat-response-source';\n        citation.textContent = `Source: ${source}`;\n        responseArea.appendChild(citation);\n    }\n    // Dismiss button\n    const dismissBtn = document.createElement('button');\n    dismissBtn.className = 'sidecar-quick-chat-response-dismiss';\n    dismissBtn.textContent = '';\n    dismissBtn.addEventListener('click', () => {\n        responseArea.remove();\n    });\n    responseArea.appendChild(dismissBtn);\n}\n/**\n * Clear any response\n */\nexport function clearQuickChatResponse(element) {\n    const responseArea = element.querySelector('.sidecar-quick-chat-response');\n    if (responseArea) {\n        responseArea.remove();\n    }\n}\n"],"names":["module","exports","styleElement","nonce","setAttribute","stylesInDOM","getIndexByIdentifier","identifier","result","i","length","modulesToDom","list","options","idCountMap","identifiers","item","id","base","count","concat","indexByIdentifier","obj","css","media","sourceMap","supports","layer","references","updater","addElementStyle","byIndex","splice","push","api","domAPI","update","newObj","remove","lastIdentifiers","newList","index","newLastIdentifiers","_i","_index","styleSheet","cssText","firstChild","removeChild","appendChild","document","createTextNode","cssWithMappingToString","toString","this","map","content","needLayer","join","modules","dedupe","undefined","alreadyImportedModules","k","_k","___CSS_LOADER_EXPORT___","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","element","createElement","setAttributes","attributes","insert","memo","style","target","styleTarget","querySelector","window","HTMLIFrameElement","contentDocument","head","e","getTarget","Error","insertStyleElement","styleTagTransform","apply","parentNode","removeStyleElement","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","nc","locals","API_BASE_URL","API_V1_URL","SESSION_STORAGE_KEY","async","Promise","resolve","chrome","storage","local","newSessionId","crypto","randomUUID","set","API_BASE","STORAGE_KEYS","AuthService","constructor","listeners","Set","refreshTimer","on","callback","add","delete","emit","event","forEach","error","console","storageGet","keys","runtime","sendMessage","type","response","lastError","ok","storageSet","items","storageClear","storeTokens","tokens","expiresAt","Date","now","expires_in","access_token","refresh_token","scheduleTokenRefresh","log","toISOString","getAccessToken","token","refreshAccessToken","getRefreshToken","clearTokens","clearTimeout","storeUserProfile","profile","getUserProfile","expiresIn","refreshIn","Math","max","setTimeout","refreshToken","fetch","method","headers","body","json","session","login","email","password","tenantId","tenant_id","success","user","pref","preference","user_id","display_name","first_name","preferred_name","greeting_name","timezone","locale","is_onboarded","activities","activity_code","tone","greeting_enabled","autonomy_routine_tasks","autonomy_sensitive_tasks","register","displayName","firstName","logout","warn","getCurrentUser","avatar_url","isAuthenticated","getAuthState","checkEmail","exists","_authService","getAuthService","authenticatedFetch","url","authService","Headers","fetchMiniStatus","sessionId","patientKey","session_id","patient_key","ASPIRE_HEALTH_LOGO_SVG","CLIENT_LOGOS","CLIENT_DISPLAY_NAMES","logoUrl","clientName","compact","container","className","knownLogo","img","src","alt","trim","startsWith","logoWrapper","size","innerHTML","svg","placeholder","initials","split","filter","Boolean","w","toUpperCase","slice","textContent","name","status","uid","String","random","normalId","processingId","createElementNS","defs","normalGrad","stop1","stop2","stop3","processingGrad","procStop1","animate1","procStop2","animate2","procStop3","animate3","pathData","normalGroup","normalPath","processingGroup","processingPath","PRIVACY_MODE_KEY","getInitials","fullName","parts","part","charAt","getDisplayName","record","isPrivate","getShortName","shortName","getPossessive","possessive","formatLabel","template","context","staff","value","entries","replace","RegExp","PrivacyMode","localStorage","getItem","enabled","setItem","toggle","newValue","isEnabled","setEnabled","SOURCE_PRIORITY","SOURCE_BADGES","batch","backend","page","getRelativeTime","isoString","date","diffMs","getTime","diffMins","floor","diffHours","diffDays","toLocaleDateString","formatTimestamp","createBottleneckItem","bottleneck","privacyContext","onAnswer","onAssign","onOwn","onAddNote","dataset","questionRow","questionText","question_text","resolved","sources","available","source","timestamp","set_at","detected_at","fetched_at","updated_at","sort","b","indexOf","winner","hasConflict","s","toLowerCase","conflictingSources","resolveValue","badge","title","values","conflict","assignDropdown","wrapper","btn","menu","display","mobiusOption","mobius_action","addEventListener","stopPropagation","classList","copilotOption","divider","userOption","isOpen","createAssignDropdown","answersRow","option","answer_options","createAnswerButton","mobius_can_handle","mobiusTip","noteRow","noteWrap","noteInput","sendBtn","doSendNote","note","preventDefault","onClick","label","description","closest","querySelectorAll","el","selectAnswerButton","createMilestoneItem","milestone","header","icon","complete","in_progress","blocked","pending","hasDetails","history","substeps","arrow","details","substepsContainer","substep","substepEl","timeline","entry","reverse","entryEl","actorBadge","actor","actor_name","action","time","artifact","href","createTimeline","cursor","isExpanded","arrowEl","TOAST_CONTAINER_ID","NOTIFICATIONS_ENABLED_KEY","AUTO_DISMISS_MS","win","reminder","isInitialized","isPolling","pollIntervalId","previousAlertIds","toastQueue","activeToasts","Map","notificationsEnabled","onToastAction","onJumpToPatient","show","toast","getElementById","has","emoji","getToastEmoji","subtitle","closeBtn","dismiss","autoDismissMs","auto_dismiss_ms","renderToast","pollForAlerts","authHeader","Authorization","getAuthHeader","newAlerts","alerts","alert","alertToToast","actions","THEMES","SidecarMenu","props","onHistoryClick","onSettingsClick","onHelpClick","onPrivacyChange","onNotificationsChange","onThemeChange","menuBtn","dropdown","getState","onChange","saveNotificationPreference","submenu","menuItem","getMenuIcon","createToggle","createThemeSubmenu","bell","lock","palette","settings","help","theme","sidebar","input","slider","then","checked","DEFAULT_DATA_ATTRIBUTE_PATTERNS","attr","selector","DEFAULT_URL_PATTERNS","regex","DEFAULT_TEXT_PATTERNS","DEFAULT_PATTERNS","dataAttributes","urlPatterns","textPatterns","matchDataAttributes","patterns","root","contextEl","contextMrn","getAttribute","id_type","id_value","source_hint","confidence","pattern","matchUrlPatterns","location","match","captureGroup","decodeURIComponent","matchTextPatterns","searchAreas","mergePatterns","defaults","custom","DEFAULT_OPTIONS","debounceMs","strategies","customPatterns","autoStart","observeMutations","PatientContextDetector","observer","debounceTimer","isRunning","currentPatient","lastUrl","start","scheduleDetection","setupUrlChangeDetection","setupMutationObserver","stop","disconnect","detect","patient","strategy","detectPatient","handleDetectionResult","off","getCurrentPatient","updatePatterns","updatePatternsFromConfig","config","parsed","c","Array","isArray","p","parsePatternConfig","isActive","MutationObserver","mutations","some","mutation","addedNodes","removedNodes","attrName","attributeName","includes","observe","childList","subtree","titleObserver","titleElement","characterData","setInterval","previousPatient","isSamePatient","escapeHtml","text","div","sidebarContainer","MINI_IDS","applyMiniTheme","miniLastPos","miniProceed","color","miniTasking","patientOverride","patientContextDetector","autoDetectedPatient","needsAttention","problemStatement","userStatus","taskCount","resolutionPlan","actionsForUser","sidecarState","sidecarPrivacyMode","toastManagerInitialized","initToastManager","onAction","stored","loadNotificationPreference","existing","styleId","addToastStyles","createToastContainer","toastId","actionId","expandToSidebar","updateStepPreviewGlobal","mini","questionEl","badgeText","dot","backendColor","resolution_notes","current_step","step","maxLen","colorToCssClass","otherRoleTasks","other_role_tasks","updateTaskCountGlobal","taskBadgeRow","countEl","labelEl","currentUserProfile","currentPersonalization","greetingDismissed","statusPollInterval","STATUS_POLL_INTERVAL_MS","startStatusPolling","stopStatusPolling","found","newUserStatus","needs_attention","user_status","problem_statement","effectiveColor","attentionRow","statusBtn","minimizedDot","updateAttentionUI","err","debug","clearInterval","getHostname","hostname","getAllowedDomains","setDomainAllowed","allowed","host","current","next","from","removeMini","modal","removeSidebar","existingSidebar","showToast","message","getSmartDropdownPosition","anchorRect","dropdownWidth","dropdownHeight","preferAbove","gap","viewportWidth","innerWidth","viewportHeight","innerHeight","scrollX","scrollY","top","left","transformOrigin","spaceAbove","spaceBelow","bottom","spaceRight","spaceLeft","right","min","clamp","setMiniPos","rootEl","pos","clamped","rect","getBoundingClientRect","maxX","width","maxY","height","x","y","clampMiniPos","getPatientDisplay","dob","handleAutoDetectedPatient","detected","renderMiniIfAllowed","domain","requestBody","resolvePatientContext","patient_context_id","id_masked","nameEl","idEl","minimizedPatient","proceed","tasking","task_count","resolution_plan","actions_for_user","miniState","userProfile","initSidecarUI","refreshSidecarState","updateMiniWithResolvedPatient","createMini","dragHandle","clientLogoEl","brandDivider","brand","brandText","minimizeBtn","minimizedInfo","expandBtn","themeSubmenuOpen","menuItemStyle","themeSubmenu","themeTriggerEl","themeOptions","onmousedown","themeId","saveMiniTheme","selectTheme","onmouseenter","background","onmouseleave","disableEl","contains","menuJustOpened","btnRect","greetingRow","userDropdown","greetingRect","initial","openPreferencesModal","closeDropdown","removeEventListener","showUserDropdown","activityCodes","code","currentPrefs","preferences","initialPrefs","onSave","onClose","prefs","selectedActivities","activeTab","render","renderTabContent","wireEvents","savePreferences","tab","cb","idx","r","updateRadioStyles","saveBtn","disabled","updatedUser","errData","catch","PreferencesModal","newPrefs","isMinimized","onclick","patientRow","proceedRow","taskingRow","renderPatient","dobEl","minimizedName","applyStatus","rowEl","line","showMode","mode","getModeIcon","modeText","mode_text","applyAttention","problemText","applyTaskCount","applyStepPreview","updateMinimizedInfo","ATTENTION_OPTIONS","statusBadge","suggestion","system_suggestion","opt","answer","step_id","answer_code","plan","separator","moreItem","createAnswerDropdown","currentStatus","onSelect","onReportIssue","isSelected","patientId","attentionStatus","attention_status","submitAttentionStatus","open_sidecar","reportItem","onSubmit","overlay","cancelBtn","submitBtn","close","focus","createIssueModal","issueText","issue_text","reportIssue","createAttentionDropdown","taskBadge","nameInput","idInput","dobInput","nameSug","idSug","activeField","currentResults","activeIndex","clearSuggestions","renderSuggestions","Number","chosen","doSearch","q","query","resp","limit","URL","searchParams","searchMiniPatients","results","setResults","onKeyDown","dobValue","openPatientModal","savePatient","doSend","planContext","resolution_plan_id","plan_id","plan_step_id","submitMiniNote","doExpand","dragging","startDrag","currentTarget","setPointerCapture","pointerId","clientX","clientY","moveDrag","dx","dy","endDrag","canStartDrag","recordContext","endsWith","createPatientContext","staffName","buildPrivacyContext","queryParams","URLSearchParams","createFallbackSidecarState","headerLeft","logoSection","logoLabel","headerRight","alertIndicator","unreadCount","read","priority","AlertIndicator","privacyIndicator","onCollapse","collapseToMini","collapseBtn","CollapseButton","care_readiness","statusBar","careReadiness","currentPosition","position","titleRow","direction","progressRow","trackWrapper","track","progressFill","marker","percentLabel","round","lines","factors","completed","f","total","buildTooltip","StatusBar","mainContent","cardsContainer","greeting","userName","hour","getHours","timeGreeting","patientSection","rowLabel","patientInfo","patientName","padStart","editBtn","bottleneckCard","bottlenecks","onBulkAssign","BottleneckCard","bottleneckId","answerId","bottleneck_id","answer_id","noteText","note_text","bottleneckIds","bottleneck_ids","milestones","knowledge_context","contextExpander","knowledgeContext","defaultExpanded","planSection","section","summary","factorEntries","factorsList","factorKey","factor","factorEl","factorLabel","progress","done","currentStepEl","actionsEl","createResolutionPlanSection","milestonesSection","createMilestonesSection","payer","payerSection","info","phone","portal_url","portal","avg_response_time","responseTime","policy_excerpts","excerpts","excerptsTitle","excerpt","excerptEl","topic","createPayerSection","ContextExpander","chatContainer","quickChat","onSend","inputWrapper","shiftKey","hint","QuickChat","relevant_history","milestone_id","factor_type","mobius_mode","surface","visit_confirmed","eligibility_verified","authorization_secured","documentation_ready","user_owned_tasks","computed_at","res","loadMiniPersistedState","isDomainAllowed","savedTheme","loadMiniTheme","lockedOverlay","API_BASE_AUTH","emailInput","passwordInput","signInBtn","errorDiv","doLogin","provider","ssoBtn","createAccountLink","firstNameInput","lastNameInput","confirmInput","backToLoginLink","showError","msg","doRegister","lastName","confirm","accessToken","fetchActivities","radio","borderColor","preferredName","aiExp","routineAutonomy","sensitiveAutonomy","ai_experience_level","doOnboarding","showOnboardingForm","showRegistrationForm","personalization","greetingText","effectiveAttentionColor","minimizedInfoEl","has_config","fetchDetectionConfig","onMessage","addListener","_sender","sendResponse"],"ignoreList":[],"sourceRoot":""}